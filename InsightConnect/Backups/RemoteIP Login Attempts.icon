{
  "kom": {
    "komandVersion": "1.176.4-0-gb65a8",
    "komFileVersion": "2.0.0",
    "exportedAt": "2024-01-05T18:55:58.725080048Z",
    "workflowVersions": [
      {
        "name": "RemoteIP Login Attempts",
        "type": "runnable",
        "version": "",
        "description": "# Description\nThis workflow runs a query that pulls remote public IP addresses and checks them against AbuseIPDB and the total number of login attempts. Based on these results, the workflow then automatically adds the IP address as an indicator in Microsoft Defender for Endpoint. \\\nThe workflow will send an email to recipients indicated in workflow parameters if the indicator is **new**. If the indicator is a repeat, only an artifact will be created.\n> Please note that throughout this workflow the terms \"ip address\" and \"indicator\" may be used interchangeably. This is only to make the workflow adaptable in the event further indicators are added.\n\n# Key Features\n* Runs automatically to scan for new login attempts based on frequency set\n* Uses workflow parameters to establish a threshold for automatically adding IPs found as an indicator\n* If the above parameters aren't met, then the workflow will trigger a Human decision allowing user(s) to manually  initiate the indicator addition\n* If a new indicator is created, an email is sent. If it is a repeat indicator, an artifact is created.\n\n# Setup\n## Required Plugins\n* Microsoft Office 365 Email\n* Microsoft Windows Defender ATP\n* AbuseIPDB API\n* Global Artifacts (match names **exactly**):\n  * Blocked IP Addresses\n  * Allowed IP Addresses\n* Microsoft Defender Hunting\n\n## Parameter Details\n### Email Sender\nThis is a valid email address that InsightConnect would be able to send from. Will be used as the \"from\" address when sending the email.\n\n### Email Recipient\nRecipient email address(es) of user(s) who should receive the email informing of a new indicator being added to Microsoft Defender.\n\n### Abuse Confidence Threshold\nThis sets the minimum required \"Confidence of Abuse\" value for InsightConnect to automatically flag the indicator as malicious. If the returned confidence value is greater than this parameter, the workflow will follow the automated approach to blacklisting/blocking this indicator.\n\n### Login Attempt Threshold\nIf the number of login attempts from a single IP address, over the time between workflow runs, is greater than the login attempt threshold value indicated then the indicator is added automatically without human interaction.\n\n# Technical Details\n\n## Version History\nv1.0 - Original Version\n\n# Links\n* [GitHub InsightConnect/RemoteIPLoginAttempts](https://github.com/vard2rad/SecOps/tree/main/InsightConnect/RemoteIPLoginAttempts)\n* [AbuseIPDB FAQ](https://www.abuseipdb.com/faq.html)\n\n## References\n* Created by [vard2rad](https://discuss.rapid7.com/u/vard2rad)",
        "graph": {
          "edges": {
            "0cd7d52d-3c6f-4daf-b5cf-668aa879e37d": {
              "id": "0cd7d52d-3c6f-4daf-b5cf-668aa879e37d",
              "name": "",
              "description": "",
              "parentNodeId": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0",
              "fromNodeId": "fd293814-a8e3-4907-96ff-fa045ef722c4",
              "toNodeId": "2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d"
            },
            "13bd5627-0bf6-4b28-9041-3be00799d504": {
              "id": "13bd5627-0bf6-4b28-9041-3be00799d504",
              "name": "",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "toNodeId": "6a098bf4-e5fb-4b93-810a-7b7a4ca920a9"
            },
            "166cda20-12fe-40cd-8319-f5152d1c7654": {
              "id": "166cda20-12fe-40cd-8319-f5152d1c7654",
              "name": "",
              "description": "",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "fromNodeId": "dcf5a055-3452-43f6-afef-6c85c3460384",
              "toNodeId": "365507a2-566f-4bb8-9e8a-5add9e094ec1"
            },
            "21e1b57c-d558-400b-bf4f-e3fffbba5f55": {
              "id": "21e1b57c-d558-400b-bf4f-e3fffbba5f55",
              "name": "false",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "4c664ff1-99ec-47bb-a858-ab195866796f",
              "toNodeId": "1eda1198-ea83-4420-93cb-0dbf6de10cae"
            },
            "22a82c07-448d-41c9-9624-fa90220ac0fc": {
              "id": "22a82c07-448d-41c9-9624-fa90220ac0fc",
              "name": "",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "26ef9167-e1b2-4d32-b3a3-a7a0f3eea524",
              "toNodeId": "4c664ff1-99ec-47bb-a858-ab195866796f"
            },
            "2f9533bf-305f-4427-95d8-86042f502187": {
              "id": "2f9533bf-305f-4427-95d8-86042f502187",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "29e2c949-6c24-4cc1-b6ae-c6fd6628cf4a",
              "toNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "35dfe256-c3ea-452f-8575-b762a66bcaf5": {
              "id": "35dfe256-c3ea-452f-8575-b762a66bcaf5",
              "name": "",
              "description": "",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "fromNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "toNodeId": "6b80b195-1da8-408f-8663-09c1c7a7b884"
            },
            "3db949cd-dfd6-4439-ae1f-df04a4b12a07": {
              "id": "3db949cd-dfd6-4439-ae1f-df04a4b12a07",
              "name": "",
              "description": "",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "fromNodeId": "86b201b8-b091-4cca-b97c-648aa46ae545",
              "toNodeId": ""
            },
            "4441bcf4-457a-4ddc-9024-7209beb1716b": {
              "id": "4441bcf4-457a-4ddc-9024-7209beb1716b",
              "name": "",
              "description": "",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "fromNodeId": "6b80b195-1da8-408f-8663-09c1c7a7b884",
              "toNodeId": "03ca6f2e-82c0-4d8a-b73e-46ac657f312e"
            },
            "44f50c85-b740-4a95-b5a5-4eb06dade2ea": {
              "id": "44f50c85-b740-4a95-b5a5-4eb06dade2ea",
              "name": "blacklist indicator",
              "description": "Mark this IP address as a malicious indicator in defender. The indicator will expire after 365 days, unless it is detected again before then.",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "f02008de-9637-431e-81be-bc715badc75a",
              "toNodeId": ""
            },
            "49f6d3fc-ca4f-404b-9621-5ec9bad12236": {
              "id": "49f6d3fc-ca4f-404b-9621-5ec9bad12236",
              "name": "false",
              "description": "This indicator is a repeat detection.",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "fromNodeId": "365507a2-566f-4bb8-9e8a-5add9e094ec1",
              "toNodeId": "f68338a6-21b2-4d6a-acf8-441cd6f4efb5"
            },
            "4cacc56c-c9b0-4188-b86d-eba14a6a2f48": {
              "id": "4cacc56c-c9b0-4188-b86d-eba14a6a2f48",
              "name": "",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "5806486e-ac30-4e7d-a022-4106738aeca7",
              "toNodeId": "c137b4b5-c8f9-4f7e-8cf8-cffa431232f6"
            },
            "579e5a9f-e622-407e-ae23-bc13bb1a6f30": {
              "id": "579e5a9f-e622-407e-ae23-bc13bb1a6f30",
              "name": "",
              "description": "",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "fromNodeId": "f68338a6-21b2-4d6a-acf8-441cd6f4efb5",
              "toNodeId": ""
            },
            "629b5d72-80ce-4683-a34f-53c68df89dea": {
              "id": "629b5d72-80ce-4683-a34f-53c68df89dea",
              "name": "",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "497cf0a3-3be8-47d4-bc6b-0d233f48e020",
              "toNodeId": "26ef9167-e1b2-4d32-b3a3-a7a0f3eea524"
            },
            "69a61bb4-82d4-4b85-bb40-e4b139971a16": {
              "id": "69a61bb4-82d4-4b85-bb40-e4b139971a16",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "dcc7219b-0fbf-4943-8db5-c79b1fb40db7",
              "toNodeId": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0"
            },
            "6df2f436-1357-4db6-a110-69149b546559": {
              "id": "6df2f436-1357-4db6-a110-69149b546559",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "toNodeId": "175f4b3d-2d8b-455a-8f23-5848ed4e55c3"
            },
            "74d0bd97-9c66-4955-99cc-8456f99a2dc6": {
              "id": "74d0bd97-9c66-4955-99cc-8456f99a2dc6",
              "name": "true",
              "description": "The AbuseIPDB reputation result exceeded the workflow parameter threshold set.",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "cd57ad57-3516-4bbc-b156-c277efe9a436",
              "toNodeId": "497cf0a3-3be8-47d4-bc6b-0d233f48e020"
            },
            "75f448f5-a5b9-4441-946e-dda7153ae128": {
              "id": "75f448f5-a5b9-4441-946e-dda7153ae128",
              "name": "",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "1eda1198-ea83-4420-93cb-0dbf6de10cae",
              "toNodeId": "5806486e-ac30-4e7d-a022-4106738aeca7"
            },
            "805c857a-0c43-44b4-a933-aabfee2e4f02": {
              "id": "805c857a-0c43-44b4-a933-aabfee2e4f02",
              "name": "true",
              "description": "Total login attempts in query timeframe exceeded threshold for brute force detection.",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "4c664ff1-99ec-47bb-a858-ab195866796f",
              "toNodeId": "1eda1198-ea83-4420-93cb-0dbf6de10cae"
            },
            "892d757c-4587-456b-8626-babeeb0058a7": {
              "id": "892d757c-4587-456b-8626-babeeb0058a7",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0",
              "toNodeId": "f567c9db-0ce1-43dc-b6ee-04885557b78a"
            },
            "8e4f6b41-bdf3-4990-b5c0-e946b5001636": {
              "id": "8e4f6b41-bdf3-4990-b5c0-e946b5001636",
              "name": "take no action",
              "description": "Take no action on this IP address.",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "f02008de-9637-431e-81be-bc715badc75a",
              "toNodeId": ""
            },
            "9069d744-e25e-422f-b2fa-89d0a3d88ba9": {
              "id": "9069d744-e25e-422f-b2fa-89d0a3d88ba9",
              "name": "false",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "175f4b3d-2d8b-455a-8f23-5848ed4e55c3",
              "toNodeId": ""
            },
            "9af54a84-04d4-4309-bb5b-5a81a63a1be8": {
              "id": "9af54a84-04d4-4309-bb5b-5a81a63a1be8",
              "name": "false",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "cd57ad57-3516-4bbc-b156-c277efe9a436",
              "toNodeId": "497cf0a3-3be8-47d4-bc6b-0d233f48e020"
            },
            "9fbddd05-3ba4-44aa-92dc-48bba0194d3d": {
              "id": "9fbddd05-3ba4-44aa-92dc-48bba0194d3d",
              "name": "",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "6a098bf4-e5fb-4b93-810a-7b7a4ca920a9",
              "toNodeId": "cd57ad57-3516-4bbc-b156-c277efe9a436"
            },
            "aef30266-8716-4470-8baf-57a6a68c80bf": {
              "id": "aef30266-8716-4470-8baf-57a6a68c80bf",
              "name": "true",
              "description": "Action needs to be taken on indicators.",
              "parentNodeId": "",
              "fromNodeId": "175f4b3d-2d8b-455a-8f23-5848ed4e55c3",
              "toNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde"
            },
            "b120ae3a-d861-441b-9ecd-965adc81de46": {
              "id": "b120ae3a-d861-441b-9ecd-965adc81de46",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "toNodeId": ""
            },
            "b22b11e2-962c-43cf-8c54-3d5c6bdd3e08": {
              "id": "b22b11e2-962c-43cf-8c54-3d5c6bdd3e08",
              "name": "",
              "description": "",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "fromNodeId": "03ca6f2e-82c0-4d8a-b73e-46ac657f312e",
              "toNodeId": "dcf5a055-3452-43f6-afef-6c85c3460384"
            },
            "ba1e6d64-10d7-4b9b-a65d-4632870c354a": {
              "id": "ba1e6d64-10d7-4b9b-a65d-4632870c354a",
              "name": "",
              "description": "",
              "parentNodeId": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0",
              "fromNodeId": "2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d",
              "toNodeId": ""
            },
            "bf4a5eab-5d70-4b3a-9bbd-920a0bce8e34": {
              "id": "bf4a5eab-5d70-4b3a-9bbd-920a0bce8e34",
              "name": "",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "57c16d53-7fee-43db-97c1-6bb6508553a2",
              "toNodeId": "37531c18-0581-4f94-a344-e2a8b8790e45"
            },
            "bfb17fe9-40e3-43ba-8b2c-f87c167de692": {
              "id": "bfb17fe9-40e3-43ba-8b2c-f87c167de692",
              "name": "human",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "37531c18-0581-4f94-a344-e2a8b8790e45",
              "toNodeId": "f02008de-9637-431e-81be-bc715badc75a"
            },
            "c2deaede-0e2d-49f2-8c3d-162fd2b79794": {
              "id": "c2deaede-0e2d-49f2-8c3d-162fd2b79794",
              "name": "automated",
              "description": "This indicator either exceeded the minimum threshold for automatic remediation, or already exists as an indicator.",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "37531c18-0581-4f94-a344-e2a8b8790e45",
              "toNodeId": ""
            },
            "c3c6dfa5-c023-4c4b-959d-0d920ef9c88c": {
              "id": "c3c6dfa5-c023-4c4b-959d-0d920ef9c88c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "d354d61c-3a1e-4715-b412-a3c64a37d6f4",
              "toNodeId": "dcc7219b-0fbf-4943-8db5-c79b1fb40db7"
            },
            "c52b5006-84a0-4485-bdb2-86df6e416c9d": {
              "id": "c52b5006-84a0-4485-bdb2-86df6e416c9d",
              "name": "true",
              "description": "The indicator is new to the environment.",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "fromNodeId": "365507a2-566f-4bb8-9e8a-5add9e094ec1",
              "toNodeId": "86b201b8-b091-4cca-b97c-648aa46ae545"
            },
            "cc2ce569-aff8-4937-b608-a21fb9907cfd": {
              "id": "cc2ce569-aff8-4937-b608-a21fb9907cfd",
              "name": "false",
              "description": "The IP address was not found in the global artifact.",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "c137b4b5-c8f9-4f7e-8cf8-cffa431232f6",
              "toNodeId": "1ac6da71-9d81-481c-8ba9-d38df3d042ed"
            },
            "d4cbfd27-d44e-444a-ae42-ae1ad2ad8287": {
              "id": "d4cbfd27-d44e-444a-ae42-ae1ad2ad8287",
              "name": "",
              "description": "",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "1ac6da71-9d81-481c-8ba9-d38df3d042ed",
              "toNodeId": "57c16d53-7fee-43db-97c1-6bb6508553a2"
            },
            "d7f1e482-e132-4986-a0ac-d7a2e95aad8c": {
              "id": "d7f1e482-e132-4986-a0ac-d7a2e95aad8c",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "f567c9db-0ce1-43dc-b6ee-04885557b78a",
              "toNodeId": "29e2c949-6c24-4cc1-b6ae-c6fd6628cf4a"
            },
            "e380073c-db01-4d8d-afe8-34582309a645": {
              "id": "e380073c-db01-4d8d-afe8-34582309a645",
              "name": "true",
              "description": "The IP address already exists in the global artifact.",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "fromNodeId": "c137b4b5-c8f9-4f7e-8cf8-cffa431232f6",
              "toNodeId": "1ac6da71-9d81-481c-8ba9-d38df3d042ed"
            },
            "ef4a2c65-0935-4cf1-ab9f-e71643c3f218": {
              "id": "ef4a2c65-0935-4cf1-ab9f-e71643c3f218",
              "name": "",
              "description": "",
              "parentNodeId": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0",
              "fromNodeId": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0",
              "toNodeId": "fd293814-a8e3-4907-96ff-fa045ef722c4"
            }
          },
          "nodes": {
            "03ca6f2e-82c0-4d8a-b73e-46ac657f312e": {
              "id": "03ca6f2e-82c0-4d8a-b73e-46ac657f312e",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde"
            },
            "11c17b24-0760-44e5-91ef-cd0e43261bde": {
              "id": "11c17b24-0760-44e5-91ef-cd0e43261bde",
              "parentNodeId": ""
            },
            "175f4b3d-2d8b-455a-8f23-5848ed4e55c3": {
              "id": "175f4b3d-2d8b-455a-8f23-5848ed4e55c3",
              "parentNodeId": ""
            },
            "1ac6da71-9d81-481c-8ba9-d38df3d042ed": {
              "id": "1ac6da71-9d81-481c-8ba9-d38df3d042ed",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "1eda1198-ea83-4420-93cb-0dbf6de10cae": {
              "id": "1eda1198-ea83-4420-93cb-0dbf6de10cae",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "26ef9167-e1b2-4d32-b3a3-a7a0f3eea524": {
              "id": "26ef9167-e1b2-4d32-b3a3-a7a0f3eea524",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "29e2c949-6c24-4cc1-b6ae-c6fd6628cf4a": {
              "id": "29e2c949-6c24-4cc1-b6ae-c6fd6628cf4a",
              "parentNodeId": ""
            },
            "2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d": {
              "id": "2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d",
              "parentNodeId": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0"
            },
            "365507a2-566f-4bb8-9e8a-5add9e094ec1": {
              "id": "365507a2-566f-4bb8-9e8a-5add9e094ec1",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde"
            },
            "37531c18-0581-4f94-a344-e2a8b8790e45": {
              "id": "37531c18-0581-4f94-a344-e2a8b8790e45",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "497cf0a3-3be8-47d4-bc6b-0d233f48e020": {
              "id": "497cf0a3-3be8-47d4-bc6b-0d233f48e020",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "4c664ff1-99ec-47bb-a858-ab195866796f": {
              "id": "4c664ff1-99ec-47bb-a858-ab195866796f",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "4ca06543-b8d9-4923-97f9-2463aaaafd4f": {
              "id": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
              "parentNodeId": ""
            },
            "57c16d53-7fee-43db-97c1-6bb6508553a2": {
              "id": "57c16d53-7fee-43db-97c1-6bb6508553a2",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "5806486e-ac30-4e7d-a022-4106738aeca7": {
              "id": "5806486e-ac30-4e7d-a022-4106738aeca7",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "6a098bf4-e5fb-4b93-810a-7b7a4ca920a9": {
              "id": "6a098bf4-e5fb-4b93-810a-7b7a4ca920a9",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "6b80b195-1da8-408f-8663-09c1c7a7b884": {
              "id": "6b80b195-1da8-408f-8663-09c1c7a7b884",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde"
            },
            "86b201b8-b091-4cca-b97c-648aa46ae545": {
              "id": "86b201b8-b091-4cca-b97c-648aa46ae545",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde"
            },
            "c137b4b5-c8f9-4f7e-8cf8-cffa431232f6": {
              "id": "c137b4b5-c8f9-4f7e-8cf8-cffa431232f6",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "cd57ad57-3516-4bbc-b156-c277efe9a436": {
              "id": "cd57ad57-3516-4bbc-b156-c277efe9a436",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "d354d61c-3a1e-4715-b412-a3c64a37d6f4": {
              "id": "d354d61c-3a1e-4715-b412-a3c64a37d6f4",
              "parentNodeId": ""
            },
            "dcc7219b-0fbf-4943-8db5-c79b1fb40db7": {
              "id": "dcc7219b-0fbf-4943-8db5-c79b1fb40db7",
              "parentNodeId": ""
            },
            "dcf5a055-3452-43f6-afef-6c85c3460384": {
              "id": "dcf5a055-3452-43f6-afef-6c85c3460384",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde"
            },
            "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0": {
              "id": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0",
              "parentNodeId": ""
            },
            "f02008de-9637-431e-81be-bc715badc75a": {
              "id": "f02008de-9637-431e-81be-bc715badc75a",
              "parentNodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f"
            },
            "f567c9db-0ce1-43dc-b6ee-04885557b78a": {
              "id": "f567c9db-0ce1-43dc-b6ee-04885557b78a",
              "parentNodeId": ""
            },
            "f68338a6-21b2-4d6a-acf8-441cd6f4efb5": {
              "id": "f68338a6-21b2-4d6a-acf8-441cd6f4efb5",
              "parentNodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde"
            },
            "fd293814-a8e3-4907-96ff-fa045ef722c4": {
              "id": "fd293814-a8e3-4907-96ff-fa045ef722c4",
              "parentNodeId": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0"
            }
          }
        },
        "steps": {
          "03ca6f2e-82c0-4d8a-b73e-46ac657f312e": {
            "nodeId": "03ca6f2e-82c0-4d8a-b73e-46ac657f312e",
            "name": "IR-lookup-blocked_ip_addresses",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "value"
                },
                "op": "=",
                "right": {
                  "name": "11c17b24-0760-44e5-91ef-cd0e43261bde.$item",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'value' = {{[11c17b24-0760-44e5-91ef-cd0e43261bde].[$item]}}",
              "ignoreCase": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts",
            "globalArtifact": {
              "name": "Blocked IP Addresses",
              "id": "a4cda292-1ce2-4e87-85aa-e427014f21be",
              "schema": {
                "definitions": {},
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              }
            },
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "11c17b24-0760-44e5-91ef-cd0e43261bde": {
            "nodeId": "11c17b24-0760-44e5-91ef-cd0e43261bde",
            "name": "loop-indicator_response",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "35dfe256-c3ea-452f-8575-b762a66bcaf5",
              "nextEdgeId": "b120ae3a-d861-441b-9ecd-965adc81de46",
              "repeatVariable": "{{[4ca06543-b8d9-4923-97f9-2463aaaafd4f].[indicators-ipaddress]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "175f4b3d-2d8b-455a-8f23-5848ed4e55c3": {
            "nodeId": "175f4b3d-2d8b-455a-8f23-5848ed4e55c3",
            "name": "decid-indicators_detected",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "aef30266-8716-4470-8baf-57a6a68c80bf",
              "stepControlParams": [
                {
                  "edgeId": "aef30266-8716-4470-8baf-57a6a68c80bf",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "9069d744-e25e-422f-b2fa-89d0a3d88ba9",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "4ca06543-b8d9-4923-97f9-2463aaaafd4f.indicators-ipaddress",
                          "type": "variable"
                        }
                      ],
                      "name": "is_defined",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "is_defined({{[4ca06543-b8d9-4923-97f9-2463aaaafd4f].[indicators-ipaddress]}}) = true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "1ac6da71-9d81-481c-8ba9-d38df3d042ed": {
            "nodeId": "1ac6da71-9d81-481c-8ba9-d38df3d042ed",
            "name": "IPA-join-ip_address_exists",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "cc2ce569-aff8-4937-b608-a21fb9907cfd",
                "e380073c-db01-4d8d-afe8-34582309a645"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "Indicator Already Exists",
                  "type": "boolean",
                  "variables": {
                    "cc2ce569-aff8-4937-b608-a21fb9907cfd": false,
                    "e380073c-db01-4d8d-afe8-34582309a645": true
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "Indicator Already Exists": {
                  "description": "Emitted variable \"Indicator Already Exists\"",
                  "order": 1,
                  "title": "Indicator Already Exists",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "Indicator Already Exists": {
                  "description": "Emitted variable \"Indicator Already Exists\"",
                  "order": 1,
                  "title": "Indicator Already Exists",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "1eda1198-ea83-4420-93cb-0dbf6de10cae": {
            "nodeId": "1eda1198-ea83-4420-93cb-0dbf6de10cae",
            "name": "IPA-join-brute_force",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "21e1b57c-d558-400b-bf4f-e3fffbba5f55",
                "805c857a-0c43-44b4-a933-aabfee2e4f02"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "Brute Force Detected",
                  "type": "boolean",
                  "variables": {
                    "21e1b57c-d558-400b-bf4f-e3fffbba5f55": false,
                    "805c857a-0c43-44b4-a933-aabfee2e4f02": true
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "Brute Force Detected": {
                  "description": "Emitted variable \"Brute Force Detected\"",
                  "order": 1,
                  "title": "Brute Force Detected",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "Brute Force Detected": {
                  "description": "Emitted variable \"Brute Force Detected\"",
                  "order": 1,
                  "title": "Brute Force Detected",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "26ef9167-e1b2-4d32-b3a3-a7a0f3eea524": {
            "nodeId": "26ef9167-e1b2-4d32-b3a3-a7a0f3eea524",
            "name": "IPA-hunt-login_attempts",
            "type": "action",
            "plugin": {
              "name": "Microsoft Defender Hunting",
              "slugVendor": "rapid7",
              "slugName": "microsoft_defender_hunting",
              "slugVersion": "1.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_defender_hunting/1.0.0/icon.png"
            },
            "identifier": "advanced_hunting",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "query": "DeviceLogonEvents \n| where RemoteIPType == \"Public\" and RemoteIP == \"221.213.201.178\" and Timestamp > ago(1440m) \n| project DeviceName, RemoteIP, RemoteIPType, Timestamp"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "query": {
                  "description": "Advanced Hunting query to run",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                }
              },
              "required": [
                "query"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "column": {
                  "properties": {
                    "name": {
                      "description": "Column's name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Column's data type",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "Column",
                  "type": "object"
                }
              },
              "properties": {
                "columns": {
                  "description": "Schema containing response column's name and type",
                  "items": {
                    "$ref": "#/definitions/column"
                  },
                  "order": 1,
                  "title": "Columns",
                  "type": "array"
                },
                "rows": {
                  "description": "Array of objects containing query response values with keys as specific column name",
                  "items": {
                    "type": "object"
                  },
                  "order": 2,
                  "title": "Rows",
                  "type": "array"
                }
              },
              "required": [
                "columns",
                "rows"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "29e2c949-6c24-4cc1-b6ae-c6fd6628cf4a": {
            "nodeId": "29e2c949-6c24-4cc1-b6ae-c6fd6628cf4a",
            "name": "uniq-ips",
            "type": "action",
            "plugin": {
              "name": "Uniq",
              "slugVendor": "rapid7",
              "slugName": "uniq",
              "slugVersion": "1.0.2",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/uniq/1.0.2/icon.png"
            },
            "identifier": "uniq_string_array",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "data": "{{[dd6dda5e-75c5-4c7c-84ee-21da06ce93b0].[Extracted_IPs]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "data": {
                  "description": "Array of strings",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Data",
                  "type": "array"
                }
              },
              "required": [
                "data"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "duplicate_count": {
                  "description": "Count of duplicates removed",
                  "order": 2,
                  "title": "Duplicate count",
                  "type": "integer"
                },
                "element_count": {
                  "description": "Count of each element",
                  "order": 3,
                  "title": "Element count",
                  "type": "object"
                },
                "result": {
                  "description": "Result without duplicates",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Result",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d": {
            "nodeId": "2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d",
            "name": "hunt_results-ip-convert_to_string",
            "type": "action",
            "plugin": {
              "name": "Type Converter",
              "slugVendor": "rapid7",
              "slugName": "type_converter",
              "slugVersion": "1.8.2",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/type_converter/1.8.2/icon.png"
            },
            "identifier": "array_to_string",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "delimiter": "",
                "input": "{{[fd293814-a8e3-4907-96ff-fa045ef722c4].[ip_addrs]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "delimiter": {
                  "description": "Characters used to join an array to a string. Default is a space, if not provided by user",
                  "order": 2,
                  "title": "Delimiter",
                  "type": "string"
                },
                "input": {
                  "description": "Array to convert",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Input",
                  "type": "array"
                }
              },
              "required": [
                "input"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "output": {
                  "description": "Joined string",
                  "order": 1,
                  "title": "Output",
                  "type": "string"
                }
              },
              "required": [
                "output"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "365507a2-566f-4bb8-9e8a-5add9e094ec1": {
            "nodeId": "365507a2-566f-4bb8-9e8a-5add9e094ec1",
            "name": "IR-decid-indicator_new",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "c52b5006-84a0-4485-bdb2-86df6e416c9d",
              "stepControlParams": [
                {
                  "edgeId": "c52b5006-84a0-4485-bdb2-86df6e416c9d",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "49f6d3fc-ca4f-404b-9621-5ec9bad12236",
                  "expression": {
                    "left": {
                      "name": "03ca6f2e-82c0-4d8a-b73e-46ac657f312e.found",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[03ca6f2e-82c0-4d8a-b73e-46ac657f312e].[found]}} = true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "37531c18-0581-4f94-a344-e2a8b8790e45": {
            "nodeId": "37531c18-0581-4f94-a344-e2a8b8790e45",
            "name": "IPA-decid-decision_type",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "bfb17fe9-40e3-43ba-8b2c-f87c167de692",
              "stepControlParams": [
                {
                  "edgeId": "bfb17fe9-40e3-43ba-8b2c-f87c167de692",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "c2deaede-0e2d-49f2-8c3d-162fd2b79794",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "497cf0a3-3be8-47d4-bc6b-0d233f48e020.AbuseIPDB Threshold Met",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": true
                      },
                      "type": "binary"
                    },
                    "op": "OR",
                    "right": {
                      "left": {
                        "left": {
                          "name": "1eda1198-ea83-4420-93cb-0dbf6de10cae.Brute Force Detected",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": true
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "name": "1ac6da71-9d81-481c-8ba9-d38df3d042ed.Indicator Already Exists",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": true
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[497cf0a3-3be8-47d4-bc6b-0d233f48e020].[AbuseIPDB Threshold Met]}} = true || {{[1eda1198-ea83-4420-93cb-0dbf6de10cae].[Brute Force Detected]}} = true || {{[1ac6da71-9d81-481c-8ba9-d38df3d042ed].[Indicator Already Exists]}} = true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "497cf0a3-3be8-47d4-bc6b-0d233f48e020": {
            "nodeId": "497cf0a3-3be8-47d4-bc6b-0d233f48e020",
            "name": "IPA-join-abuseipdb_theshold_met",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "9af54a84-04d4-4309-bb5b-5a81a63a1be8",
                "74d0bd97-9c66-4955-99cc-8456f99a2dc6"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "AbuseIPDB Threshold Met",
                  "type": "boolean",
                  "variables": {
                    "74d0bd97-9c66-4955-99cc-8456f99a2dc6": true,
                    "9af54a84-04d4-4309-bb5b-5a81a63a1be8": false
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "AbuseIPDB Threshold Met": {
                  "description": "Emitted variable \"AbuseIPDB Threshold Met\"",
                  "order": 1,
                  "title": "AbuseIPDB Threshold Met",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "AbuseIPDB Threshold Met": {
                  "description": "Emitted variable \"AbuseIPDB Threshold Met\"",
                  "order": 1,
                  "title": "AbuseIPDB Threshold Met",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "4c664ff1-99ec-47bb-a858-ab195866796f": {
            "nodeId": "4c664ff1-99ec-47bb-a858-ab195866796f",
            "name": "IPA-decid-brute_force",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "21e1b57c-d558-400b-bf4f-e3fffbba5f55",
              "stepControlParams": [
                {
                  "edgeId": "21e1b57c-d558-400b-bf4f-e3fffbba5f55",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "805c857a-0c43-44b4-a933-aabfee2e4f02",
                  "expression": {
                    "left": {
                      "args": [
                        {
                          "name": "26ef9167-e1b2-4d32-b3a3-a7a0f3eea524.rows",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": ">=",
                    "right": {
                      "name": "$workflow.Login Attempt Threshold",
                      "type": "variable"
                    },
                    "type": "binary"
                  },
                  "expressionText": "length({{[26ef9167-e1b2-4d32-b3a3-a7a0f3eea524].[rows]}}) >= {{$workflow.[Login Attempt Threshold]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "4ca06543-b8d9-4923-97f9-2463aaaafd4f": {
            "nodeId": "4ca06543-b8d9-4923-97f9-2463aaaafd4f",
            "name": "Loop-ip_analysis",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "left": {
                          "name": "37531c18-0581-4f94-a344-e2a8b8790e45.path",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": "automated"
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "name": "f02008de-9637-431e-81be-bc715badc75a.path",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": "blacklist indicator"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[37531c18-0581-4f94-a344-e2a8b8790e45].[path]}} = \"automated\" || {{[f02008de-9637-431e-81be-bc715badc75a].[path]}} = \"blacklist indicator\"",
                    "value": "{{[4ca06543-b8d9-4923-97f9-2463aaaafd4f].[$item]}}",
                    "valueType": "string"
                  },
                  "name": "indicators-ipaddress",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "13bd5627-0bf6-4b28-9041-3be00799d504",
              "nextEdgeId": "6df2f436-1357-4db6-a110-69149b546559",
              "repeatVariable": "{{[29e2c949-6c24-4cc1-b6ae-c6fd6628cf4a].[result]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "indicators-ipaddress": {
                  "description": "Custom output: \"indicators-ipaddress\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "indicators-ipaddress",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "57c16d53-7fee-43db-97c1-6bb6508553a2": {
            "nodeId": "57c16d53-7fee-43db-97c1-6bb6508553a2",
            "name": "RemoteIP Login Attempt",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "# {{[6a098bf4-e5fb-4b93-810a-7b7a4ca920a9].[ipAddress]}}\n### abuseConfidenceScore: {{[6a098bf4-e5fb-4b93-810a-7b7a4ca920a9].[abuseConfidenceScore]}}\n> **domain:** {{[6a098bf4-e5fb-4b93-810a-7b7a4ca920a9].[domain]}}\n> **countryName:** {{[6a098bf4-e5fb-4b93-810a-7b7a4ca920a9].[countryName]}}\n> **countryCode:** {{[6a098bf4-e5fb-4b93-810a-7b7a4ca920a9].[countryCode]}}\n> **isp:** {{[6a098bf4-e5fb-4b93-810a-7b7a4ca920a9].[isp]}}\n\n**Repeat Detection:** {{[5806486e-ac30-4e7d-a022-4106738aeca7].[found]}}\n\n**Brute Force Attempt Detected:** {{[1eda1198-ea83-4420-93cb-0dbf6de10cae].[Brute Force Detected]}} \\\nTotal Reports: {{[6a098bf4-e5fb-4b93-810a-7b7a4ca920a9].[totalReports]}} \\\nLast Reported: {{[6a098bf4-e5fb-4b93-810a-7b7a4ca920a9].[lastReportedAt]}}\n"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "5806486e-ac30-4e7d-a022-4106738aeca7": {
            "nodeId": "5806486e-ac30-4e7d-a022-4106738aeca7",
            "name": "IPA-lookup-blocked_ip_addresses",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "value"
                },
                "op": "=",
                "right": {
                  "name": "4ca06543-b8d9-4923-97f9-2463aaaafd4f.$item",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'value' = {{[4ca06543-b8d9-4923-97f9-2463aaaafd4f].[$item]}}",
              "ignoreCase": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts",
            "globalArtifact": {
              "name": "Blocked IP Addresses",
              "id": "a4cda292-1ce2-4e87-85aa-e427014f21be",
              "schema": {
                "definitions": {},
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              }
            },
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "6a098bf4-e5fb-4b93-810a-7b7a4ca920a9": {
            "nodeId": "6a098bf4-e5fb-4b93-810a-7b7a4ca920a9",
            "name": "IPA-abuseipdb-ip_lookup",
            "type": "action",
            "plugin": {
              "name": "AbuseIPDB",
              "slugVendor": "rapid7",
              "slugName": "abuseipdb",
              "slugVersion": "5.1.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/abuseipdb/5.1.0/icon.png"
            },
            "identifier": "check_ip",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[4ca06543-b8d9-4923-97f9-2463aaaafd4f].[$item]}}",
                "days": "30",
                "verbose": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IPv4 or IPv6 address e.g. 198.51.100.100, ::1, must be subscribed to accept bitmask wider than 255.255.255.0 (/24)",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                },
                "days": {
                  "default": "30",
                  "description": "Check for IP reports in the last x days",
                  "order": 2,
                  "title": "Days",
                  "type": "string"
                },
                "verbose": {
                  "default": true,
                  "description": "When set, reports will include the comment (if any) and the reporter's user ID number (0 if reported anonymously)",
                  "order": 3,
                  "title": "Verbose",
                  "type": "boolean"
                }
              },
              "required": [
                "address",
                "days",
                "verbose"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "report": {
                  "properties": {
                    "categories": {
                      "description": "List of categories",
                      "items": {
                        "type": "integer"
                      },
                      "order": 3,
                      "title": "Categories",
                      "type": "array"
                    },
                    "comment": {
                      "description": "Comment by reporter",
                      "order": 2,
                      "title": "Comment",
                      "type": "string"
                    },
                    "reportedAt": {
                      "description": "Date and time of report",
                      "order": 1,
                      "title": "Reported At",
                      "type": "string"
                    },
                    "reporterCountryCode": {
                      "description": "Country code of the reporter",
                      "order": 5,
                      "title": "Reporter Country Code",
                      "type": "string"
                    },
                    "reporterCountryName": {
                      "description": "Name of country reporter is from",
                      "order": 6,
                      "title": "Reporter Country Name",
                      "type": "string"
                    },
                    "reporterId": {
                      "description": "ID number of reporter",
                      "order": 4,
                      "title": "Reporter ID",
                      "type": "integer"
                    }
                  },
                  "title": "Report",
                  "type": "object"
                }
              },
              "properties": {
                "abuseConfidenceScore": {
                  "description": "Confidence of Abuse",
                  "order": 5,
                  "title": "Abuse Confidence Score",
                  "type": "integer"
                },
                "countryCode": {
                  "description": "Code of country IP is registered in",
                  "order": 6,
                  "title": "Country Code",
                  "type": "string"
                },
                "countryName": {
                  "description": "Name of Country IP is registered in",
                  "order": 10,
                  "title": "Country Name",
                  "type": "string"
                },
                "domain": {
                  "description": "Domain Name of IP",
                  "order": 9,
                  "title": "Domain",
                  "type": "string"
                },
                "found": {
                  "description": "Whether an IP address was found, indicating it may be malicious",
                  "order": 15,
                  "title": "Found",
                  "type": "boolean"
                },
                "ipAddress": {
                  "description": "Queried IP Address",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                },
                "ipVersion": {
                  "description": "Version of IP Address",
                  "order": 3,
                  "title": "IP Version",
                  "type": "integer"
                },
                "isPublic": {
                  "description": "Whether or not the IP Address is public",
                  "order": 2,
                  "title": "Is Public",
                  "type": "boolean"
                },
                "isWhitelisted": {
                  "description": "Whether or not IP Address is whitelisted",
                  "order": 4,
                  "title": "Is Whitelisted",
                  "type": "boolean"
                },
                "isp": {
                  "description": "Internet Service Provider for IP",
                  "order": 8,
                  "title": "ISP",
                  "type": "string"
                },
                "lastReportedAt": {
                  "description": "Date of last report",
                  "order": 13,
                  "title": "Last Reported At",
                  "type": "string"
                },
                "numDistinctUsers": {
                  "description": "Number of distinct users who reported IP",
                  "order": 12,
                  "title": "Number of Distinct Users",
                  "type": "integer"
                },
                "reports": {
                  "description": "List of reports",
                  "items": {
                    "$ref": "#/definitions/report"
                  },
                  "order": 14,
                  "title": "Reports",
                  "type": "array"
                },
                "totalReports": {
                  "description": "Total number of reports of abuse",
                  "order": 11,
                  "title": "Total Reports",
                  "type": "integer"
                },
                "usageType": {
                  "description": "How IP is used",
                  "order": 7,
                  "title": "Usage Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "6b80b195-1da8-408f-8663-09c1c7a7b884": {
            "nodeId": "6b80b195-1da8-408f-8663-09c1c7a7b884",
            "name": "IR-atp-blacklist_indicator",
            "type": "action",
            "plugin": {
              "name": "Microsoft Windows Defender ATP",
              "slugVendor": "rapid7",
              "slugName": "microsoft_atp",
              "slugVersion": "5.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_atp/5.0.0/icon.png"
            },
            "identifier": "blacklist",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "action": "AlertAndBlock",
                "application": "",
                "description": "A public remote IP address that attempted to access an endpoint.",
                "expiration_time": "",
                "indicator": "{{[11c17b24-0760-44e5-91ef-cd0e43261bde].[$item]}}",
                "indicator_state": true,
                "rbac_group_names": [],
                "recommended_actions": "Validate no successful attempts were made.",
                "severity": "Low",
                "title": "Public RemoteIP Login Attempt"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "action": {
                  "default": "AlertAndBlock",
                  "description": "The action that will be taken if the indicator will be discovered in the organization",
                  "enum": [
                    "Alert",
                    "AlertAndBlock",
                    "Allowed"
                  ],
                  "order": 2,
                  "title": "Action",
                  "type": "string"
                },
                "application": {
                  "description": "The application associated with the indicator",
                  "order": 3,
                  "title": "Application",
                  "type": "string"
                },
                "description": {
                  "default": "Indicator Blacklisted from InsightConnect",
                  "description": "Description of the indicator",
                  "order": 5,
                  "title": "Description",
                  "type": "string"
                },
                "expiration_time": {
                  "description": "The expiration time of the indicator, default value is one year from now",
                  "order": 6,
                  "title": "Expiration Time",
                  "type": "string"
                },
                "indicator": {
                  "description": "A supported indicator to blacklist or unblacklist. Supported indicators are IP addresses, URLs, domains, and SHA1 and SHA256 hashes",
                  "order": 1,
                  "title": "Indicator",
                  "type": "string"
                },
                "indicator_state": {
                  "default": false,
                  "description": "True to add indicator, false to remove it from the list",
                  "order": 10,
                  "title": "Indicator State",
                  "type": "boolean"
                },
                "rbac_group_names": {
                  "description": "List of RBAC group names the indicator would be applied to",
                  "items": {
                    "type": "string"
                  },
                  "order": 9,
                  "title": "RBAC Group Names",
                  "type": "array"
                },
                "recommended_actions": {
                  "description": "TI indicator alert recommended actions",
                  "order": 8,
                  "title": "Recommended Actions",
                  "type": "string"
                },
                "severity": {
                  "default": "High",
                  "description": "The severity of the indicator",
                  "enum": [
                    "Informational",
                    "Low",
                    "Medium",
                    "High"
                  ],
                  "order": 7,
                  "title": "Severity",
                  "type": "string"
                },
                "title": {
                  "description": "Indicator alert title",
                  "order": 4,
                  "title": "Title",
                  "type": "string"
                }
              },
              "required": [
                "indicator"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "indicator_action": {
                  "properties": {
                    "@odata.context": {
                      "description": "@odata.context",
                      "order": 1,
                      "title": "@Odata.Context",
                      "type": "string"
                    },
                    "action": {
                      "description": "The action that will be taken if the indicator will be discovered in the organization",
                      "order": 6,
                      "title": "Action",
                      "type": "string"
                    },
                    "application": {
                      "description": "The application associated with the indicator",
                      "order": 5,
                      "title": "Application",
                      "type": "string"
                    },
                    "createdBy": {
                      "description": "Unique identity of the user/application that submitted the indicator",
                      "order": 9,
                      "title": "Created By",
                      "type": "string"
                    },
                    "createdByDisplayName": {
                      "description": "Created by display name",
                      "order": 10,
                      "title": "Created By Display Name",
                      "type": "string"
                    },
                    "createdBySource": {
                      "description": "Created by source",
                      "order": 11,
                      "title": "Created By Source",
                      "type": "string"
                    },
                    "creationTimeDateTimeUtc": {
                      "description": "The date and time when the indicator was created",
                      "order": 16,
                      "title": "Creation Time",
                      "type": "string"
                    },
                    "description": {
                      "description": "Description of the indicator",
                      "order": 21,
                      "title": "Description",
                      "type": "string"
                    },
                    "expirationTime": {
                      "description": "The expiration time of the indicator",
                      "order": 17,
                      "title": "Expiration Time",
                      "type": "string"
                    },
                    "generateAlert": {
                      "description": "Generate alert",
                      "order": 12,
                      "title": "Generate Alert",
                      "type": "boolean"
                    },
                    "historicalDetection": {
                      "description": "Historical detection",
                      "order": 13,
                      "title": "Historical Detection",
                      "type": "boolean"
                    },
                    "id": {
                      "description": "Identity of the indicator entity",
                      "order": 2,
                      "title": "Indicator ID",
                      "type": "string"
                    },
                    "indicatorType": {
                      "description": "Type of the indicator",
                      "order": 4,
                      "title": "Indicator Type",
                      "type": "string"
                    },
                    "indicatorValue": {
                      "description": "The potentially malicious indicator of one of the following types: IP addresses, URLs, domains, and SHA1 and SHA256 hashes",
                      "order": 3,
                      "title": "Indicator Value",
                      "type": "string"
                    },
                    "lastUpdateTime": {
                      "description": "The last time the indicator was updated",
                      "order": 18,
                      "title": "Last Update Time",
                      "type": "string"
                    },
                    "lastUpdatedBy": {
                      "description": "Identity of the user/application that last updated the indicator",
                      "order": 14,
                      "title": "Last Updated By",
                      "type": "string"
                    },
                    "mitreTechniques": {
                      "description": "MITRE techniques",
                      "items": {
                        "type": "string"
                      },
                      "order": 15,
                      "title": "MITRE Techniques",
                      "type": "array"
                    },
                    "rbacGroupIds": {
                      "description": "RBAC group IDs",
                      "items": {
                        "type": "string"
                      },
                      "order": 23,
                      "title": "RBAC Group IDs",
                      "type": "array"
                    },
                    "rbacGroupNames": {
                      "description": "RBAC device group names where the indicator is exposed and active. Empty list in case it exposed to all devices",
                      "items": {
                        "type": "string"
                      },
                      "order": 24,
                      "title": "RBAC Group Names",
                      "type": "array"
                    },
                    "recommendedActions": {
                      "description": "Recommended actions for the indicator",
                      "order": 22,
                      "title": "Recommended Actions",
                      "type": "string"
                    },
                    "severity": {
                      "description": "The severity of the indicator",
                      "order": 19,
                      "title": "Severity",
                      "type": "string"
                    },
                    "source": {
                      "description": "The name of the user/application that submitted the indicator",
                      "order": 8,
                      "title": "Source",
                      "type": "string"
                    },
                    "sourceType": {
                      "description": "User in case the Indicator created by a user (e.g. from the portal), AadApp in case it submitted using automated application via the API.",
                      "order": 7,
                      "title": "Source Type",
                      "type": "string"
                    },
                    "title": {
                      "description": "Indicator alert title",
                      "order": 20,
                      "title": "Title",
                      "type": "string"
                    }
                  },
                  "title": "Indicator Action",
                  "type": "object"
                }
              },
              "properties": {
                "indicator_action_response": {
                  "$ref": "#/definitions/indicator_action",
                  "description": "A response that includes the result of the action, and supplemental information about the action taken",
                  "order": 1,
                  "title": "Indicator Action Response"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "86b201b8-b091-4cca-b97c-648aa46ae545": {
            "nodeId": "86b201b8-b091-4cca-b97c-648aa46ae545",
            "name": "IR-email-new_indicator",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "6.0.4",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/6.0.4/icon.png"
            },
            "identifier": "send_email",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "attachment": [],
                "bcc": [],
                "body": "<h2>Indicator Added to Microsoft Defender</h2>\nA new indicator was added to Microsoft Defender for Endpoints based on findings in InsightConnect. Details of the finding are listed below.\n<h4>{{[11c17b24-0760-44e5-91ef-cd0e43261bde].[$item]}}</h4>\n<b>Indicator Type:</b> ipaddress<br>\n<b>domain: </b>{{[dcf5a055-3452-43f6-afef-6c85c3460384].[domain]}}<br>\n<b>countryName: </b>{{[dcf5a055-3452-43f6-afef-6c85c3460384].[countryName]}}<br>\n<b>isp: </b>{{[dcf5a055-3452-43f6-afef-6c85c3460384].[isp]}}\n<br>\n<h4>AbuseIPDB Score</h4>\n<b>AbuseConfidenceScore: </b>{{[dcf5a055-3452-43f6-afef-6c85c3460384].[abuseConfidenceScore]}}<br>\n<b>lastreportedAt: </b>{{[dcf5a055-3452-43f6-afef-6c85c3460384].[lastReportedAt]}}<br>\n<br>\nRefer to <a href=\"{{[$job].[URL]}}\">InsightConnect Job</a>\nfor additional details.",
                "cc": [],
                "email_from": "{{$workflow.[Email Sender]}}",
                "email_to": [
                  "{{$workflow.[Email Recipient]}}"
                ],
                "is_html": true,
                "subject": "New Indicator "
              }
            },
            "defaultInputJSONSchema": {
              "definitions": {
                "file": {
                  "description": "File Object",
                  "properties": {
                    "content": {
                      "description": "File contents",
                      "format": "bytes",
                      "title": "Content",
                      "type": "string"
                    },
                    "filename": {
                      "description": "Name of file",
                      "title": "Filename",
                      "type": "string"
                    }
                  },
                  "title": "File",
                  "type": "object"
                }
              },
              "properties": {
                "attachment": {
                  "description": "Accepts one or more attachment represented as a file type which contains the filename and the file content encoded with base64",
                  "items": {
                    "$ref": "#/definitions/file"
                  },
                  "order": 8,
                  "title": "Attachment",
                  "type": "array"
                },
                "bcc": {
                  "description": "Blind carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 6,
                  "title": "BCC",
                  "type": "array"
                },
                "body": {
                  "description": "Body of the email",
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "cc": {
                  "description": "Carbon copy recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 7,
                  "title": "CC",
                  "type": "array"
                },
                "email_from": {
                  "description": "Email address this email will be sent from",
                  "order": 1,
                  "title": "Email Sender",
                  "type": "string"
                },
                "email_to": {
                  "description": "One or more email addresses of recipients",
                  "items": {
                    "type": "string"
                  },
                  "order": 2,
                  "title": "Email To",
                  "type": "array"
                },
                "is_html": {
                  "description": "Is the body of this email HTML",
                  "order": 5,
                  "title": "Is HTML",
                  "type": "boolean"
                },
                "subject": {
                  "description": "Subject of the email",
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "required": [
                "email_from",
                "email_to",
                "subject",
                "body",
                "is_html"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "success": {
                  "description": "Success",
                  "order": 1,
                  "title": "Success",
                  "type": "boolean"
                }
              },
              "required": [
                "success"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "c137b4b5-c8f9-4f7e-8cf8-cffa431232f6": {
            "nodeId": "c137b4b5-c8f9-4f7e-8cf8-cffa431232f6",
            "name": "IPA-decid-ip_address_exists",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "cc2ce569-aff8-4937-b608-a21fb9907cfd",
              "stepControlParams": [
                {
                  "edgeId": "e380073c-db01-4d8d-afe8-34582309a645",
                  "expression": {
                    "left": {
                      "name": "5806486e-ac30-4e7d-a022-4106738aeca7.found",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[5806486e-ac30-4e7d-a022-4106738aeca7].[found]}} = true"
                },
                {
                  "edgeId": "cc2ce569-aff8-4937-b608-a21fb9907cfd",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "cd57ad57-3516-4bbc-b156-c277efe9a436": {
            "nodeId": "cd57ad57-3516-4bbc-b156-c277efe9a436",
            "name": "IPA-decid-abuseipdb_threshold_met",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "9af54a84-04d4-4309-bb5b-5a81a63a1be8",
              "stepControlParams": [
                {
                  "edgeId": "74d0bd97-9c66-4955-99cc-8456f99a2dc6",
                  "expression": {
                    "left": {
                      "name": "6a098bf4-e5fb-4b93-810a-7b7a4ca920a9.abuseConfidenceScore",
                      "type": "variable"
                    },
                    "op": ">=",
                    "right": {
                      "name": "$workflow.Abuse Confidence Threshold",
                      "type": "variable"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[6a098bf4-e5fb-4b93-810a-7b7a4ca920a9].[abuseConfidenceScore]}} >= {{[$workflow].[Abuse Confidence Threshold]}}"
                },
                {
                  "edgeId": "9af54a84-04d4-4309-bb5b-5a81a63a1be8",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "d354d61c-3a1e-4715-b412-a3c64a37d6f4": {
            "nodeId": "d354d61c-3a1e-4715-b412-a3c64a37d6f4",
            "name": "Timer",
            "type": "trigger",
            "plugin": {
              "name": "Timers",
              "slugVendor": "rapid7",
              "slugName": "timers",
              "slugVersion": "3.0.1",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/timers/3.0.1/icon.png"
            },
            "identifier": "periodic",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "message": "",
                "period": "{{[$workflow].[Run Frequency]}}"
              }
            },
            "triggerId": "390a5325-f502-48ca-944c-e6ec39a61e17",
            "defaultInputJSONSchema": {
              "properties": {
                "message": {
                  "description": "The message to send (optional)",
                  "order": 2,
                  "title": "Message",
                  "type": "string"
                },
                "period": {
                  "default": 60,
                  "description": "Minutes between events",
                  "order": 1,
                  "title": "Period",
                  "type": "integer"
                }
              },
              "required": [
                "period"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "message": {
                  "description": "The message sent",
                  "order": 1,
                  "title": "Message",
                  "type": "string"
                },
                "time": {
                  "description": "The UTC time of event returned in ISO format",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 2,
                  "title": "Time",
                  "type": "string"
                }
              },
              "required": [
                "message",
                "time"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "dcc7219b-0fbf-4943-8db5-c79b1fb40db7": {
            "nodeId": "dcc7219b-0fbf-4943-8db5-c79b1fb40db7",
            "name": "Query",
            "type": "action",
            "plugin": {
              "name": "Microsoft Defender Hunting",
              "slugVendor": "rapid7",
              "slugName": "microsoft_defender_hunting",
              "slugVersion": "1.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_defender_hunting/1.0.0/icon.png"
            },
            "identifier": "advanced_hunting",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "query": "DeviceLogonEvents \n| where RemoteIPType == \"Public\" and Timestamp > ago({{$workflow.[Run Frequency]}}m)\n| project DeviceName, RemoteIP, RemoteIPType, Timestamp"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "query": {
                  "description": "Advanced Hunting query to run",
                  "order": 1,
                  "title": "Query",
                  "type": "string"
                }
              },
              "required": [
                "query"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "column": {
                  "properties": {
                    "name": {
                      "description": "Column's name",
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "type": {
                      "description": "Column's data type",
                      "order": 2,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "Column",
                  "type": "object"
                }
              },
              "properties": {
                "columns": {
                  "description": "Schema containing response column's name and type",
                  "items": {
                    "$ref": "#/definitions/column"
                  },
                  "order": 1,
                  "title": "Columns",
                  "type": "array"
                },
                "rows": {
                  "description": "Array of objects containing query response values with keys as specific column name",
                  "items": {
                    "type": "object"
                  },
                  "order": 2,
                  "title": "Rows",
                  "type": "array"
                }
              },
              "required": [
                "columns",
                "rows"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "dcf5a055-3452-43f6-afef-6c85c3460384": {
            "nodeId": "dcf5a055-3452-43f6-afef-6c85c3460384",
            "name": "IR-abuseipdb-ip_lookup",
            "type": "action",
            "plugin": {
              "name": "AbuseIPDB",
              "slugVendor": "rapid7",
              "slugName": "abuseipdb",
              "slugVersion": "5.1.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/abuseipdb/5.1.0/icon.png"
            },
            "identifier": "check_ip",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "address": "{{[11c17b24-0760-44e5-91ef-cd0e43261bde].[$item]}}",
                "days": "30",
                "verbose": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "address": {
                  "description": "IPv4 or IPv6 address e.g. 198.51.100.100, ::1, must be subscribed to accept bitmask wider than 255.255.255.0 (/24)",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                },
                "days": {
                  "default": "30",
                  "description": "Check for IP reports in the last x days",
                  "order": 2,
                  "title": "Days",
                  "type": "string"
                },
                "verbose": {
                  "default": true,
                  "description": "When set, reports will include the comment (if any) and the reporter's user ID number (0 if reported anonymously)",
                  "order": 3,
                  "title": "Verbose",
                  "type": "boolean"
                }
              },
              "required": [
                "address",
                "days",
                "verbose"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "report": {
                  "properties": {
                    "categories": {
                      "description": "List of categories",
                      "items": {
                        "type": "integer"
                      },
                      "order": 3,
                      "title": "Categories",
                      "type": "array"
                    },
                    "comment": {
                      "description": "Comment by reporter",
                      "order": 2,
                      "title": "Comment",
                      "type": "string"
                    },
                    "reportedAt": {
                      "description": "Date and time of report",
                      "order": 1,
                      "title": "Reported At",
                      "type": "string"
                    },
                    "reporterCountryCode": {
                      "description": "Country code of the reporter",
                      "order": 5,
                      "title": "Reporter Country Code",
                      "type": "string"
                    },
                    "reporterCountryName": {
                      "description": "Name of country reporter is from",
                      "order": 6,
                      "title": "Reporter Country Name",
                      "type": "string"
                    },
                    "reporterId": {
                      "description": "ID number of reporter",
                      "order": 4,
                      "title": "Reporter ID",
                      "type": "integer"
                    }
                  },
                  "title": "Report",
                  "type": "object"
                }
              },
              "properties": {
                "abuseConfidenceScore": {
                  "description": "Confidence of Abuse",
                  "order": 5,
                  "title": "Abuse Confidence Score",
                  "type": "integer"
                },
                "countryCode": {
                  "description": "Code of country IP is registered in",
                  "order": 6,
                  "title": "Country Code",
                  "type": "string"
                },
                "countryName": {
                  "description": "Name of Country IP is registered in",
                  "order": 10,
                  "title": "Country Name",
                  "type": "string"
                },
                "domain": {
                  "description": "Domain Name of IP",
                  "order": 9,
                  "title": "Domain",
                  "type": "string"
                },
                "found": {
                  "description": "Whether an IP address was found, indicating it may be malicious",
                  "order": 15,
                  "title": "Found",
                  "type": "boolean"
                },
                "ipAddress": {
                  "description": "Queried IP Address",
                  "order": 1,
                  "title": "IP Address",
                  "type": "string"
                },
                "ipVersion": {
                  "description": "Version of IP Address",
                  "order": 3,
                  "title": "IP Version",
                  "type": "integer"
                },
                "isPublic": {
                  "description": "Whether or not the IP Address is public",
                  "order": 2,
                  "title": "Is Public",
                  "type": "boolean"
                },
                "isWhitelisted": {
                  "description": "Whether or not IP Address is whitelisted",
                  "order": 4,
                  "title": "Is Whitelisted",
                  "type": "boolean"
                },
                "isp": {
                  "description": "Internet Service Provider for IP",
                  "order": 8,
                  "title": "ISP",
                  "type": "string"
                },
                "lastReportedAt": {
                  "description": "Date of last report",
                  "order": 13,
                  "title": "Last Reported At",
                  "type": "string"
                },
                "numDistinctUsers": {
                  "description": "Number of distinct users who reported IP",
                  "order": 12,
                  "title": "Number of Distinct Users",
                  "type": "integer"
                },
                "reports": {
                  "description": "List of reports",
                  "items": {
                    "$ref": "#/definitions/report"
                  },
                  "order": 14,
                  "title": "Reports",
                  "type": "array"
                },
                "totalReports": {
                  "description": "Total number of reports of abuse",
                  "order": 11,
                  "title": "Total Reports",
                  "type": "integer"
                },
                "usageType": {
                  "description": "How IP is used",
                  "order": 7,
                  "title": "Usage Type",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0": {
            "nodeId": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0",
            "name": "loop-hunt_results",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d.$success",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": true
                        },
                        "type": "binary"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "name": "2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d.$success",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": true
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "is_defined({{[2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d].[$success]}}) = true && {{[2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d].[$success]}} = true",
                    "value": "{{[2d2d334a-7cae-4a7d-bd69-6b0f4e9c008d].[output]}}",
                    "valueType": "string"
                  },
                  "name": "Extracted_IPs",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "ef4a2c65-0935-4cf1-ab9f-e71643c3f218",
              "nextEdgeId": "892d757c-4587-456b-8626-babeeb0058a7",
              "repeatVariable": "{{[dcc7219b-0fbf-4943-8db5-c79b1fb40db7].[rows]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "Extracted_IPs": {
                  "description": "Custom output: \"Extracted_IPs\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "Extracted_IPs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "f02008de-9637-431e-81be-bc715badc75a": {
            "nodeId": "f02008de-9637-431e-81be-bc715badc75a",
            "name": "IPA-human-blacklist",
            "type": "human_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "",
              "notifications": {
                "artifactIds": [
                  "57c16d53-7fee-43db-97c1-6bb6508553a2"
                ],
                "userIdsForEmail": []
              },
              "stepControlParams": [
                {
                  "edgeId": "44f50c85-b740-4a95-b5a5-4eb06dade2ea",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "f02008de-9637-431e-81be-bc715badc75a"
                },
                {
                  "edgeId": "8e4f6b41-bdf3-4990-b5c0-e946b5001636",
                  "expression": {},
                  "expressionText": "",
                  "isTimeoutOnly": false,
                  "nodeId": "f02008de-9637-431e-81be-bc715badc75a"
                }
              ],
              "timeout": null,
              "timeoutDisplayUnit": null,
              "timeoutEdgeId": null
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/human-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "f567c9db-0ce1-43dc-b6ee-04885557b78a": {
            "nodeId": "f567c9db-0ce1-43dc-b6ee-04885557b78a",
            "name": "filter-hunt_results_found",
            "type": "filter",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "d7f1e482-e132-4986-a0ac-d7a2e95aad8c",
                "expression": {
                  "left": {
                    "left": {
                      "args": [
                        {
                          "name": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0.Extracted_IPs",
                          "type": "variable"
                        }
                      ],
                      "name": "is_defined",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "op": "OR",
                  "right": {
                    "left": {
                      "args": [
                        {
                          "name": "dd6dda5e-75c5-4c7c-84ee-21da06ce93b0.Extracted_IPs",
                          "type": "variable"
                        }
                      ],
                      "name": "length",
                      "type": "function"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": 0
                    },
                    "type": "binary"
                  },
                  "type": "binary"
                },
                "expressionText": "is_defined({{[dd6dda5e-75c5-4c7c-84ee-21da06ce93b0].[Extracted_IPs]}}) = false || length({{[dd6dda5e-75c5-4c7c-84ee-21da06ce93b0].[Extracted_IPs]}}) = 0"
              },
              "stopOnMatch": true
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/filter.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "f68338a6-21b2-4d6a-acf8-441cd6f4efb5": {
            "nodeId": "f68338a6-21b2-4d6a-acf8-441cd6f4efb5",
            "name": "Repeat Indicator",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## Indicator Updated in Microsoft Defender\nAn existing indicator in Microsoft Defender for Endpoints was updated. Details of the finding are listed below.\n### {{[11c17b24-0760-44e5-91ef-cd0e43261bde].[$item]}}\n**Indicator Type:** ipaddress \\\n**domain:** {{[dcf5a055-3452-43f6-afef-6c85c3460384].[domain]}} \\\n**countryName:** {{[dcf5a055-3452-43f6-afef-6c85c3460384].[countryName]}} \\\n**isp:** {{[dcf5a055-3452-43f6-afef-6c85c3460384].[isp]}} \\ \n\n\n### AbuseIPDB Score\n**AbuseConfidenceScore:** {{[dcf5a055-3452-43f6-afef-6c85c3460384].[abuseConfidenceScore]}} \\ \n**lastreportedAt:** {{[dcf5a055-3452-43f6-afef-6c85c3460384].[lastReportedAt]}} \\\n\n### New Indicator Information\n**creationTimeDateTime:** {{[6b80b195-1da8-408f-8663-09c1c7a7b884].[indicator_action_response].[creationTimeDateTimeUtc]}} \\\n**lastUpdateTime:** {{[6b80b195-1da8-408f-8663-09c1c7a7b884].[indicator_action_response].[lastUpdateTime]}} \\\n**expirationTime:** {{[6b80b195-1da8-408f-8663-09c1c7a7b884].[indicator_action_response].[expirationTime]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "fd293814-a8e3-4907-96ff-fa045ef722c4": {
            "nodeId": "fd293814-a8e3-4907-96ff-fa045ef722c4",
            "name": "hunt_results-extractip",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "3.0.8",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/3.0.8/icon.png"
            },
            "identifier": "ip_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[dd6dda5e-75c5-4c7c-84ee-21da06ce93b0].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes, supports text and binary file types such as PDF, DOCX, XLSX, PPTX, ODT, ODP, ODS",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "ip_addrs": {
                  "description": "List of extracted IP Addresses",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "IP Addresses",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          }
        },
        "tags": [
          "Endpoint Detection & Response",
          "Network & Firewall",
          "Threat Intelligence"
        ],
        "humanCostSeconds": 1800,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Email Sender": {
                "type": "string",
                "description": "Email address that notification(s) should come from."
              },
              "Run Frequency": {
                "type": "integer",
                "description": "Number of minutes between each query."
              },
              "Email Recipient": {
                "type": "string",
                "description": "This is the email address that will receive notifications when a new indicator was added."
              },
              "Login Attempt Threshold": {
                "type": "integer",
                "description": "If login attempts in the last hour are greater than or equal to this integer then the IP address will be automatically blocked."
              },
              "Abuse Confidence Threshold": {
                "type": "integer",
                "description": "Minimum AbuseIPDB threshold required to automate remediation action."
              }
            },
            "definitions": {}
          }
        },
        "summary": "This workflow runs a query that pulls remote public IP addresses and checks them against AbuseIPDB and the total number of login attempts. Based on these results, the workflow then automatically adds the IP address as an indicator in Microsoft Defender for Endpoint."
      }
    ],
    "triggers": [
      {
        "id": "390a5325-f502-48ca-944c-e6ec39a61e17",
        "identifier": "periodic",
        "name": "Timer",
        "description": "",
        "input": {
          "message": "",
          "period": "{{[$workflow].[Run Frequency]}}"
        },
        "inputJsonSchema": {
          "properties": {
            "message": {
              "description": "The message to send (optional)",
              "order": 2,
              "title": "Message",
              "type": "string"
            },
            "period": {
              "default": 60,
              "description": "Minutes between events",
              "order": 1,
              "title": "Period",
              "type": "integer"
            }
          },
          "required": [
            "period"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "properties": {
            "message": {
              "description": "The message sent",
              "order": 1,
              "title": "Message",
              "type": "string"
            },
            "time": {
              "description": "The UTC time of event returned in ISO format",
              "displayType": "date",
              "format": "date-time",
              "order": 2,
              "title": "Time",
              "type": "string"
            }
          },
          "required": [
            "message",
            "time"
          ],
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Timers",
          "slugVendor": "rapid7",
          "slugName": "timers",
          "slugVersion": "3.0.1",
          "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/timers/3.0.1/icon.png"
        }
      }
    ]
  }
}