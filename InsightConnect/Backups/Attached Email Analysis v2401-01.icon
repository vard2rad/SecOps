{
  "kom": {
    "komandVersion": "1.176.4-0-gb65a8",
    "komFileVersion": "2.0.0",
    "exportedAt": "2024-01-04T14:55:14.151912316Z",
    "workflowVersions": [
      {
        "name": "Attached Email Analysis",
        "type": "runnable",
        "version": "",
        "description": "",
        "graph": {
          "edges": {
            "045bc137-3abb-4b4c-8779-6bb04070f198": {
              "id": "045bc137-3abb-4b4c-8779-6bb04070f198",
              "name": "",
              "description": "",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116",
              "fromNodeId": "58ad50ac-2664-4b28-95b0-344d6e9121e5",
              "toNodeId": ""
            },
            "05768e1e-d44a-4071-8786-4e590fccd78d": {
              "id": "05768e1e-d44a-4071-8786-4e590fccd78d",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "7d512657-e6cf-4a55-9b37-5bae2a359173",
              "toNodeId": "1f850c57-7b9b-47f3-884d-f91812370e72"
            },
            "17e1742e-0a8c-415e-8d39-84d7abe594fb": {
              "id": "17e1742e-0a8c-415e-8d39-84d7abe594fb",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5c9d2ecb-8c91-48fa-a770-f9886339013d",
              "toNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "1cb6ab21-89a5-4dd8-a4c8-f12945ff9a45": {
              "id": "1cb6ab21-89a5-4dd8-a4c8-f12945ff9a45",
              "name": "Invalid",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "b898abb0-4e47-44f6-87ce-e418e454d43a",
              "toNodeId": ""
            },
            "21f5bf30-1b7f-4ec2-85f0-a22cee5b65a3": {
              "id": "21f5bf30-1b7f-4ec2-85f0-a22cee5b65a3",
              "name": "",
              "description": "",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116",
              "fromNodeId": "76aed74b-5429-4f97-a711-f91a9d7d9121",
              "toNodeId": "311ca1c6-6ee5-4a28-a53d-ecf86322d89a"
            },
            "27ac3bca-5fe2-479f-91a5-3bd7d1113718": {
              "id": "27ac3bca-5fe2-479f-91a5-3bd7d1113718",
              "name": "True",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "5ecaea1a-4fc4-4f8e-8ea1-79615d162252",
              "toNodeId": "3c832c1a-3d96-47ca-b150-a4a38e144954"
            },
            "2aebc24d-c281-4c2e-8fd7-26f49b2845c2": {
              "id": "2aebc24d-c281-4c2e-8fd7-26f49b2845c2",
              "name": "",
              "description": "",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116",
              "fromNodeId": "d3b75341-0a96-4366-934d-ee5a48fc195c",
              "toNodeId": "58ad50ac-2664-4b28-95b0-344d6e9121e5"
            },
            "2b8ed42b-172d-4819-a015-a1c55cb625b5": {
              "id": "2b8ed42b-172d-4819-a015-a1c55cb625b5",
              "name": "Not Found",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "9b96ee9f-6d05-4f12-ac88-a30e3d1cd713",
              "toNodeId": "52d62575-8570-4769-9806-125f2c32e599"
            },
            "380a636d-57ed-4f11-99bf-cbb301387335": {
              "id": "380a636d-57ed-4f11-99bf-cbb301387335",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "toNodeId": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b"
            },
            "38a9dfe9-5841-4b16-94e5-9893c3954778": {
              "id": "38a9dfe9-5841-4b16-94e5-9893c3954778",
              "name": "Resume",
              "description": "",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116",
              "fromNodeId": "f95d0442-4cc2-4f42-94e9-a47ca89ad612",
              "toNodeId": "d3b75341-0a96-4366-934d-ee5a48fc195c"
            },
            "3a800ce2-eeed-4915-84ab-1ecf60e156d3": {
              "id": "3a800ce2-eeed-4915-84ab-1ecf60e156d3",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "27ba9513-6b1d-4367-b210-500c5f84c2ed",
              "toNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "3f5281f9-4c82-4495-a591-6bc898161f26": {
              "id": "3f5281f9-4c82-4495-a591-6bc898161f26",
              "name": "High Risk",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "b898abb0-4e47-44f6-87ce-e418e454d43a",
              "toNodeId": "ec5e4ea6-f193-487f-90dd-c1eceb7076c5"
            },
            "438ed644-2e8d-48e0-b26a-4233ff7a6df8": {
              "id": "438ed644-2e8d-48e0-b26a-4233ff7a6df8",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "toNodeId": "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec"
            },
            "48af1ac3-319a-49e1-a46d-d08983c1ca50": {
              "id": "48af1ac3-319a-49e1-a46d-d08983c1ca50",
              "name": "False",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "9577c0ce-2371-4327-9178-1a4cf1432864",
              "toNodeId": "3c832c1a-3d96-47ca-b150-a4a38e144954"
            },
            "4b865c1c-b595-4021-8aae-2bd156c0f91c": {
              "id": "4b865c1c-b595-4021-8aae-2bd156c0f91c",
              "name": "No risk",
              "description": "Domain reputation has a positive reputation.",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "791a66c7-b41b-400c-b9aa-2fb95c58343b",
              "toNodeId": "3789bc21-24b3-41d2-8dc2-9a3772420e34"
            },
            "4c96eb11-5f6f-408f-ac15-812537fa3053": {
              "id": "4c96eb11-5f6f-408f-ac15-812537fa3053",
              "name": "Found",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "9b96ee9f-6d05-4f12-ac88-a30e3d1cd713",
              "toNodeId": ""
            },
            "55c00558-e3af-4ddd-bea8-129badc9caaf": {
              "id": "55c00558-e3af-4ddd-bea8-129badc9caaf",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "3789bc21-24b3-41d2-8dc2-9a3772420e34",
              "toNodeId": "9577c0ce-2371-4327-9178-1a4cf1432864"
            },
            "60a2e8a7-60f9-4996-9341-7034f0d47f87": {
              "id": "60a2e8a7-60f9-4996-9341-7034f0d47f87",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "48b34d41-dce5-43c2-9e37-6a18690c97b7",
              "toNodeId": "5c9d2ecb-8c91-48fa-a770-f9886339013d"
            },
            "666f5e79-6719-423a-a08b-0db31da8c9c7": {
              "id": "666f5e79-6719-423a-a08b-0db31da8c9c7",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "ec5e4ea6-f193-487f-90dd-c1eceb7076c5",
              "toNodeId": ""
            },
            "6cacde1f-46f2-4291-afca-f30fe6097cad": {
              "id": "6cacde1f-46f2-4291-afca-f30fe6097cad",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec",
              "toNodeId": "27ba9513-6b1d-4367-b210-500c5f84c2ed"
            },
            "7b549fc6-eb6e-4379-aaf1-5c0bd1a7477e": {
              "id": "7b549fc6-eb6e-4379-aaf1-5c0bd1a7477e",
              "name": "",
              "description": "",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116",
              "fromNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116",
              "toNodeId": "76aed74b-5429-4f97-a711-f91a9d7d9121"
            },
            "85219257-cfe2-4b6c-962e-43a23d926550": {
              "id": "85219257-cfe2-4b6c-962e-43a23d926550",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116",
              "toNodeId": ""
            },
            "86d085f5-5c69-4b18-93eb-ebe47db97a1c": {
              "id": "86d085f5-5c69-4b18-93eb-ebe47db97a1c",
              "name": "Low Risk",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "b898abb0-4e47-44f6-87ce-e418e454d43a",
              "toNodeId": ""
            },
            "888b04e3-8de7-4af8-b296-2b3a7298ca83": {
              "id": "888b04e3-8de7-4af8-b296-2b3a7298ca83",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "1f850c57-7b9b-47f3-884d-f91812370e72",
              "toNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116"
            },
            "8d089ada-f1b1-4ac0-800b-cecb3e01a355": {
              "id": "8d089ada-f1b1-4ac0-800b-cecb3e01a355",
              "name": "True",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "9577c0ce-2371-4327-9178-1a4cf1432864",
              "toNodeId": "161de748-8070-44ac-851e-12cfc84e03e1"
            },
            "8dd44d47-6e75-4ca7-b359-6e079e16e9bc": {
              "id": "8dd44d47-6e75-4ca7-b359-6e079e16e9bc",
              "name": "",
              "description": "",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116",
              "fromNodeId": "311ca1c6-6ee5-4a28-a53d-ecf86322d89a",
              "toNodeId": "f95d0442-4cc2-4f42-94e9-a47ca89ad612"
            },
            "935cdcf6-fcd2-459a-879f-c2c101aac57a": {
              "id": "935cdcf6-fcd2-459a-879f-c2c101aac57a",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "toNodeId": "7d512657-e6cf-4a55-9b37-5bae2a359173"
            },
            "97cd8006-6266-4f47-9ab7-076f9b3b2342": {
              "id": "97cd8006-6266-4f47-9ab7-076f9b3b2342",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "3c832c1a-3d96-47ca-b150-a4a38e144954",
              "toNodeId": "b898abb0-4e47-44f6-87ce-e418e454d43a"
            },
            "98ce3d9d-88c3-4e98-b867-fb3c82e27b20": {
              "id": "98ce3d9d-88c3-4e98-b867-fb3c82e27b20",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "53c4a519-faf5-4727-a6bd-c3d6042036a0",
              "toNodeId": "791a66c7-b41b-400c-b9aa-2fb95c58343b"
            },
            "9b0bf422-bf09-4607-ab09-4c1042c20423": {
              "id": "9b0bf422-bf09-4607-ab09-4c1042c20423",
              "name": "Exclude",
              "description": "",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116",
              "fromNodeId": "f95d0442-4cc2-4f42-94e9-a47ca89ad612",
              "toNodeId": ""
            },
            "a02155d8-5691-4d7a-a15c-8e963f520d5c": {
              "id": "a02155d8-5691-4d7a-a15c-8e963f520d5c",
              "name": "Low risk",
              "description": "Domain reputation scale is low risk.",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "791a66c7-b41b-400c-b9aa-2fb95c58343b",
              "toNodeId": "3789bc21-24b3-41d2-8dc2-9a3772420e34"
            },
            "b35c53b4-6d87-4412-b515-c4ec20cb4141": {
              "id": "b35c53b4-6d87-4412-b515-c4ec20cb4141",
              "name": "High risk",
              "description": "Domain reputation is malicious.",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "791a66c7-b41b-400c-b9aa-2fb95c58343b",
              "toNodeId": "3789bc21-24b3-41d2-8dc2-9a3772420e34"
            },
            "b46c3de8-4da0-494d-a2a4-289e93a6150b": {
              "id": "b46c3de8-4da0-494d-a2a4-289e93a6150b",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b",
              "toNodeId": "9b96ee9f-6d05-4f12-ac88-a30e3d1cd713"
            },
            "b7b3f82b-e554-43a4-be45-2fd9ddd4a40e": {
              "id": "b7b3f82b-e554-43a4-be45-2fd9ddd4a40e",
              "name": "No Risk",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "b898abb0-4e47-44f6-87ce-e418e454d43a",
              "toNodeId": ""
            },
            "bf56c31b-d9cc-46ad-a3a2-e12b4632c8c3": {
              "id": "bf56c31b-d9cc-46ad-a3a2-e12b4632c8c3",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "52d62575-8570-4769-9806-125f2c32e599",
              "toNodeId": "53c4a519-faf5-4727-a6bd-c3d6042036a0"
            },
            "c3790b7b-9866-49ec-b282-24fce52462ae": {
              "id": "c3790b7b-9866-49ec-b282-24fce52462ae",
              "name": "False",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "5ecaea1a-4fc4-4f8e-8ea1-79615d162252",
              "toNodeId": "3c832c1a-3d96-47ca-b150-a4a38e144954"
            },
            "c4c1d3eb-f1d8-4ac9-9f24-e46c0a23ff56": {
              "id": "c4c1d3eb-f1d8-4ac9-9f24-e46c0a23ff56",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "toNodeId": ""
            },
            "cc1b47f4-ffed-4862-90e0-49e7c1b0e18e": {
              "id": "cc1b47f4-ffed-4862-90e0-49e7c1b0e18e",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "6d636a24-d039-4beb-bd17-b455819577ed",
              "toNodeId": "5ecaea1a-4fc4-4f8e-8ea1-79615d162252"
            },
            "f5f9a505-75b8-468e-a265-e70dab53f0c4": {
              "id": "f5f9a505-75b8-468e-a265-e70dab53f0c4",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "161de748-8070-44ac-851e-12cfc84e03e1",
              "toNodeId": "6d636a24-d039-4beb-bd17-b455819577ed"
            }
          },
          "nodes": {
            "161de748-8070-44ac-851e-12cfc84e03e1": {
              "id": "161de748-8070-44ac-851e-12cfc84e03e1",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "1f850c57-7b9b-47f3-884d-f91812370e72": {
              "id": "1f850c57-7b9b-47f3-884d-f91812370e72",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "27ba9513-6b1d-4367-b210-500c5f84c2ed": {
              "id": "27ba9513-6b1d-4367-b210-500c5f84c2ed",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "311ca1c6-6ee5-4a28-a53d-ecf86322d89a": {
              "id": "311ca1c6-6ee5-4a28-a53d-ecf86322d89a",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116"
            },
            "3789bc21-24b3-41d2-8dc2-9a3772420e34": {
              "id": "3789bc21-24b3-41d2-8dc2-9a3772420e34",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "3c832c1a-3d96-47ca-b150-a4a38e144954": {
              "id": "3c832c1a-3d96-47ca-b150-a4a38e144954",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "48b34d41-dce5-43c2-9e37-6a18690c97b7": {
              "id": "48b34d41-dce5-43c2-9e37-6a18690c97b7",
              "parentNodeId": ""
            },
            "49e3de65-d93f-4158-bf6d-7941d274d116": {
              "id": "49e3de65-d93f-4158-bf6d-7941d274d116",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "52d62575-8570-4769-9806-125f2c32e599": {
              "id": "52d62575-8570-4769-9806-125f2c32e599",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "53c4a519-faf5-4727-a6bd-c3d6042036a0": {
              "id": "53c4a519-faf5-4727-a6bd-c3d6042036a0",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "58ad50ac-2664-4b28-95b0-344d6e9121e5": {
              "id": "58ad50ac-2664-4b28-95b0-344d6e9121e5",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116"
            },
            "5c15196b-5cb4-42d0-b36b-0d2ac56c609b": {
              "id": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "5c9d2ecb-8c91-48fa-a770-f9886339013d": {
              "id": "5c9d2ecb-8c91-48fa-a770-f9886339013d",
              "parentNodeId": ""
            },
            "5ecaea1a-4fc4-4f8e-8ea1-79615d162252": {
              "id": "5ecaea1a-4fc4-4f8e-8ea1-79615d162252",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "67913af3-e3b4-42a0-8a69-ef8ced2c2515": {
              "id": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "6d636a24-d039-4beb-bd17-b455819577ed": {
              "id": "6d636a24-d039-4beb-bd17-b455819577ed",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "76aed74b-5429-4f97-a711-f91a9d7d9121": {
              "id": "76aed74b-5429-4f97-a711-f91a9d7d9121",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116"
            },
            "791a66c7-b41b-400c-b9aa-2fb95c58343b": {
              "id": "791a66c7-b41b-400c-b9aa-2fb95c58343b",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "7d512657-e6cf-4a55-9b37-5bae2a359173": {
              "id": "7d512657-e6cf-4a55-9b37-5bae2a359173",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "9577c0ce-2371-4327-9178-1a4cf1432864": {
              "id": "9577c0ce-2371-4327-9178-1a4cf1432864",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "9b96ee9f-6d05-4f12-ac88-a30e3d1cd713": {
              "id": "9b96ee9f-6d05-4f12-ac88-a30e3d1cd713",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "a1ca6931-8535-4185-ac8e-bdc950c2813e": {
              "id": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "parentNodeId": ""
            },
            "b898abb0-4e47-44f6-87ce-e418e454d43a": {
              "id": "b898abb0-4e47-44f6-87ce-e418e454d43a",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "d3b75341-0a96-4366-934d-ee5a48fc195c": {
              "id": "d3b75341-0a96-4366-934d-ee5a48fc195c",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116"
            },
            "ec5e4ea6-f193-487f-90dd-c1eceb7076c5": {
              "id": "ec5e4ea6-f193-487f-90dd-c1eceb7076c5",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec": {
              "id": "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "f95d0442-4cc2-4f42-94e9-a47ca89ad612": {
              "id": "f95d0442-4cc2-4f42-94e9-a47ca89ad612",
              "parentNodeId": "49e3de65-d93f-4158-bf6d-7941d274d116"
            }
          }
        },
        "steps": {
          "161de748-8070-44ac-851e-12cfc84e03e1": {
            "nodeId": "161de748-8070-44ac-851e-12cfc84e03e1",
            "name": "Get Current Date Time",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "3.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/3.0.0/icon.png"
            },
            "identifier": "get_datetime",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "format_string": "%d %b %Y %H:%M:%S",
                "use_rfc3339_format": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "format_string": {
                  "default": "%d %b %Y %H:%M:%S",
                  "description": "Format string for the output",
                  "order": 1,
                  "title": "Format String",
                  "type": "string"
                },
                "use_rfc3339_format": {
                  "description": "Use RFC3339 format (eg. 2017-10-24T18:27:36.23Z). This is the most compatible date format for timestamp manipulation. Enabling this will override the format string input",
                  "order": 2,
                  "title": "Use RFC3339 Format",
                  "type": "boolean"
                }
              },
              "required": [
                "format_string",
                "use_rfc3339_format"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "datetime": {
                  "description": "Datetime",
                  "order": 1,
                  "title": "Datetime",
                  "type": "string"
                },
                "epoch_timestamp": {
                  "description": "Epoch timestamp",
                  "order": 2,
                  "title": "Epoch Timestamp",
                  "type": "integer"
                }
              },
              "required": [
                "datetime",
                "epoch_timestamp"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "1f850c57-7b9b-47f3-884d-f91812370e72": {
            "nodeId": "1f850c57-7b9b-47f3-884d-f91812370e72",
            "name": "Uniq Extract Header URLs",
            "type": "action",
            "plugin": {
              "name": "Uniq",
              "slugVendor": "rapid7",
              "slugName": "uniq",
              "slugVersion": "1.0.2",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/uniq/1.0.2/icon.png"
            },
            "identifier": "uniq_string_array",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "data": "{{[7d512657-e6cf-4a55-9b37-5bae2a359173].[urls]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "data": {
                  "description": "Array of strings",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Data",
                  "type": "array"
                }
              },
              "required": [
                "data"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "duplicate_count": {
                  "description": "Count of duplicates removed",
                  "order": 2,
                  "title": "Duplicate count",
                  "type": "integer"
                },
                "element_count": {
                  "description": "Count of each element",
                  "order": 3,
                  "title": "Element count",
                  "type": "object"
                },
                "result": {
                  "description": "Result without duplicates",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Result",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "27ba9513-6b1d-4367-b210-500c5f84c2ed": {
            "nodeId": "27ba9513-6b1d-4367-b210-500c5f84c2ed",
            "name": "Uniq Header Domains",
            "type": "action",
            "plugin": {
              "name": "Uniq",
              "slugVendor": "rapid7",
              "slugName": "uniq",
              "slugVersion": "1.0.2",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/uniq/1.0.2/icon.png"
            },
            "identifier": "uniq_string_array",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "data": "{{[f07a4ce8-ec8e-4b15-ba46-43358e8b19ec].[domains]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "data": {
                  "description": "Array of strings",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Data",
                  "type": "array"
                }
              },
              "required": [
                "data"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "duplicate_count": {
                  "description": "Count of duplicates removed",
                  "order": 2,
                  "title": "Duplicate count",
                  "type": "integer"
                },
                "element_count": {
                  "description": "Count of each element",
                  "order": 3,
                  "title": "Element count",
                  "type": "object"
                },
                "result": {
                  "description": "Result without duplicates",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Result",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "311ca1c6-6ee5-4a28-a53d-ecf86322d89a": {
            "nodeId": "311ca1c6-6ee5-4a28-a53d-ecf86322d89a",
            "name": "URL Exclusion Lookup",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "value"
                },
                "op": "=",
                "right": {
                  "name": "76aed74b-5429-4f97-a711-f91a9d7d9121.result",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'value' = {{[76aed74b-5429-4f97-a711-f91a9d7d9121].[result]}}",
              "ignoreCase": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts",
            "globalArtifact": {
              "name": "Allowed URLs",
              "id": "b55fab5c-8354-4cc4-b864-a48b6dcab352",
              "schema": {
                "definitions": {},
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              }
            },
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "3789bc21-24b3-41d2-8dc2-9a3772420e34": {
            "nodeId": "3789bc21-24b3-41d2-8dc2-9a3772420e34",
            "name": "VirusTotal Domain Scaler Output",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "a02155d8-5691-4d7a-a15c-8e963f520d5c",
                "b35c53b4-6d87-4412-b515-c4ec20cb4141",
                "4b865c1c-b595-4021-8aae-2bd156c0f91c"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "VirusTotal Domain Repuation",
                  "type": "string",
                  "variables": {
                    "4b865c1c-b595-4021-8aae-2bd156c0f91c": "No risk",
                    "a02155d8-5691-4d7a-a15c-8e963f520d5c": "Low risk",
                    "b35c53b4-6d87-4412-b515-c4ec20cb4141": "High risk"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "VirusTotal Domain Repuation": {
                  "description": "Emitted variable \"VirusTotal Domain Repuation\"",
                  "order": 1,
                  "title": "VirusTotal Domain Repuation",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "VirusTotal Domain Repuation": {
                  "description": "Emitted variable \"VirusTotal Domain Repuation\"",
                  "order": 1,
                  "title": "VirusTotal Domain Repuation",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "3c832c1a-3d96-47ca-b150-a4a38e144954": {
            "nodeId": "3c832c1a-3d96-47ca-b150-a4a38e144954",
            "name": "WHOIS Reputation Output",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "48af1ac3-319a-49e1-a46d-d08983c1ca50",
                "27ac3bca-5fe2-479f-91a5-3bd7d1113718",
                "c3790b7b-9866-49ec-b282-24fce52462ae"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "WHOIS Reputation",
                  "type": "string",
                  "variables": {
                    "27ac3bca-5fe2-479f-91a5-3bd7d1113718": "No Risk",
                    "48af1ac3-319a-49e1-a46d-d08983c1ca50": "Invalid",
                    "c3790b7b-9866-49ec-b282-24fce52462ae": "High Risk"
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "Domain Age",
                  "type": "string",
                  "variables": {
                    "27ac3bca-5fe2-479f-91a5-3bd7d1113718": "{{[6d636a24-d039-4beb-bd17-b455819577ed].[difference]}} days",
                    "48af1ac3-319a-49e1-a46d-d08983c1ca50": "Invalid",
                    "c3790b7b-9866-49ec-b282-24fce52462ae": "{{[6d636a24-d039-4beb-bd17-b455819577ed].[difference]}} days"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "Domain Age": {
                  "description": "Emitted variable \"Domain Age\"",
                  "order": 2,
                  "title": "Domain Age",
                  "type": "string"
                },
                "WHOIS Reputation": {
                  "description": "Emitted variable \"WHOIS Reputation\"",
                  "order": 1,
                  "title": "WHOIS Reputation",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "Domain Age": {
                  "description": "Emitted variable \"Domain Age\"",
                  "order": 2,
                  "title": "Domain Age",
                  "type": "string"
                },
                "WHOIS Reputation": {
                  "description": "Emitted variable \"WHOIS Reputation\"",
                  "order": 1,
                  "title": "WHOIS Reputation",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "48b34d41-dce5-43c2-9e37-6a18690c97b7": {
            "nodeId": "48b34d41-dce5-43c2-9e37-6a18690c97b7",
            "name": "New Email Received",
            "description": "Triggers when a new email is received in the inbox.",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "6.0.4",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/6.0.4/icon.png"
            },
            "identifier": "email_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "flatten_attachments": false,
                "folder_name": "Inbox",
                "interval": 15,
                "mailbox_id": "{{[$workflow].[Mailbox]}}",
                "subject_query": " "
              }
            },
            "triggerId": "0ed543a0-01ae-46f8-ab2d-e6e1213c18b8",
            "defaultInputJSONSchema": {
              "properties": {
                "flatten_attachments": {
                  "default": false,
                  "description": "Will return all attachments as flat lists instead of nested emails",
                  "order": 5,
                  "title": "Flatten Attachments",
                  "type": "boolean"
                },
                "folder_name": {
                  "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive. Folder GUID may be specified as well",
                  "order": 2,
                  "title": "Folder Name",
                  "type": "string"
                },
                "interval": {
                  "default": 15,
                  "description": "How often to poll for new email in seconds",
                  "order": 3,
                  "title": "Interval",
                  "type": "integer"
                },
                "mailbox_id": {
                  "description": "The mailbox to monitor for incoming email",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                },
                "subject_query": {
                  "default": " ",
                  "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
                  "order": 4,
                  "title": "Subject Query",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "flatten_attachments"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "attachment_email": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email",
                  "type": "object"
                },
                "attachment_email_nested": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested_two"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested",
                  "type": "object"
                },
                "attachment_email_nested_two": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "type": "object"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested Two",
                  "type": "object"
                },
                "attachment_file": {
                  "properties": {
                    "content": {
                      "order": 2,
                      "title": "Content",
                      "type": "string"
                    },
                    "content_type": {
                      "order": 3,
                      "title": "Content Type",
                      "type": "string"
                    },
                    "indicators": {
                      "$ref": "#/definitions/indicators",
                      "description": "Indicators",
                      "order": 4,
                      "title": "Indicators"
                    },
                    "name": {
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "Attachment File",
                  "type": "object"
                },
                "header": {
                  "properties": {
                    "name": {
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Header",
                  "type": "object"
                },
                "icon_email": {
                  "properties": {
                    "account": {
                      "description": "Account for which the email was found on",
                      "order": 2,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 6,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 11,
                      "title": "Categories",
                      "type": "array"
                    },
                    "flattened_attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 9,
                      "title": "Flattened Attached Emails",
                      "type": "array"
                    },
                    "flattened_attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 10,
                      "title": "Flattened Attached Files",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 14,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 12,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "is_read": {
                      "description": "Whether or not the email has been read",
                      "order": 3,
                      "title": "Is Read",
                      "type": "boolean"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 4,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 5,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Icon Email",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "md5": {
                      "description": "MD5 hash",
                      "order": 1,
                      "title": "MD5",
                      "type": "string"
                    },
                    "sha1": {
                      "description": "SHA1 hash",
                      "order": 2,
                      "title": "SHA1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256 hash",
                      "order": 3,
                      "title": "SHA256",
                      "type": "string"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                }
              },
              "properties": {
                "icon_email": {
                  "$ref": "#/definitions/icon_email",
                  "description": "Email",
                  "order": 1,
                  "title": "Email"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "49e3de65-d93f-4158-bf6d-7941d274d116": {
            "nodeId": "49e3de65-d93f-4158-bf6d-7941d274d116",
            "name": "Header URLs Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "7b549fc6-eb6e-4379-aaf1-5c0bd1a7477e",
              "nextEdgeId": "85219257-cfe2-4b6c-962e-43a23d926550",
              "repeatVariable": "{{[1f850c57-7b9b-47f3-884d-f91812370e72].[result]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "52d62575-8570-4769-9806-125f2c32e599": {
            "nodeId": "52d62575-8570-4769-9806-125f2c32e599",
            "name": "WHOIS Domain Lookup",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.1.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.1.0/icon.png"
            },
            "identifier": "domain",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name to lookup",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "required": [
                "domain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "creation_date": {
                  "description": "Creation date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 5,
                  "title": "Creation Date",
                  "type": "string"
                },
                "dnssec": {
                  "description": "DNSSEC",
                  "order": 16,
                  "title": "DNSSEC",
                  "type": "string"
                },
                "domain_status": {
                  "description": "Domain status",
                  "items": {
                    "type": "string"
                  },
                  "order": 15,
                  "title": "Domain Status",
                  "type": "array"
                },
                "expiration_date": {
                  "description": "Expiration date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 6,
                  "title": "Expiration Date",
                  "type": "string"
                },
                "last_updated": {
                  "description": "Last updated date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 7,
                  "title": "Last Updated Date",
                  "type": "string"
                },
                "name": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain Name",
                  "type": "string"
                },
                "name_servers": {
                  "description": "Nameservers",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "Nameservers",
                  "type": "array"
                },
                "registrant_cc": {
                  "description": "Registrant country",
                  "order": 4,
                  "title": "Registrant Country",
                  "type": "string"
                },
                "registrant_name": {
                  "description": "Registrant name",
                  "order": 3,
                  "title": "Registrant Name",
                  "type": "string"
                },
                "registrar": {
                  "description": "Domain registrar",
                  "order": 2,
                  "title": "Domain Registrar",
                  "type": "string"
                },
                "registrar_abuse_contact_email": {
                  "description": "Registrar abuse contact email",
                  "order": 13,
                  "title": "Registrar Abuse Contact Email",
                  "type": "string"
                },
                "registrar_abuse_contact_phone": {
                  "description": "Registrar abuse Contact phone",
                  "order": 14,
                  "title": "Registrar Abuse Contact Phone",
                  "type": "string"
                },
                "registrar_iana_id": {
                  "description": "Registrar IANA ID",
                  "order": 12,
                  "title": "Registrar IANA ID",
                  "type": "string"
                },
                "registrar_url": {
                  "description": "Registrar URL",
                  "order": 11,
                  "title": "Registrar URL",
                  "type": "string"
                },
                "registrar_whois_server": {
                  "description": "Registrar WHOIS server",
                  "order": 10,
                  "title": "Registrar WHOIS Server",
                  "type": "string"
                },
                "registry_domain_id": {
                  "description": "Registry domain ID",
                  "order": 9,
                  "title": "Registry Domain ID",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "53c4a519-faf5-4727-a6bd-c3d6042036a0": {
            "nodeId": "53c4a519-faf5-4727-a6bd-c3d6042036a0",
            "name": "VirusTotal Domain Lookup",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "10.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/10.0.0/icon.png"
            },
            "identifier": "domain_report",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "authority_key_identifier": {
                  "properties": {
                    "keyid": {
                      "description": "Key hexdump",
                      "order": 1,
                      "title": "Key ID",
                      "type": "string"
                    },
                    "serial_number": {
                      "description": "Serial number hexdump",
                      "order": 2,
                      "title": "Serial Number",
                      "type": "string"
                    }
                  },
                  "title": "Authority Key Identifier",
                  "type": "object"
                },
                "cert_signature": {
                  "properties": {
                    "signature": {
                      "description": "Signature hexdump",
                      "order": 1,
                      "title": "Signature",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Used algorithm",
                      "order": 2,
                      "title": "Signature Algorithm",
                      "type": "string"
                    }
                  },
                  "title": "Cert Signature",
                  "type": "object"
                },
                "domain_report": {
                  "properties": {
                    "categories": {
                      "description": "Mapping that relates categorization services with the assigned domain category. These services are, among others: Alexa, BitDefender, TrendMicro, Websense ThreatSeeker, etc.",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "creation_date": {
                      "description": "Creation date extracted from the Domain's WHOIS (UTC timestamp)",
                      "order": 2,
                      "title": "Creation Date",
                      "type": "integer"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the domain's favicon",
                      "order": 3,
                      "title": "Favicon"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 4,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 5,
                      "title": "Last Analysis Statistics"
                    },
                    "last_dns_records": {
                      "description": "Domain's DNS records on its last scan",
                      "items": {
                        "$ref": "#/definitions/last_dns_records"
                      },
                      "order": 6,
                      "title": "Last DNS Records",
                      "type": "array"
                    },
                    "last_dns_records_date": {
                      "description": "Date when the DNS records list was retrieved by VirusTotal (UTC timestamp)",
                      "order": 7,
                      "title": "Last DNS Records Date",
                      "type": "integer"
                    },
                    "last_https_certificate": {
                      "$ref": "#/definitions/ssl_certificate",
                      "description": "SSL certificate object retrieved last time the domain was analyzed",
                      "order": 8,
                      "title": "Last HTTPS Certificate"
                    },
                    "last_https_certificate_date": {
                      "description": "Date when the certificate was retrieved by VirusTotal (UTC timestamp)",
                      "order": 9,
                      "title": "Last HTTPS Certificate Date",
                      "type": "integer"
                    },
                    "last_modification_date": {
                      "description": "Date when any of the domain's information was last updated",
                      "order": 10,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_update_date": {
                      "description": "Updated date extracted from WHOIS (UTC timestamp)",
                      "order": 11,
                      "title": "Last Update Date",
                      "type": "integer"
                    },
                    "popularity_ranks": {
                      "$ref": "#/definitions/popularity_ranks",
                      "description": "Domain's position in popularity ranks such as Alexa, Quantcast, Statvoo, etc.",
                      "order": 12,
                      "title": "Popularity Ranks"
                    },
                    "registrar": {
                      "description": "Company that registered the domain",
                      "order": 13,
                      "title": "Registrar",
                      "type": "string"
                    },
                    "reputation": {
                      "description": "Domain's score calculated from the votes of the VirusTotal's community",
                      "order": 14,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 15,
                      "title": "Tags",
                      "type": "array"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided in harmless and malicious",
                      "order": 16,
                      "title": "Total Votes"
                    },
                    "whois": {
                      "description": "WHOIS information as returned from the pertinent WHOIS server",
                      "order": 17,
                      "title": "WHOIS",
                      "type": "string"
                    },
                    "whois_date": {
                      "description": "Date of the last update of the WHOIS record in VirusTotal",
                      "order": 18,
                      "title": "WHOIS Date",
                      "type": "integer"
                    }
                  },
                  "title": "Domain Report",
                  "type": "object"
                },
                "dsa": {
                  "properties": {
                    "g": {
                      "description": "G component hexdump",
                      "order": 3,
                      "title": "G",
                      "type": "string"
                    },
                    "p": {
                      "description": "P component hexdump",
                      "order": 1,
                      "title": "P",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 4,
                      "title": "Public",
                      "type": "string"
                    },
                    "q": {
                      "description": "Q component hexdump",
                      "order": 2,
                      "title": "Q",
                      "type": "string"
                    }
                  },
                  "title": "Dsa",
                  "type": "object"
                },
                "ec": {
                  "properties": {
                    "oid": {
                      "description": "Curve name",
                      "order": 1,
                      "title": "OID",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 2,
                      "title": "Public",
                      "type": "string"
                    }
                  },
                  "title": "Ec",
                  "type": "object"
                },
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "last_dns_records": {
                  "properties": {
                    "expire": {
                      "description": "Expire",
                      "order": 1,
                      "title": "Expire",
                      "type": "integer"
                    },
                    "flag": {
                      "description": "Flag",
                      "order": 2,
                      "title": "Flag",
                      "type": "integer"
                    },
                    "minimum": {
                      "description": "Minimum",
                      "order": 3,
                      "title": "Minimum",
                      "type": "integer"
                    },
                    "priority": {
                      "description": "Priority",
                      "order": 4,
                      "title": "Priority",
                      "type": "integer"
                    },
                    "refresh": {
                      "description": "Refresh",
                      "order": 5,
                      "title": "Refresh",
                      "type": "integer"
                    },
                    "retry": {
                      "description": "Retry",
                      "order": 7,
                      "title": "Retry",
                      "type": "integer"
                    },
                    "rname": {
                      "description": "RNAME",
                      "order": 6,
                      "title": "RNAME",
                      "type": "string"
                    },
                    "serial": {
                      "description": "Serial",
                      "order": 8,
                      "title": "Serial",
                      "type": "integer"
                    },
                    "tag": {
                      "description": "Tag",
                      "order": 9,
                      "title": "Tag",
                      "type": "string"
                    },
                    "ttl": {
                      "description": "Time to live",
                      "order": 10,
                      "title": "TTL",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type",
                      "order": 11,
                      "title": "Type",
                      "type": "string"
                    },
                    "value": {
                      "description": "Value",
                      "order": 12,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Last Dns Records",
                  "type": "object"
                },
                "popularity_ranks": {
                  "properties": {
                    "rank": {
                      "description": "Rank position",
                      "order": 1,
                      "title": "Rank",
                      "type": "integer"
                    },
                    "timestamp": {
                      "description": "UTC timestamp when the rank was ingested",
                      "order": 2,
                      "title": "Timestamp",
                      "type": "integer"
                    }
                  },
                  "title": "Popularity Ranks",
                  "type": "object"
                },
                "public_key": {
                  "properties": {
                    "algorithm": {
                      "description": "Indicates the algorithm used to generate the certificate",
                      "order": 1,
                      "title": "Algorithm",
                      "type": "string"
                    },
                    "dsa": {
                      "$ref": "#/definitions/dsa",
                      "description": "DSA public key information",
                      "order": 3,
                      "title": "DSA"
                    },
                    "ec": {
                      "$ref": "#/definitions/ec",
                      "description": "EC public key information",
                      "order": 4,
                      "title": "EC"
                    },
                    "rsa": {
                      "$ref": "#/definitions/rsa",
                      "description": "RSA public key information",
                      "order": 2,
                      "title": "RSA"
                    }
                  },
                  "title": "Public Key",
                  "type": "object"
                },
                "rsa": {
                  "properties": {
                    "exponent": {
                      "description": "Key exponent hexdump",
                      "order": 3,
                      "title": "Exponent",
                      "type": "string"
                    },
                    "key_size": {
                      "description": "Key size",
                      "order": 1,
                      "title": "Key Size",
                      "type": "integer"
                    },
                    "modulus": {
                      "description": "Key modulus hexdump",
                      "order": 2,
                      "title": "Modulus",
                      "type": "string"
                    }
                  },
                  "title": "Rsa",
                  "type": "object"
                },
                "ssl_certificate": {
                  "properties": {
                    "cert_signature": {
                      "$ref": "#/definitions/cert_signature",
                      "description": "Dictionary containing certificate's signature and algorithm",
                      "order": 1,
                      "title": "Certificate Signature"
                    },
                    "extensions": {
                      "$ref": "#/definitions/ssl_extensions",
                      "description": "Dictionary containing all certificate's extensions",
                      "order": 2,
                      "title": "Extensions"
                    },
                    "first_seen_date": {
                      "description": "Date the certificate was first retrieved by VirusTotal",
                      "order": 3,
                      "title": "First Seen Date",
                      "type": "integer"
                    },
                    "issuer": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's issuer data",
                      "order": 4,
                      "title": "Issuer"
                    },
                    "public_key": {
                      "$ref": "#/definitions/public_key",
                      "description": "Subject public key info",
                      "order": 5,
                      "title": "Public Key"
                    },
                    "serial_number": {
                      "description": "Certificate's serial number hexdump",
                      "order": 6,
                      "title": "Serial Number",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Algorithm used for the signature",
                      "order": 7,
                      "title": "Signature Algorithm",
                      "type": "string"
                    },
                    "size": {
                      "description": "Certificate content length",
                      "order": 8,
                      "title": "Size",
                      "type": "integer"
                    },
                    "subject": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's subject data",
                      "order": 9,
                      "title": "Subject"
                    },
                    "thumbprint": {
                      "description": "Certificate's content SHA1 hash",
                      "order": 10,
                      "title": "Thumbprint",
                      "type": "string"
                    },
                    "thumbprint_sha256": {
                      "description": "Certificate's content SHA256 hash",
                      "order": 11,
                      "title": "Thumbprint SHA256",
                      "type": "string"
                    },
                    "validity": {
                      "$ref": "#/definitions/validity",
                      "description": "Defines certificate's validity period",
                      "order": 12,
                      "title": "Validity"
                    },
                    "version": {
                      "description": "Certificate version",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Certificate",
                  "type": "object"
                },
                "ssl_data": {
                  "properties": {
                    "C": {
                      "description": "Country name",
                      "order": 1,
                      "title": "Country Name",
                      "type": "string"
                    },
                    "CN": {
                      "description": "Common name",
                      "order": 2,
                      "title": "Common Name",
                      "type": "string"
                    },
                    "L": {
                      "description": "Locality",
                      "order": 3,
                      "title": "Locality",
                      "type": "string"
                    },
                    "O": {
                      "description": "Organization",
                      "order": 4,
                      "title": "Organization",
                      "type": "string"
                    },
                    "OU": {
                      "description": "Organizational unit",
                      "order": 5,
                      "title": "Organizational Unit",
                      "type": "string"
                    },
                    "ST": {
                      "description": "State or province name",
                      "order": 6,
                      "title": "State or Province Name",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Data",
                  "type": "object"
                },
                "ssl_extensions": {
                  "properties": {
                    "authority_key_identifier": {
                      "$ref": "#/definitions/authority_key_identifier",
                      "description": "Identifies the public key to be used to verify the signature on this certificate or CRL",
                      "order": 3,
                      "title": "Authority Key Identifier"
                    },
                    "ca": {
                      "description": "Whether the subject acts as a CA or not",
                      "order": 1,
                      "title": "CA",
                      "type": "boolean"
                    },
                    "ca_information_access": {
                      "description": "Authority information access locations are URLs that are added to a certificate in its authority information access extension",
                      "order": 5,
                      "title": "CA Information Access",
                      "type": "object"
                    },
                    "cert_template_name_dc": {
                      "description": "BMP data value DomainController, see MS Q291010",
                      "order": 10,
                      "title": "Certificate Template Name DC",
                      "type": "string"
                    },
                    "certificate_policies": {
                      "description": "Different certificate policies will relate to different applications which may use the certified key",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "Certificate Policies",
                      "type": "array"
                    },
                    "crl_distribution_points": {
                      "description": "Identifies the CRL distribution points to which a certificate user should refer to ascertain if the certificate has been revoked",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "CRL Distribution Points",
                      "type": "array"
                    },
                    "key_usage": {
                      "description": "Indicates the purpose for which the certified public key is used",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Key Usage",
                      "type": "array"
                    },
                    "netscape_cert_comment": {
                      "description": "Used to include free-form text comments inside certificates",
                      "order": 9,
                      "title": "Netscape Certificate Comment",
                      "type": "string"
                    },
                    "netscape_certificate": {
                      "description": "Identify whether the certificate subject is an SSL client, an SSL server, or a CA",
                      "order": 11,
                      "title": "Netscape Certificate",
                      "type": "boolean"
                    },
                    "old_authority_key_identifier": {
                      "description": "Whether the certificate has an old authority key identifier extension",
                      "order": 13,
                      "title": "Old Authority Key Identifier",
                      "type": "boolean"
                    },
                    "pe_logotype": {
                      "description": "Whether the certificate includes a logotype",
                      "order": 12,
                      "title": "PE Logotype",
                      "type": "boolean"
                    },
                    "subject_alternative_name": {
                      "description": "Contains one or more alternative names, using any of a variety of name forms, for the entity that is bound by the CA to the certified public key",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "Subject Alternative Name",
                      "type": "array"
                    },
                    "subject_key_identifier": {
                      "description": "Identifies the public key being certified",
                      "order": 2,
                      "title": "Subject Key Identifier",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Extensions",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "validity": {
                  "properties": {
                    "not_after": {
                      "description": "Expiry date in %Y-%m-%d %H:%M:%S format",
                      "order": 1,
                      "title": "Not After",
                      "type": "string"
                    },
                    "not_before": {
                      "description": "Issue date in %Y-%m-%d %H:%M:%S format",
                      "order": 2,
                      "title": "Not Before",
                      "type": "string"
                    }
                  },
                  "title": "Validity",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/domain_report",
                  "description": "Domain report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "58ad50ac-2664-4b28-95b0-344d6e9121e5": {
            "nodeId": "58ad50ac-2664-4b28-95b0-344d6e9121e5",
            "name": "VirusTotal Scan URL Report",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "10.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/10.0.0/icon.png"
            },
            "identifier": "scan_url_report",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[76aed74b-5429-4f97-a711-f91a9d7d9121].[result]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL scanned",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "url_report": {
                  "properties": {
                    "categories": {
                      "description": "Object, with the key as the partner who categorized the URL and the value as the URL's category according to that partner",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the URL's favicon",
                      "order": 2,
                      "title": "Favicon"
                    },
                    "first_submission_date": {
                      "description": "UTC timestamp of the date when the URL was first submitted to VirusTotal",
                      "order": 3,
                      "title": "First Submission Date",
                      "type": "integer"
                    },
                    "html_meta": {
                      "description": "Contains all meta tags (only for URLs downloading a HTML). Keys are meta tag names and values are lists containing all values of that meta tag",
                      "order": 4,
                      "title": "HTML Meta",
                      "type": "object"
                    },
                    "last_analysis_date": {
                      "description": "UTC timestamp representing last time the URL was scanned",
                      "order": 5,
                      "title": "Last Analysis Date",
                      "type": "integer"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 6,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 7,
                      "title": "Last Analysis Stats"
                    },
                    "last_final_url": {
                      "description": "Final URL in URL redirections",
                      "order": 8,
                      "title": "Last Final URL",
                      "type": "string"
                    },
                    "last_http_response_code": {
                      "description": "HTTP response code of the last response",
                      "order": 9,
                      "title": "Last HTTP Response Code",
                      "type": "integer"
                    },
                    "last_http_response_content_length": {
                      "description": "Length in bytes of the content received",
                      "order": 10,
                      "title": "Last HTTP Response Content Length",
                      "type": "integer"
                    },
                    "last_http_response_content_sha256": {
                      "description": "URL response body's SHA256 hash",
                      "order": 11,
                      "title": "Last HTTP Response Content SHA256",
                      "type": "string"
                    },
                    "last_http_response_cookies": {
                      "description": "Dictionary containing the website's cookies",
                      "order": 12,
                      "title": "Last HTTP Response Cookies",
                      "type": "object"
                    },
                    "last_http_response_headers": {
                      "description": "Dictionary containing headers and values of last HTTP response",
                      "order": 13,
                      "title": "Last HTTP Response Headers",
                      "type": "object"
                    },
                    "last_modification_date": {
                      "description": "UTC timestamp representing last modification date",
                      "order": 14,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_submission_date": {
                      "description": "UTC timestamp representing last time it was sent to be analyzed",
                      "order": 15,
                      "title": "Last Submission Date",
                      "type": "integer"
                    },
                    "outgoing_links": {
                      "description": "List of links to outgoing domains",
                      "items": {
                        "type": "string"
                      },
                      "order": 16,
                      "title": "Outgoing Links",
                      "type": "array"
                    },
                    "reputation": {
                      "description": "Value of votes from VirusTotal community",
                      "order": 17,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "Tags",
                      "items": {
                        "type": "string"
                      },
                      "order": 18,
                      "title": "Tags",
                      "type": "array"
                    },
                    "targeted_brand": {
                      "description": "Targeted brand info extracted from phishing engines",
                      "order": 19,
                      "title": "Targeted Brand",
                      "type": "object"
                    },
                    "times_submitted": {
                      "description": "Number of times that URL has been checked",
                      "order": 20,
                      "title": "Times Submitted",
                      "type": "integer"
                    },
                    "title": {
                      "description": "Webpage title",
                      "order": 21,
                      "title": "Title",
                      "type": "string"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Containing the number of positive (harmless) and negative (malicious) votes received from VirusTotal community",
                      "order": 22,
                      "title": "Total Votes"
                    },
                    "trackers": {
                      "description": "Object containing all found trackers in that URL in a historical manner",
                      "order": 23,
                      "title": "Trackers",
                      "type": "object"
                    },
                    "url": {
                      "description": "Original URL to be scanned",
                      "order": 24,
                      "title": "URL",
                      "type": "string"
                    }
                  },
                  "title": "Url Report",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/url_report",
                  "description": "URL report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "5c15196b-5cb4-42d0-b36b-0d2ac56c609b": {
            "nodeId": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b",
            "name": "Lookup Header Domain",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "value"
                },
                "op": "=",
                "right": {
                  "name": "67913af3-e3b4-42a0-8a69-ef8ced2c2515.$item",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'value' = {{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}",
              "ignoreCase": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts",
            "globalArtifact": {
              "name": "Allowed Domains",
              "id": "375f6031-c41b-438f-90c7-21a20f14aa1e",
              "schema": {
                "definitions": {},
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              }
            },
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "5c9d2ecb-8c91-48fa-a770-f9886339013d": {
            "nodeId": "5c9d2ecb-8c91-48fa-a770-f9886339013d",
            "name": "Check for Attached Emails",
            "type": "filter",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "17e1742e-0a8c-415e-8d39-84d7abe594fb",
                "expression": {
                  "left": {
                    "args": [
                      {
                        "name": "48b34d41-dce5-43c2-9e37-6a18690c97b7.icon_email.attached_emails",
                        "type": "variable"
                      }
                    ],
                    "name": "is_defined",
                    "type": "function"
                  },
                  "op": "=",
                  "right": {
                    "type": "literal",
                    "value": true
                  },
                  "type": "binary"
                },
                "expressionText": "is_defined({{[48b34d41-dce5-43c2-9e37-6a18690c97b7].[icon_email].[attached_emails]}}) = true"
              },
              "stopOnMatch": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/filter.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "5ecaea1a-4fc4-4f8e-8ea1-79615d162252": {
            "nodeId": "5ecaea1a-4fc4-4f8e-8ea1-79615d162252",
            "name": "Domain Age Greater Than 30 Days",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "27ac3bca-5fe2-479f-91a5-3bd7d1113718",
              "stepControlParams": [
                {
                  "edgeId": "27ac3bca-5fe2-479f-91a5-3bd7d1113718",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "c3790b7b-9866-49ec-b282-24fce52462ae",
                  "expression": {
                    "left": {
                      "name": "6d636a24-d039-4beb-bd17-b455819577ed.difference",
                      "type": "variable"
                    },
                    "op": "<",
                    "right": {
                      "type": "literal",
                      "value": 30
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[6d636a24-d039-4beb-bd17-b455819577ed].[difference]}} < 30"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "67913af3-e3b4-42a0-8a69-ef8ced2c2515": {
            "nodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
            "name": "Header Domains Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "b898abb0-4e47-44f6-87ce-e418e454d43a.path",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": true
                        },
                        "type": "binary"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "name": "b898abb0-4e47-44f6-87ce-e418e454d43a.path",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": "High Risk"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "(is_defined({{[b898abb0-4e47-44f6-87ce-e418e454d43a].[path]}}) = true) && {{[b898abb0-4e47-44f6-87ce-e418e454d43a].[path]}} = \"High Risk\"",
                    "value": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}",
                    "valueType": "string"
                  },
                  "name": "High Risk Domains",
                  "outputType": "array"
                },
                {
                  "input": {
                    "condition": "any",
                    "expression": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "b898abb0-4e47-44f6-87ce-e418e454d43a.path",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": true
                        },
                        "type": "binary"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "name": "b898abb0-4e47-44f6-87ce-e418e454d43a.path",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": "High Risk"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "(is_defined({{[b898abb0-4e47-44f6-87ce-e418e454d43a].[path]}}) = true) && {{[b898abb0-4e47-44f6-87ce-e418e454d43a].[path]}} = \"High Risk\""
                  },
                  "name": "High Risk Domain Found",
                  "outputType": "boolean"
                },
                {
                  "input": {
                    "expression": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "b898abb0-4e47-44f6-87ce-e418e454d43a.path",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": true
                        },
                        "type": "binary"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "name": "b898abb0-4e47-44f6-87ce-e418e454d43a.path",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": "Low Risk"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "(is_defined({{[b898abb0-4e47-44f6-87ce-e418e454d43a].[path]}}) = true) && {{[b898abb0-4e47-44f6-87ce-e418e454d43a].[path]}} = \"Low Risk\"",
                    "value": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}",
                    "valueType": "string"
                  },
                  "name": "Low Risk Domains",
                  "outputType": "array"
                },
                {
                  "input": {
                    "expression": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "b898abb0-4e47-44f6-87ce-e418e454d43a.path",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": true
                        },
                        "type": "binary"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "name": "b898abb0-4e47-44f6-87ce-e418e454d43a.path",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": "Invalid"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "expressionText": "(is_defined({{[b898abb0-4e47-44f6-87ce-e418e454d43a].[path]}}) = true) && {{[b898abb0-4e47-44f6-87ce-e418e454d43a].[path]}} = \"Invalid\"",
                    "value": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}",
                    "valueType": "string"
                  },
                  "name": "Invalid Domains",
                  "outputType": "array"
                }
              ],
              "innerEdgeId": "380a636d-57ed-4f11-99bf-cbb301387335",
              "nextEdgeId": "935cdcf6-fcd2-459a-879f-c2c101aac57a",
              "repeatVariable": "{{[27ba9513-6b1d-4367-b210-500c5f84c2ed].[result]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "High Risk Domain Found": {
                  "description": "Custom output: \"High Risk Domain Found\"",
                  "title": "High Risk Domain Found",
                  "type": "boolean"
                },
                "High Risk Domains": {
                  "description": "Custom output: \"High Risk Domains\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "High Risk Domains",
                  "type": "array"
                },
                "Invalid Domains": {
                  "description": "Custom output: \"Invalid Domains\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "Invalid Domains",
                  "type": "array"
                },
                "Low Risk Domains": {
                  "description": "Custom output: \"Low Risk Domains\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "Low Risk Domains",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "6d636a24-d039-4beb-bd17-b455819577ed": {
            "nodeId": "6d636a24-d039-4beb-bd17-b455819577ed",
            "name": "Check Domain Age",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "3.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/3.0.0/icon.png"
            },
            "identifier": "time_elapsed",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "first_time": "{{[52d62575-8570-4769-9806-125f2c32e599].[creation_date]}}",
                "result_unit": "Days",
                "second_time": "{{[161de748-8070-44ac-851e-12cfc84e03e1].[datetime]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "first_time": {
                  "description": "First date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "First Date",
                  "type": "string"
                },
                "result_unit": {
                  "description": "Time unit of measurement for result",
                  "enum": [
                    "Years",
                    "Months",
                    "Days",
                    "Hours",
                    "Minutes",
                    "Seconds"
                  ],
                  "order": 3,
                  "title": "Result Unit",
                  "type": "string"
                },
                "second_time": {
                  "description": "Second date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 2,
                  "title": "Second Date",
                  "type": "string"
                }
              },
              "required": [
                "first_time",
                "second_time",
                "result_unit"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "difference": {
                  "description": "Quantity of time difference",
                  "order": 1,
                  "title": "Difference",
                  "type": "integer"
                },
                "time_unit": {
                  "description": "Time unit of measurement",
                  "order": 2,
                  "title": "Unit of Time",
                  "type": "string"
                }
              },
              "required": [
                "difference",
                "time_unit"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "76aed74b-5429-4f97-a711-f91a9d7d9121": {
            "nodeId": "76aed74b-5429-4f97-a711-f91a9d7d9121",
            "name": "Decode URL",
            "type": "action",
            "plugin": {
              "name": "Microsoft Office 365 ATP Safe Links",
              "slugVendor": "rapid7",
              "slugName": "microsoft_atp_safe_links",
              "slugVersion": "1.1.2",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_atp_safe_links/1.1.2/icon.png"
            },
            "identifier": "decode",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[49e3de65-d93f-4158-bf6d-7941d274d116].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "Safe Link to be decoded",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "required": [
                "url"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "decoded": {
                  "description": "Whether or not we were able to decode the URL",
                  "order": 2,
                  "title": "Decoded",
                  "type": "boolean"
                },
                "result": {
                  "description": "Result of the decoded Safe Link",
                  "order": 1,
                  "title": "Result",
                  "type": "string"
                }
              },
              "required": [
                "result",
                "decoded"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "791a66c7-b41b-400c-b9aa-2fb95c58343b": {
            "nodeId": "791a66c7-b41b-400c-b9aa-2fb95c58343b",
            "name": "VirusTotal Domain Scaler Input",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "4b865c1c-b595-4021-8aae-2bd156c0f91c",
              "stepControlParams": [
                {
                  "edgeId": "4b865c1c-b595-4021-8aae-2bd156c0f91c",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "a02155d8-5691-4d7a-a15c-8e963f520d5c",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "53c4a519-faf5-4727-a6bd-c3d6042036a0.report.reputation",
                        "type": "variable"
                      },
                      "op": "<",
                      "right": {
                        "type": "literal",
                        "value": 0
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "name": "53c4a519-faf5-4727-a6bd-c3d6042036a0.report.reputation",
                        "type": "variable"
                      },
                      "op": ">",
                      "right": {
                        "name": "$workflow.VirusTotal Domain Reputation Threshold",
                        "type": "variable"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[53c4a519-faf5-4727-a6bd-c3d6042036a0].[report].[reputation]}} < 0 && {{[53c4a519-faf5-4727-a6bd-c3d6042036a0].[report].[reputation]}} > {{$workflow.[VirusTotal Domain Reputation Threshold]}}"
                },
                {
                  "edgeId": "b35c53b4-6d87-4412-b515-c4ec20cb4141",
                  "expression": {
                    "left": {
                      "name": "53c4a519-faf5-4727-a6bd-c3d6042036a0.report.reputation",
                      "type": "variable"
                    },
                    "op": "<",
                    "right": {
                      "name": "$workflow.VirusTotal Domain Reputation Threshold",
                      "type": "variable"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[53c4a519-faf5-4727-a6bd-c3d6042036a0].[report].[reputation]}} < {{$workflow.[VirusTotal Domain Reputation Threshold]}}"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "7d512657-e6cf-4a55-9b37-5bae2a359173": {
            "nodeId": "7d512657-e6cf-4a55-9b37-5bae2a359173",
            "name": "Extract Header URLs",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "3.0.8",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/3.0.8/icon.png"
            },
            "identifier": "url_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "keep_original_urls": false,
                "str": "{{[a1ca6931-8535-4185-ac8e-bdc950c2813e].[$item].[headers]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes, supports text and binary file types such as PDF, DOCX, XLSX, PPTX, ODT, ODP, ODS",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "keep_original_urls": {
                  "default": false,
                  "description": "Retain original URL encoding, if applicable, e.g: if true: http://foo.bar/?q=Test%20URL-encoded%20stuff will be extracted as http://foo.bar/?q=Test%20URL-encoded%20stuff. If false, http://foo.bar/?q=Test%20URL-encoded%20stuff will be extracted as http://foo.bar/?q=Test because %20 is decoded as a space",
                  "order": 3,
                  "title": "Keep Original URLs",
                  "type": "boolean"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "urls": {
                  "description": "List of extracted URLs",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "URLs",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "9577c0ce-2371-4327-9178-1a4cf1432864": {
            "nodeId": "9577c0ce-2371-4327-9178-1a4cf1432864",
            "name": "Valid Domain",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "8d089ada-f1b1-4ac0-800b-cecb3e01a355",
              "stepControlParams": [
                {
                  "edgeId": "8d089ada-f1b1-4ac0-800b-cecb3e01a355",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "48af1ac3-319a-49e1-a46d-d08983c1ca50",
                  "expression": {
                    "left": {
                      "name": "52d62575-8570-4769-9806-125f2c32e599.$success",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": false
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[52d62575-8570-4769-9806-125f2c32e599].[$success]}}=false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "9b96ee9f-6d05-4f12-ac88-a30e3d1cd713": {
            "nodeId": "9b96ee9f-6d05-4f12-ac88-a30e3d1cd713",
            "name": "Filter Allowed Header Domains",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "2b8ed42b-172d-4819-a015-a1c55cb625b5",
              "stepControlParams": [
                {
                  "edgeId": "2b8ed42b-172d-4819-a015-a1c55cb625b5",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "4c96eb11-5f6f-408f-ac15-812537fa3053",
                  "expression": {
                    "left": {
                      "name": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b.found",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[5c15196b-5cb4-42d0-b36b-0d2ac56c609b].[found]}} = true"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "a1ca6931-8535-4185-ac8e-bdc950c2813e": {
            "nodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
            "name": "Attached Emails Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "438ed644-2e8d-48e0-b26a-4233ff7a6df8",
              "nextEdgeId": "c4c1d3eb-f1d8-4ac9-9f24-e46c0a23ff56",
              "repeatVariable": "{{[48b34d41-dce5-43c2-9e37-6a18690c97b7].[icon_email].[attached_emails]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "b898abb0-4e47-44f6-87ce-e418e454d43a": {
            "nodeId": "b898abb0-4e47-44f6-87ce-e418e454d43a",
            "name": "Domain Risk Decision",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "b7b3f82b-e554-43a4-be45-2fd9ddd4a40e",
              "stepControlParams": [
                {
                  "edgeId": "1cb6ab21-89a5-4dd8-a4c8-f12945ff9a45",
                  "expression": {
                    "left": {
                      "left": {
                        "left": {
                          "name": "3c832c1a-3d96-47ca-b150-a4a38e144954.WHOIS Reputation",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": "Invalid"
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "args": [
                            {
                              "name": "3c832c1a-3d96-47ca-b150-a4a38e144954.WHOIS Reputation",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "3789bc21-24b3-41d2-8dc2-9a3772420e34.VirusTotal Domain Repuation",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "name": "53c4a519-faf5-4727-a6bd-c3d6042036a0.$success",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "({{[3c832c1a-3d96-47ca-b150-a4a38e144954].[WHOIS Reputation]}} = \"Invalid\" || is_defined({{[3c832c1a-3d96-47ca-b150-a4a38e144954].[WHOIS Reputation]}}) = false) && (is_defined({{[3789bc21-24b3-41d2-8dc2-9a3772420e34].[VirusTotal Domain Repuation]}}) = false || {{[53c4a519-faf5-4727-a6bd-c3d6042036a0].[$success]}} = false)"
                },
                {
                  "edgeId": "3f5281f9-4c82-4495-a591-6bc898161f26",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "3c832c1a-3d96-47ca-b150-a4a38e144954.WHOIS Reputation",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "High Risk"
                      },
                      "type": "binary"
                    },
                    "op": "OR",
                    "right": {
                      "left": {
                        "name": "3789bc21-24b3-41d2-8dc2-9a3772420e34.VirusTotal Domain Repuation",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "High risk"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[3c832c1a-3d96-47ca-b150-a4a38e144954].[WHOIS Reputation]}} = \"High Risk\" || {{[3789bc21-24b3-41d2-8dc2-9a3772420e34].[VirusTotal Domain Repuation]}} = \"High risk\""
                },
                {
                  "edgeId": "86d085f5-5c69-4b18-93eb-ebe47db97a1c",
                  "expression": {
                    "left": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "3c832c1a-3d96-47ca-b150-a4a38e144954.WHOIS Reputation",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "left": {
                            "name": "3c832c1a-3d96-47ca-b150-a4a38e144954.WHOIS Reputation",
                            "type": "variable"
                          },
                          "op": "=",
                          "right": {
                            "type": "literal",
                            "value": "Invalid"
                          },
                          "type": "binary"
                        },
                        "op": "OR",
                        "right": {
                          "left": {
                            "name": "3c832c1a-3d96-47ca-b150-a4a38e144954.WHOIS Reputation",
                            "type": "variable"
                          },
                          "op": "=",
                          "right": {
                            "type": "literal",
                            "value": "Low risk"
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "left": {
                          "args": [
                            {
                              "name": "3789bc21-24b3-41d2-8dc2-9a3772420e34.VirusTotal Domain Repuation",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "left": {
                            "name": "3789bc21-24b3-41d2-8dc2-9a3772420e34.VirusTotal Domain Repuation",
                            "type": "variable"
                          },
                          "op": "=",
                          "right": {
                            "type": "literal",
                            "value": "Low risk"
                          },
                          "type": "binary"
                        },
                        "op": "OR",
                        "right": {
                          "left": {
                            "name": "3789bc21-24b3-41d2-8dc2-9a3772420e34.VirusTotal Domain Repuation",
                            "type": "variable"
                          },
                          "op": "=",
                          "right": {
                            "type": "literal",
                            "value": "No risk"
                          },
                          "type": "binary"
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "(is_defined({{[3c832c1a-3d96-47ca-b150-a4a38e144954].[WHOIS Reputation]}}) = false || {{[3c832c1a-3d96-47ca-b150-a4a38e144954].[WHOIS Reputation]}} = \"Invalid\" || {{[3c832c1a-3d96-47ca-b150-a4a38e144954].[WHOIS Reputation]}} = \"Low risk\") && (is_defined({{[3789bc21-24b3-41d2-8dc2-9a3772420e34].[VirusTotal Domain Repuation]}}) = false || {{[3789bc21-24b3-41d2-8dc2-9a3772420e34].[VirusTotal Domain Repuation]}} = \"Low risk\" || {{[3789bc21-24b3-41d2-8dc2-9a3772420e34].[VirusTotal Domain Repuation]}} = \"No risk\")"
                },
                {
                  "edgeId": "b7b3f82b-e554-43a4-be45-2fd9ddd4a40e",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "d3b75341-0a96-4366-934d-ee5a48fc195c": {
            "nodeId": "d3b75341-0a96-4366-934d-ee5a48fc195c",
            "name": "VirusTotal Scan URL",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "10.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/10.0.0/icon.png"
            },
            "identifier": "scan_url",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "url": "{{[76aed74b-5429-4f97-a711-f91a9d7d9121].[result]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "url": {
                  "description": "URL to scan",
                  "order": 1,
                  "title": "URL",
                  "type": "string"
                }
              },
              "required": [
                "url"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "submission_response": {
                  "properties": {
                    "id": {
                      "description": "Submission ID",
                      "order": 2,
                      "title": "ID",
                      "type": "string"
                    },
                    "type": {
                      "description": "Submission type",
                      "order": 1,
                      "title": "Type",
                      "type": "string"
                    }
                  },
                  "title": "Submission Response",
                  "type": "object"
                }
              },
              "properties": {
                "submission_response": {
                  "$ref": "#/definitions/submission_response",
                  "description": "URL submission response",
                  "order": 1,
                  "title": "Submission Response"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "ec5e4ea6-f193-487f-90dd-c1eceb7076c5": {
            "nodeId": "ec5e4ea6-f193-487f-90dd-c1eceb7076c5",
            "name": "Domain Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## {{[b898abb0-4e47-44f6-87ce-e418e454d43a].[path]}} Domain Detected\n**Domain:** {{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}} \\\n**Domain Age:** {{[3c832c1a-3d96-47ca-b150-a4a38e144954].[Domain Age]}}\n\n### VirusTotal\n**VirusTotal Reputation:** {{[3789bc21-24b3-41d2-8dc2-9a3772420e34].[VirusTotal Domain Repuation]}} \\\n> **Community Results**\n>> Harmless Votes: {{[53c4a519-faf5-4727-a6bd-c3d6042036a0].[report].[total_votes].[harmless]}}\n>> Malicious Votes: {{[53c4a519-faf5-4727-a6bd-c3d6042036a0].[report].[total_votes].[malicious]}}\n\n> **Analysis Stats**\n>> Harmless: {{[53c4a519-faf5-4727-a6bd-c3d6042036a0].[report].[last_analysis_stats].[harmless]}}\n>> Suspicious: {{[53c4a519-faf5-4727-a6bd-c3d6042036a0].[report].[last_analysis_stats].[suspicious]}}\n>> Malicious: {{[53c4a519-faf5-4727-a6bd-c3d6042036a0].[report].[last_analysis_stats].[malicious]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec": {
            "nodeId": "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec",
            "name": "Extract Header Domains",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "3.0.8",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/3.0.8/icon.png"
            },
            "identifier": "domain_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[a1ca6931-8535-4185-ac8e-bdc950c2813e].[$item].[headers]}}",
                "subdomain": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes, supports text and binary file types such as PDF, DOCX, XLSX, PPTX, ODF, TXT, ZIP",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                },
                "subdomain": {
                  "description": "Include subdomain in result",
                  "order": 3,
                  "title": "Subdomain",
                  "type": "boolean"
                }
              },
              "required": [
                "subdomain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "domains": {
                  "description": "List of extracted Domain names",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domain Names",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "f95d0442-4cc2-4f42-94e9-a47ca89ad612": {
            "nodeId": "f95d0442-4cc2-4f42-94e9-a47ca89ad612",
            "name": "URL Excluded Decision",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "38a9dfe9-5841-4b16-94e5-9893c3954778",
              "stepControlParams": [
                {
                  "edgeId": "9b0bf422-bf09-4607-ab09-4c1042c20423",
                  "expression": {
                    "left": {
                      "name": "311ca1c6-6ee5-4a28-a53d-ecf86322d89a.found",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[311ca1c6-6ee5-4a28-a53d-ecf86322d89a].[found]}} = true"
                },
                {
                  "edgeId": "38a9dfe9-5841-4b16-94e5-9893c3954778",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          }
        },
        "tags": [],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Mailbox": {
                "type": "string",
                "description": "The email that should be monitored for reported messages."
              },
              "VirusTotal Domain Reputation Threshold": {
                "type": "integer",
                "description": "Threshold for determining VirusTotal assessment. Needs to be NEGATIVE. Please see workflow description for details."
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "0ed543a0-01ae-46f8-ab2d-e6e1213c18b8",
        "identifier": "email_received",
        "name": "New Email Received",
        "description": "Triggers when a new email is received in the inbox.",
        "input": {
          "flatten_attachments": false,
          "folder_name": "Inbox",
          "interval": 15,
          "mailbox_id": "{{[$workflow].[Mailbox]}}",
          "subject_query": " "
        },
        "inputJsonSchema": {
          "properties": {
            "flatten_attachments": {
              "default": false,
              "description": "Will return all attachments as flat lists instead of nested emails",
              "order": 5,
              "title": "Flatten Attachments",
              "type": "boolean"
            },
            "folder_name": {
              "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive. Folder GUID may be specified as well",
              "order": 2,
              "title": "Folder Name",
              "type": "string"
            },
            "interval": {
              "default": 15,
              "description": "How often to poll for new email in seconds",
              "order": 3,
              "title": "Interval",
              "type": "integer"
            },
            "mailbox_id": {
              "description": "The mailbox to monitor for incoming email",
              "order": 1,
              "title": "Mailbox ID",
              "type": "string"
            },
            "subject_query": {
              "default": " ",
              "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
              "order": 4,
              "title": "Subject Query",
              "type": "string"
            }
          },
          "required": [
            "mailbox_id",
            "flatten_attachments"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "attachment_email": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email",
              "type": "object"
            },
            "attachment_email_nested": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested_two"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested",
              "type": "object"
            },
            "attachment_email_nested_two": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "type": "object"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested Two",
              "type": "object"
            },
            "attachment_file": {
              "properties": {
                "content": {
                  "order": 2,
                  "title": "Content",
                  "type": "string"
                },
                "content_type": {
                  "order": 3,
                  "title": "Content Type",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "Indicators",
                  "order": 4,
                  "title": "Indicators"
                },
                "name": {
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "title": "Attachment File",
              "type": "object"
            },
            "header": {
              "properties": {
                "name": {
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                },
                "value": {
                  "order": 2,
                  "title": "Value",
                  "type": "string"
                }
              },
              "title": "Header",
              "type": "object"
            },
            "icon_email": {
              "properties": {
                "account": {
                  "description": "Account for which the email was found on",
                  "order": 2,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 6,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 11,
                  "title": "Categories",
                  "type": "array"
                },
                "flattened_attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 9,
                  "title": "Flattened Attached Emails",
                  "type": "array"
                },
                "flattened_attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 10,
                  "title": "Flattened Attached Files",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 14,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 12,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "is_read": {
                  "description": "Whether or not the email has been read",
                  "order": 3,
                  "title": "Is Read",
                  "type": "boolean"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 13,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 4,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 5,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Icon Email",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "md5": {
                  "description": "MD5 hash",
                  "order": 1,
                  "title": "MD5",
                  "type": "string"
                },
                "sha1": {
                  "description": "SHA1 hash",
                  "order": 2,
                  "title": "SHA1",
                  "type": "string"
                },
                "sha256": {
                  "description": "SHA256 hash",
                  "order": 3,
                  "title": "SHA256",
                  "type": "string"
                }
              },
              "title": "Indicators",
              "type": "object"
            }
          },
          "properties": {
            "icon_email": {
              "$ref": "#/definitions/icon_email",
              "description": "Email",
              "order": 1,
              "title": "Email"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Office 365 Email",
          "slugVendor": "rapid7",
          "slugName": "microsoft_office365_email",
          "slugVersion": "6.0.4",
          "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/6.0.4/icon.png"
        }
      }
    ]
  }
}