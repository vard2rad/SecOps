{
  "kom": {
    "komandVersion": "1.176.4-0-gb65a8",
    "komFileVersion": "2.0.0",
    "exportedAt": "2024-01-04T17:26:20.147852616Z",
    "workflowVersions": [
      {
        "name": "Attached Email Analysis",
        "type": "runnable",
        "version": "",
        "description": "",
        "graph": {
          "edges": {
            "0120d831-3338-4eca-b5ab-fbc4dcf9e169": {
              "id": "0120d831-3338-4eca-b5ab-fbc4dcf9e169",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "29ee9f78-9e17-4c1a-9aba-b3a255caec41",
              "toNodeId": "ae3aba62-d292-4e43-aa50-d0874c722154"
            },
            "17e1742e-0a8c-415e-8d39-84d7abe594fb": {
              "id": "17e1742e-0a8c-415e-8d39-84d7abe594fb",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "5c9d2ecb-8c91-48fa-a770-f9886339013d",
              "toNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "1c463098-0ded-46bb-83b1-2afe2eb0eb9c": {
              "id": "1c463098-0ded-46bb-83b1-2afe2eb0eb9c",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "71f35a2a-2e1d-4f85-86e8-8db217a68880",
              "toNodeId": "d5d828a0-97af-43c9-8713-89d9f58f7be3"
            },
            "1d6240d4-9b54-4906-93d3-72fa229a6f0b": {
              "id": "1d6240d4-9b54-4906-93d3-72fa229a6f0b",
              "name": "True",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "b8a82da6-037b-421b-ae7a-d46078baa704",
              "toNodeId": ""
            },
            "380a636d-57ed-4f11-99bf-cbb301387335": {
              "id": "380a636d-57ed-4f11-99bf-cbb301387335",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "toNodeId": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b"
            },
            "3a800ce2-eeed-4915-84ab-1ecf60e156d3": {
              "id": "3a800ce2-eeed-4915-84ab-1ecf60e156d3",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "27ba9513-6b1d-4367-b210-500c5f84c2ed",
              "toNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "438ed644-2e8d-48e0-b26a-4233ff7a6df8": {
              "id": "438ed644-2e8d-48e0-b26a-4233ff7a6df8",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "toNodeId": "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec"
            },
            "4d07c7d9-57d5-42bc-afc2-5d9e64e4dfa6": {
              "id": "4d07c7d9-57d5-42bc-afc2-5d9e64e4dfa6",
              "name": "Malicious",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "ffb63334-03ee-4333-843b-6b770451f31a",
              "toNodeId": "3033f2be-f58e-4a3c-8cba-dd4f54127e44"
            },
            "5161efb8-b72f-4fd1-9d2b-6a1f4b8f75b9": {
              "id": "5161efb8-b72f-4fd1-9d2b-6a1f4b8f75b9",
              "name": "Fail",
              "description": "Domain was either not found by WHOIS or the creation date was not defined.",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "ae3aba62-d292-4e43-aa50-d0874c722154",
              "toNodeId": "d5d828a0-97af-43c9-8713-89d9f58f7be3"
            },
            "60a2e8a7-60f9-4996-9341-7034f0d47f87": {
              "id": "60a2e8a7-60f9-4996-9341-7034f0d47f87",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "48b34d41-dce5-43c2-9e37-6a18690c97b7",
              "toNodeId": "5c9d2ecb-8c91-48fa-a770-f9886339013d"
            },
            "6cacde1f-46f2-4291-afca-f30fe6097cad": {
              "id": "6cacde1f-46f2-4291-afca-f30fe6097cad",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec",
              "toNodeId": "27ba9513-6b1d-4367-b210-500c5f84c2ed"
            },
            "7a9db1ea-61a7-4665-bb05-4d8c59790ec6": {
              "id": "7a9db1ea-61a7-4665-bb05-4d8c59790ec6",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "d5d828a0-97af-43c9-8713-89d9f58f7be3",
              "toNodeId": "32654a74-9673-47b0-9ab2-260bb72ace91"
            },
            "935cdcf6-fcd2-459a-879f-c2c101aac57a": {
              "id": "935cdcf6-fcd2-459a-879f-c2c101aac57a",
              "name": "",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "toNodeId": "b8a82da6-037b-421b-ae7a-d46078baa704"
            },
            "9c6477da-62d7-480d-89fb-ac32ae175980": {
              "id": "9c6477da-62d7-480d-89fb-ac32ae175980",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "b0816c9e-f2c1-4f85-bf02-45a56ca9d805",
              "toNodeId": "ffb63334-03ee-4333-843b-6b770451f31a"
            },
            "ae449eca-4e18-4fc5-9fea-a6a9f3a2b873": {
              "id": "ae449eca-4e18-4fc5-9fea-a6a9f3a2b873",
              "name": "Pass",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "32654a74-9673-47b0-9ab2-260bb72ace91",
              "toNodeId": "b0816c9e-f2c1-4f85-bf02-45a56ca9d805"
            },
            "b46c3de8-4da0-494d-a2a4-289e93a6150b": {
              "id": "b46c3de8-4da0-494d-a2a4-289e93a6150b",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b",
              "toNodeId": "52d62575-8570-4769-9806-125f2c32e599"
            },
            "b4955b3d-0c3f-4ccb-846f-792d02fbf0d8": {
              "id": "b4955b3d-0c3f-4ccb-846f-792d02fbf0d8",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "8cb56d0d-0d82-4ef2-947e-f13927dc93cd",
              "toNodeId": "71f35a2a-2e1d-4f85-86e8-8db217a68880"
            },
            "b559b7b6-3710-4901-947a-c6e412250326": {
              "id": "b559b7b6-3710-4901-947a-c6e412250326",
              "name": "Fail",
              "description": "VirusTotal did not find the domain.",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "32654a74-9673-47b0-9ab2-260bb72ace91",
              "toNodeId": "b0816c9e-f2c1-4f85-bf02-45a56ca9d805"
            },
            "b8b82149-4005-4e1c-845e-1b072a474d4a": {
              "id": "b8b82149-4005-4e1c-845e-1b072a474d4a",
              "name": "Invalid",
              "description": "Both services included in the loop did not find valid results.",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "ffb63334-03ee-4333-843b-6b770451f31a",
              "toNodeId": ""
            },
            "beee0fe9-7df2-4f16-a56e-76af1a52d0d4": {
              "id": "beee0fe9-7df2-4f16-a56e-76af1a52d0d4",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "3033f2be-f58e-4a3c-8cba-dd4f54127e44",
              "toNodeId": ""
            },
            "bf56c31b-d9cc-46ad-a3a2-e12b4632c8c3": {
              "id": "bf56c31b-d9cc-46ad-a3a2-e12b4632c8c3",
              "name": "",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "52d62575-8570-4769-9806-125f2c32e599",
              "toNodeId": "29ee9f78-9e17-4c1a-9aba-b3a255caec41"
            },
            "c4c1d3eb-f1d8-4ac9-9f24-e46c0a23ff56": {
              "id": "c4c1d3eb-f1d8-4ac9-9f24-e46c0a23ff56",
              "name": "",
              "description": "",
              "parentNodeId": "",
              "fromNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "toNodeId": ""
            },
            "c953ac2c-029f-436e-abbe-189e119d6537": {
              "id": "c953ac2c-029f-436e-abbe-189e119d6537",
              "name": "Pass",
              "description": "Requirements to analyze domain were successfully defined.",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "ae3aba62-d292-4e43-aa50-d0874c722154",
              "toNodeId": "8cb56d0d-0d82-4ef2-947e-f13927dc93cd"
            },
            "e2d2e8ce-88e6-4668-b43a-6999435d6860": {
              "id": "e2d2e8ce-88e6-4668-b43a-6999435d6860",
              "name": "False",
              "description": "",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "fromNodeId": "b8a82da6-037b-421b-ae7a-d46078baa704",
              "toNodeId": ""
            },
            "efc17a74-2f2d-4d9b-a724-4d4cd6a61d38": {
              "id": "efc17a74-2f2d-4d9b-a724-4d4cd6a61d38",
              "name": "Harmless",
              "description": "",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "fromNodeId": "ffb63334-03ee-4333-843b-6b770451f31a",
              "toNodeId": ""
            }
          },
          "nodes": {
            "27ba9513-6b1d-4367-b210-500c5f84c2ed": {
              "id": "27ba9513-6b1d-4367-b210-500c5f84c2ed",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "29ee9f78-9e17-4c1a-9aba-b3a255caec41": {
              "id": "29ee9f78-9e17-4c1a-9aba-b3a255caec41",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "3033f2be-f58e-4a3c-8cba-dd4f54127e44": {
              "id": "3033f2be-f58e-4a3c-8cba-dd4f54127e44",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "32654a74-9673-47b0-9ab2-260bb72ace91": {
              "id": "32654a74-9673-47b0-9ab2-260bb72ace91",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "48b34d41-dce5-43c2-9e37-6a18690c97b7": {
              "id": "48b34d41-dce5-43c2-9e37-6a18690c97b7",
              "parentNodeId": ""
            },
            "52d62575-8570-4769-9806-125f2c32e599": {
              "id": "52d62575-8570-4769-9806-125f2c32e599",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "5c15196b-5cb4-42d0-b36b-0d2ac56c609b": {
              "id": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "5c9d2ecb-8c91-48fa-a770-f9886339013d": {
              "id": "5c9d2ecb-8c91-48fa-a770-f9886339013d",
              "parentNodeId": ""
            },
            "67913af3-e3b4-42a0-8a69-ef8ced2c2515": {
              "id": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "71f35a2a-2e1d-4f85-86e8-8db217a68880": {
              "id": "71f35a2a-2e1d-4f85-86e8-8db217a68880",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "8cb56d0d-0d82-4ef2-947e-f13927dc93cd": {
              "id": "8cb56d0d-0d82-4ef2-947e-f13927dc93cd",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "a1ca6931-8535-4185-ac8e-bdc950c2813e": {
              "id": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
              "parentNodeId": ""
            },
            "ae3aba62-d292-4e43-aa50-d0874c722154": {
              "id": "ae3aba62-d292-4e43-aa50-d0874c722154",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "b0816c9e-f2c1-4f85-bf02-45a56ca9d805": {
              "id": "b0816c9e-f2c1-4f85-bf02-45a56ca9d805",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "b8a82da6-037b-421b-ae7a-d46078baa704": {
              "id": "b8a82da6-037b-421b-ae7a-d46078baa704",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "d5d828a0-97af-43c9-8713-89d9f58f7be3": {
              "id": "d5d828a0-97af-43c9-8713-89d9f58f7be3",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            },
            "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec": {
              "id": "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec",
              "parentNodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e"
            },
            "ffb63334-03ee-4333-843b-6b770451f31a": {
              "id": "ffb63334-03ee-4333-843b-6b770451f31a",
              "parentNodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515"
            }
          }
        },
        "steps": {
          "27ba9513-6b1d-4367-b210-500c5f84c2ed": {
            "nodeId": "27ba9513-6b1d-4367-b210-500c5f84c2ed",
            "name": "Uniq Header Domains",
            "type": "action",
            "plugin": {
              "name": "Uniq",
              "slugVendor": "rapid7",
              "slugName": "uniq",
              "slugVersion": "1.0.2",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/uniq/1.0.2/icon.png"
            },
            "identifier": "uniq_string_array",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "data": "{{[f07a4ce8-ec8e-4b15-ba46-43358e8b19ec].[domains]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "data": {
                  "description": "Array of strings",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Data",
                  "type": "array"
                }
              },
              "required": [
                "data"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "duplicate_count": {
                  "description": "Count of duplicates removed",
                  "order": 2,
                  "title": "Duplicate count",
                  "type": "integer"
                },
                "element_count": {
                  "description": "Count of each element",
                  "order": 3,
                  "title": "Element count",
                  "type": "object"
                },
                "result": {
                  "description": "Result without duplicates",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Result",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "29ee9f78-9e17-4c1a-9aba-b3a255caec41": {
            "nodeId": "29ee9f78-9e17-4c1a-9aba-b3a255caec41",
            "name": "VirusTotal Domain Report",
            "type": "action",
            "plugin": {
              "name": "VirusTotal",
              "slugVendor": "rapid7",
              "slugName": "virustotal",
              "slugVersion": "10.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/virustotal/10.0.0/icon.png"
            },
            "identifier": "domain_report",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "authority_key_identifier": {
                  "properties": {
                    "keyid": {
                      "description": "Key hexdump",
                      "order": 1,
                      "title": "Key ID",
                      "type": "string"
                    },
                    "serial_number": {
                      "description": "Serial number hexdump",
                      "order": 2,
                      "title": "Serial Number",
                      "type": "string"
                    }
                  },
                  "title": "Authority Key Identifier",
                  "type": "object"
                },
                "cert_signature": {
                  "properties": {
                    "signature": {
                      "description": "Signature hexdump",
                      "order": 1,
                      "title": "Signature",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Used algorithm",
                      "order": 2,
                      "title": "Signature Algorithm",
                      "type": "string"
                    }
                  },
                  "title": "Cert Signature",
                  "type": "object"
                },
                "domain_report": {
                  "properties": {
                    "categories": {
                      "description": "Mapping that relates categorization services with the assigned domain category. These services are, among others: Alexa, BitDefender, TrendMicro, Websense ThreatSeeker, etc.",
                      "order": 1,
                      "title": "Categories",
                      "type": "object"
                    },
                    "creation_date": {
                      "description": "Creation date extracted from the Domain's WHOIS (UTC timestamp)",
                      "order": 2,
                      "title": "Creation Date",
                      "type": "integer"
                    },
                    "favicon": {
                      "$ref": "#/definitions/icon",
                      "description": "Dictionary including difference hash and MD5 hash of the domain's favicon",
                      "order": 3,
                      "title": "Favicon"
                    },
                    "last_analysis_results": {
                      "description": "Result from URL scanners. Object with scanner name as key and an object with notes/result from that scanner as value",
                      "items": {
                        "$ref": "#/definitions/last_analysis_result"
                      },
                      "order": 4,
                      "title": "Last Analysis Results",
                      "type": "array"
                    },
                    "last_analysis_stats": {
                      "$ref": "#/definitions/last_analysis_stats",
                      "description": "Number of different results from this scan",
                      "order": 5,
                      "title": "Last Analysis Statistics"
                    },
                    "last_dns_records": {
                      "description": "Domain's DNS records on its last scan",
                      "items": {
                        "$ref": "#/definitions/last_dns_records"
                      },
                      "order": 6,
                      "title": "Last DNS Records",
                      "type": "array"
                    },
                    "last_dns_records_date": {
                      "description": "Date when the DNS records list was retrieved by VirusTotal (UTC timestamp)",
                      "order": 7,
                      "title": "Last DNS Records Date",
                      "type": "integer"
                    },
                    "last_https_certificate": {
                      "$ref": "#/definitions/ssl_certificate",
                      "description": "SSL certificate object retrieved last time the domain was analyzed",
                      "order": 8,
                      "title": "Last HTTPS Certificate"
                    },
                    "last_https_certificate_date": {
                      "description": "Date when the certificate was retrieved by VirusTotal (UTC timestamp)",
                      "order": 9,
                      "title": "Last HTTPS Certificate Date",
                      "type": "integer"
                    },
                    "last_modification_date": {
                      "description": "Date when any of the domain's information was last updated",
                      "order": 10,
                      "title": "Last Modification Date",
                      "type": "integer"
                    },
                    "last_update_date": {
                      "description": "Updated date extracted from WHOIS (UTC timestamp)",
                      "order": 11,
                      "title": "Last Update Date",
                      "type": "integer"
                    },
                    "popularity_ranks": {
                      "$ref": "#/definitions/popularity_ranks",
                      "description": "Domain's position in popularity ranks such as Alexa, Quantcast, Statvoo, etc.",
                      "order": 12,
                      "title": "Popularity Ranks"
                    },
                    "registrar": {
                      "description": "Company that registered the domain",
                      "order": 13,
                      "title": "Registrar",
                      "type": "string"
                    },
                    "reputation": {
                      "description": "Domain's score calculated from the votes of the VirusTotal's community",
                      "order": 14,
                      "title": "Reputation",
                      "type": "integer"
                    },
                    "tags": {
                      "description": "List of representative attributes",
                      "items": {
                        "type": "string"
                      },
                      "order": 15,
                      "title": "Tags",
                      "type": "array"
                    },
                    "total_votes": {
                      "$ref": "#/definitions/total_votes",
                      "description": "Unweighted number of total votes from the community, divided in harmless and malicious",
                      "order": 16,
                      "title": "Total Votes"
                    },
                    "whois": {
                      "description": "WHOIS information as returned from the pertinent WHOIS server",
                      "order": 17,
                      "title": "WHOIS",
                      "type": "string"
                    },
                    "whois_date": {
                      "description": "Date of the last update of the WHOIS record in VirusTotal",
                      "order": 18,
                      "title": "WHOIS Date",
                      "type": "integer"
                    }
                  },
                  "title": "Domain Report",
                  "type": "object"
                },
                "dsa": {
                  "properties": {
                    "g": {
                      "description": "G component hexdump",
                      "order": 3,
                      "title": "G",
                      "type": "string"
                    },
                    "p": {
                      "description": "P component hexdump",
                      "order": 1,
                      "title": "P",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 4,
                      "title": "Public",
                      "type": "string"
                    },
                    "q": {
                      "description": "Q component hexdump",
                      "order": 2,
                      "title": "Q",
                      "type": "string"
                    }
                  },
                  "title": "Dsa",
                  "type": "object"
                },
                "ec": {
                  "properties": {
                    "oid": {
                      "description": "Curve name",
                      "order": 1,
                      "title": "OID",
                      "type": "string"
                    },
                    "pub": {
                      "description": "Public key hexdump",
                      "order": 2,
                      "title": "Public",
                      "type": "string"
                    }
                  },
                  "title": "Ec",
                  "type": "object"
                },
                "icon": {
                  "properties": {
                    "dhash": {
                      "description": "Difference hash",
                      "order": 1,
                      "title": "DHASH",
                      "type": "string"
                    },
                    "raw_md5": {
                      "description": "Icon's MD5 hash",
                      "order": 2,
                      "title": "Raw MD5",
                      "type": "string"
                    }
                  },
                  "title": "Icon",
                  "type": "object"
                },
                "last_analysis_result": {
                  "properties": {
                    "category": {
                      "description": "Category",
                      "order": 2,
                      "title": "Category",
                      "type": "string"
                    },
                    "engine_name": {
                      "description": "Engine name",
                      "order": 1,
                      "title": "Engine Name",
                      "type": "string"
                    },
                    "engine_update": {
                      "description": "Engine's last update date",
                      "order": 3,
                      "title": "Engine Update",
                      "type": "string"
                    },
                    "engine_version": {
                      "description": "Engine's version",
                      "order": 4,
                      "title": "Engine Version",
                      "type": "string"
                    },
                    "method": {
                      "description": "Detection method",
                      "order": 5,
                      "title": "Method",
                      "type": "string"
                    },
                    "result": {
                      "description": "Result",
                      "order": 6,
                      "title": "Result",
                      "type": "string"
                    }
                  },
                  "title": "Last Analysis Result",
                  "type": "object"
                },
                "last_analysis_stats": {
                  "properties": {
                    "harmless": {
                      "description": "Number of reports indicating harmless",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of reports indicating malicious",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    },
                    "suspicious": {
                      "description": "Number of reports indicating suspicious",
                      "order": 3,
                      "title": "Suspicious",
                      "type": "integer"
                    },
                    "timeout": {
                      "description": "Number of reports indicating timeout",
                      "order": 4,
                      "title": "Timeout",
                      "type": "integer"
                    },
                    "undetected": {
                      "description": "Number of reports indicating undetected",
                      "order": 5,
                      "title": "Undetected",
                      "type": "integer"
                    }
                  },
                  "title": "Last Analysis Stats",
                  "type": "object"
                },
                "last_dns_records": {
                  "properties": {
                    "expire": {
                      "description": "Expire",
                      "order": 1,
                      "title": "Expire",
                      "type": "integer"
                    },
                    "flag": {
                      "description": "Flag",
                      "order": 2,
                      "title": "Flag",
                      "type": "integer"
                    },
                    "minimum": {
                      "description": "Minimum",
                      "order": 3,
                      "title": "Minimum",
                      "type": "integer"
                    },
                    "priority": {
                      "description": "Priority",
                      "order": 4,
                      "title": "Priority",
                      "type": "integer"
                    },
                    "refresh": {
                      "description": "Refresh",
                      "order": 5,
                      "title": "Refresh",
                      "type": "integer"
                    },
                    "retry": {
                      "description": "Retry",
                      "order": 7,
                      "title": "Retry",
                      "type": "integer"
                    },
                    "rname": {
                      "description": "RNAME",
                      "order": 6,
                      "title": "RNAME",
                      "type": "string"
                    },
                    "serial": {
                      "description": "Serial",
                      "order": 8,
                      "title": "Serial",
                      "type": "integer"
                    },
                    "tag": {
                      "description": "Tag",
                      "order": 9,
                      "title": "Tag",
                      "type": "string"
                    },
                    "ttl": {
                      "description": "Time to live",
                      "order": 10,
                      "title": "TTL",
                      "type": "integer"
                    },
                    "type": {
                      "description": "Type",
                      "order": 11,
                      "title": "Type",
                      "type": "string"
                    },
                    "value": {
                      "description": "Value",
                      "order": 12,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Last Dns Records",
                  "type": "object"
                },
                "popularity_ranks": {
                  "properties": {
                    "rank": {
                      "description": "Rank position",
                      "order": 1,
                      "title": "Rank",
                      "type": "integer"
                    },
                    "timestamp": {
                      "description": "UTC timestamp when the rank was ingested",
                      "order": 2,
                      "title": "Timestamp",
                      "type": "integer"
                    }
                  },
                  "title": "Popularity Ranks",
                  "type": "object"
                },
                "public_key": {
                  "properties": {
                    "algorithm": {
                      "description": "Indicates the algorithm used to generate the certificate",
                      "order": 1,
                      "title": "Algorithm",
                      "type": "string"
                    },
                    "dsa": {
                      "$ref": "#/definitions/dsa",
                      "description": "DSA public key information",
                      "order": 3,
                      "title": "DSA"
                    },
                    "ec": {
                      "$ref": "#/definitions/ec",
                      "description": "EC public key information",
                      "order": 4,
                      "title": "EC"
                    },
                    "rsa": {
                      "$ref": "#/definitions/rsa",
                      "description": "RSA public key information",
                      "order": 2,
                      "title": "RSA"
                    }
                  },
                  "title": "Public Key",
                  "type": "object"
                },
                "rsa": {
                  "properties": {
                    "exponent": {
                      "description": "Key exponent hexdump",
                      "order": 3,
                      "title": "Exponent",
                      "type": "string"
                    },
                    "key_size": {
                      "description": "Key size",
                      "order": 1,
                      "title": "Key Size",
                      "type": "integer"
                    },
                    "modulus": {
                      "description": "Key modulus hexdump",
                      "order": 2,
                      "title": "Modulus",
                      "type": "string"
                    }
                  },
                  "title": "Rsa",
                  "type": "object"
                },
                "ssl_certificate": {
                  "properties": {
                    "cert_signature": {
                      "$ref": "#/definitions/cert_signature",
                      "description": "Dictionary containing certificate's signature and algorithm",
                      "order": 1,
                      "title": "Certificate Signature"
                    },
                    "extensions": {
                      "$ref": "#/definitions/ssl_extensions",
                      "description": "Dictionary containing all certificate's extensions",
                      "order": 2,
                      "title": "Extensions"
                    },
                    "first_seen_date": {
                      "description": "Date the certificate was first retrieved by VirusTotal",
                      "order": 3,
                      "title": "First Seen Date",
                      "type": "integer"
                    },
                    "issuer": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's issuer data",
                      "order": 4,
                      "title": "Issuer"
                    },
                    "public_key": {
                      "$ref": "#/definitions/public_key",
                      "description": "Subject public key info",
                      "order": 5,
                      "title": "Public Key"
                    },
                    "serial_number": {
                      "description": "Certificate's serial number hexdump",
                      "order": 6,
                      "title": "Serial Number",
                      "type": "string"
                    },
                    "signature_algorithm": {
                      "description": "Algorithm used for the signature",
                      "order": 7,
                      "title": "Signature Algorithm",
                      "type": "string"
                    },
                    "size": {
                      "description": "Certificate content length",
                      "order": 8,
                      "title": "Size",
                      "type": "integer"
                    },
                    "subject": {
                      "$ref": "#/definitions/ssl_data",
                      "description": "Dictionary containing the certificate's subject data",
                      "order": 9,
                      "title": "Subject"
                    },
                    "thumbprint": {
                      "description": "Certificate's content SHA1 hash",
                      "order": 10,
                      "title": "Thumbprint",
                      "type": "string"
                    },
                    "thumbprint_sha256": {
                      "description": "Certificate's content SHA256 hash",
                      "order": 11,
                      "title": "Thumbprint SHA256",
                      "type": "string"
                    },
                    "validity": {
                      "$ref": "#/definitions/validity",
                      "description": "Defines certificate's validity period",
                      "order": 12,
                      "title": "Validity"
                    },
                    "version": {
                      "description": "Certificate version",
                      "order": 13,
                      "title": "Version",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Certificate",
                  "type": "object"
                },
                "ssl_data": {
                  "properties": {
                    "C": {
                      "description": "Country name",
                      "order": 1,
                      "title": "Country Name",
                      "type": "string"
                    },
                    "CN": {
                      "description": "Common name",
                      "order": 2,
                      "title": "Common Name",
                      "type": "string"
                    },
                    "L": {
                      "description": "Locality",
                      "order": 3,
                      "title": "Locality",
                      "type": "string"
                    },
                    "O": {
                      "description": "Organization",
                      "order": 4,
                      "title": "Organization",
                      "type": "string"
                    },
                    "OU": {
                      "description": "Organizational unit",
                      "order": 5,
                      "title": "Organizational Unit",
                      "type": "string"
                    },
                    "ST": {
                      "description": "State or province name",
                      "order": 6,
                      "title": "State or Province Name",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Data",
                  "type": "object"
                },
                "ssl_extensions": {
                  "properties": {
                    "authority_key_identifier": {
                      "$ref": "#/definitions/authority_key_identifier",
                      "description": "Identifies the public key to be used to verify the signature on this certificate or CRL",
                      "order": 3,
                      "title": "Authority Key Identifier"
                    },
                    "ca": {
                      "description": "Whether the subject acts as a CA or not",
                      "order": 1,
                      "title": "CA",
                      "type": "boolean"
                    },
                    "ca_information_access": {
                      "description": "Authority information access locations are URLs that are added to a certificate in its authority information access extension",
                      "order": 5,
                      "title": "CA Information Access",
                      "type": "object"
                    },
                    "cert_template_name_dc": {
                      "description": "BMP data value DomainController, see MS Q291010",
                      "order": 10,
                      "title": "Certificate Template Name DC",
                      "type": "string"
                    },
                    "certificate_policies": {
                      "description": "Different certificate policies will relate to different applications which may use the certified key",
                      "items": {
                        "type": "string"
                      },
                      "order": 8,
                      "title": "Certificate Policies",
                      "type": "array"
                    },
                    "crl_distribution_points": {
                      "description": "Identifies the CRL distribution points to which a certificate user should refer to ascertain if the certificate has been revoked",
                      "items": {
                        "type": "string"
                      },
                      "order": 6,
                      "title": "CRL Distribution Points",
                      "type": "array"
                    },
                    "key_usage": {
                      "description": "Indicates the purpose for which the certified public key is used",
                      "items": {
                        "type": "string"
                      },
                      "order": 4,
                      "title": "Key Usage",
                      "type": "array"
                    },
                    "netscape_cert_comment": {
                      "description": "Used to include free-form text comments inside certificates",
                      "order": 9,
                      "title": "Netscape Certificate Comment",
                      "type": "string"
                    },
                    "netscape_certificate": {
                      "description": "Identify whether the certificate subject is an SSL client, an SSL server, or a CA",
                      "order": 11,
                      "title": "Netscape Certificate",
                      "type": "boolean"
                    },
                    "old_authority_key_identifier": {
                      "description": "Whether the certificate has an old authority key identifier extension",
                      "order": 13,
                      "title": "Old Authority Key Identifier",
                      "type": "boolean"
                    },
                    "pe_logotype": {
                      "description": "Whether the certificate includes a logotype",
                      "order": 12,
                      "title": "PE Logotype",
                      "type": "boolean"
                    },
                    "subject_alternative_name": {
                      "description": "Contains one or more alternative names, using any of a variety of name forms, for the entity that is bound by the CA to the certified public key",
                      "items": {
                        "type": "string"
                      },
                      "order": 7,
                      "title": "Subject Alternative Name",
                      "type": "array"
                    },
                    "subject_key_identifier": {
                      "description": "Identifies the public key being certified",
                      "order": 2,
                      "title": "Subject Key Identifier",
                      "type": "string"
                    }
                  },
                  "title": "Ssl Extensions",
                  "type": "object"
                },
                "total_votes": {
                  "properties": {
                    "harmless": {
                      "description": "Number of positive votes",
                      "order": 1,
                      "title": "Harmless",
                      "type": "integer"
                    },
                    "malicious": {
                      "description": "Number of negative votes",
                      "order": 2,
                      "title": "Malicious",
                      "type": "integer"
                    }
                  },
                  "title": "Total Votes",
                  "type": "object"
                },
                "validity": {
                  "properties": {
                    "not_after": {
                      "description": "Expiry date in %Y-%m-%d %H:%M:%S format",
                      "order": 1,
                      "title": "Not After",
                      "type": "string"
                    },
                    "not_before": {
                      "description": "Issue date in %Y-%m-%d %H:%M:%S format",
                      "order": 2,
                      "title": "Not Before",
                      "type": "string"
                    }
                  },
                  "title": "Validity",
                  "type": "object"
                }
              },
              "properties": {
                "found": {
                  "description": "True if found",
                  "order": 2,
                  "title": "Found",
                  "type": "boolean"
                },
                "report": {
                  "$ref": "#/definitions/domain_report",
                  "description": "Domain report",
                  "order": 1,
                  "title": "Report"
                }
              },
              "required": [
                "found"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "3033f2be-f58e-4a3c-8cba-dd4f54127e44": {
            "nodeId": "3033f2be-f58e-4a3c-8cba-dd4f54127e44",
            "name": "Domain Report",
            "type": "artifact",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "content": "## {{[ffb63334-03ee-4333-843b-6b770451f31a].[path]}} Domain Detected\n**Domain:** {{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}} \\\n**Domain Age:** {{[d5d828a0-97af-43c9-8713-89d9f58f7be3].[Domain Age (String)]}} \\\n\n### VirusTotal\n> **Community Results**\n>> Harmless Votes: {{[29ee9f78-9e17-4c1a-9aba-b3a255caec41].[report].[total_votes].[harmless]}}\n>> Malicious Votes: {{[29ee9f78-9e17-4c1a-9aba-b3a255caec41].[report].[total_votes].[malicious]}}\n\n> **Analysis Stats**\n>> Harmless: {{[29ee9f78-9e17-4c1a-9aba-b3a255caec41].[report].[last_analysis_stats].[harmless]}}\n>> Suspicious: {{[29ee9f78-9e17-4c1a-9aba-b3a255caec41].[report].[last_analysis_stats].[suspicious]}}\n>> Malicious: {{[29ee9f78-9e17-4c1a-9aba-b3a255caec41].[report].[last_analysis_stats].[malicious]}}"
              },
              "type": "markdown"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/artifact.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "32654a74-9673-47b0-9ab2-260bb72ace91": {
            "nodeId": "32654a74-9673-47b0-9ab2-260bb72ace91",
            "name": "VirusTotal Domain Validation",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "ae449eca-4e18-4fc5-9fea-a6a9f3a2b873",
              "stepControlParams": [
                {
                  "edgeId": "ae449eca-4e18-4fc5-9fea-a6a9f3a2b873",
                  "expression": {},
                  "expressionText": ""
                },
                {
                  "edgeId": "b559b7b6-3710-4901-947a-c6e412250326",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "29ee9f78-9e17-4c1a-9aba-b3a255caec41.found",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": false
                      },
                      "type": "binary"
                    },
                    "op": "OR",
                    "right": {
                      "left": {
                        "left": {
                          "name": "29ee9f78-9e17-4c1a-9aba-b3a255caec41.$success",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "op": "OR",
                      "right": {
                        "left": {
                          "args": [
                            {
                              "name": "29ee9f78-9e17-4c1a-9aba-b3a255caec41.$success",
                              "type": "variable"
                            }
                          ],
                          "name": "is_defined",
                          "type": "function"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[29ee9f78-9e17-4c1a-9aba-b3a255caec41].[found]}} = false || {{[29ee9f78-9e17-4c1a-9aba-b3a255caec41].[$success]}} = false || is_defined({{[29ee9f78-9e17-4c1a-9aba-b3a255caec41].[$success]}}) = false"
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "48b34d41-dce5-43c2-9e37-6a18690c97b7": {
            "nodeId": "48b34d41-dce5-43c2-9e37-6a18690c97b7",
            "name": "New Email Received",
            "description": "Triggers when a new email is received in the inbox.",
            "type": "trigger",
            "plugin": {
              "name": "Microsoft Office 365 Email",
              "slugVendor": "rapid7",
              "slugName": "microsoft_office365_email",
              "slugVersion": "6.0.4",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/6.0.4/icon.png"
            },
            "identifier": "email_received",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "input": {
                "flatten_attachments": false,
                "folder_name": "Inbox",
                "interval": 15,
                "mailbox_id": "{{[$workflow].[Mailbox]}}",
                "subject_query": " "
              }
            },
            "triggerId": "0ed543a0-01ae-46f8-ab2d-e6e1213c18b8",
            "defaultInputJSONSchema": {
              "properties": {
                "flatten_attachments": {
                  "default": false,
                  "description": "Will return all attachments as flat lists instead of nested emails",
                  "order": 5,
                  "title": "Flatten Attachments",
                  "type": "boolean"
                },
                "folder_name": {
                  "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive. Folder GUID may be specified as well",
                  "order": 2,
                  "title": "Folder Name",
                  "type": "string"
                },
                "interval": {
                  "default": 15,
                  "description": "How often to poll for new email in seconds",
                  "order": 3,
                  "title": "Interval",
                  "type": "integer"
                },
                "mailbox_id": {
                  "description": "The mailbox to monitor for incoming email",
                  "order": 1,
                  "title": "Mailbox ID",
                  "type": "string"
                },
                "subject_query": {
                  "default": " ",
                  "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
                  "order": 4,
                  "title": "Subject Query",
                  "type": "string"
                }
              },
              "required": [
                "mailbox_id",
                "flatten_attachments"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "definitions": {
                "attachment_email": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email",
                  "type": "object"
                },
                "attachment_email_nested": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email_nested_two"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested",
                  "type": "object"
                },
                "attachment_email_nested_two": {
                  "properties": {
                    "account": {
                      "order": 9,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "type": "object"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 4,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 5,
                      "title": "Categories",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 11,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 6,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 10,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 2,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 3,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Attachment Email Nested Two",
                  "type": "object"
                },
                "attachment_file": {
                  "properties": {
                    "content": {
                      "order": 2,
                      "title": "Content",
                      "type": "string"
                    },
                    "content_type": {
                      "order": 3,
                      "title": "Content Type",
                      "type": "string"
                    },
                    "indicators": {
                      "$ref": "#/definitions/indicators",
                      "description": "Indicators",
                      "order": 4,
                      "title": "Indicators"
                    },
                    "name": {
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    }
                  },
                  "title": "Attachment File",
                  "type": "object"
                },
                "header": {
                  "properties": {
                    "name": {
                      "order": 1,
                      "title": "Name",
                      "type": "string"
                    },
                    "value": {
                      "order": 2,
                      "title": "Value",
                      "type": "string"
                    }
                  },
                  "title": "Header",
                  "type": "object"
                },
                "icon_email": {
                  "properties": {
                    "account": {
                      "description": "Account for which the email was found on",
                      "order": 2,
                      "title": "Account",
                      "type": "string"
                    },
                    "attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 8,
                      "title": "Attached Emails",
                      "type": "array"
                    },
                    "attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 7,
                      "title": "Attached Files",
                      "type": "array"
                    },
                    "body": {
                      "order": 6,
                      "title": "Body",
                      "type": "string"
                    },
                    "categories": {
                      "items": {
                        "type": "string"
                      },
                      "order": 11,
                      "title": "Categories",
                      "type": "array"
                    },
                    "flattened_attached_emails": {
                      "items": {
                        "$ref": "#/definitions/attachment_email"
                      },
                      "order": 9,
                      "title": "Flattened Attached Emails",
                      "type": "array"
                    },
                    "flattened_attached_files": {
                      "items": {
                        "$ref": "#/definitions/attachment_file"
                      },
                      "order": 10,
                      "title": "Flattened Attached Files",
                      "type": "array"
                    },
                    "has_attachments": {
                      "order": 14,
                      "title": "Has Attachments",
                      "type": "boolean"
                    },
                    "headers": {
                      "items": {
                        "$ref": "#/definitions/header"
                      },
                      "order": 12,
                      "title": "Headers",
                      "type": "array"
                    },
                    "id": {
                      "order": 1,
                      "title": "ID",
                      "type": "string"
                    },
                    "is_read": {
                      "description": "Whether or not the email has been read",
                      "order": 3,
                      "title": "Is Read",
                      "type": "boolean"
                    },
                    "recipients": {
                      "items": {
                        "type": "string"
                      },
                      "order": 13,
                      "title": "Recipients",
                      "type": "array"
                    },
                    "sender": {
                      "order": 4,
                      "title": "Sender",
                      "type": "string"
                    },
                    "subject": {
                      "order": 5,
                      "title": "Subject",
                      "type": "string"
                    }
                  },
                  "title": "Icon Email",
                  "type": "object"
                },
                "indicators": {
                  "properties": {
                    "md5": {
                      "description": "MD5 hash",
                      "order": 1,
                      "title": "MD5",
                      "type": "string"
                    },
                    "sha1": {
                      "description": "SHA1 hash",
                      "order": 2,
                      "title": "SHA1",
                      "type": "string"
                    },
                    "sha256": {
                      "description": "SHA256 hash",
                      "order": 3,
                      "title": "SHA256",
                      "type": "string"
                    }
                  },
                  "title": "Indicators",
                  "type": "object"
                }
              },
              "properties": {
                "icon_email": {
                  "$ref": "#/definitions/icon_email",
                  "description": "Email",
                  "order": 1,
                  "title": "Email"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/default.svg",
            "connectionType": "CONNECTION",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "52d62575-8570-4769-9806-125f2c32e599": {
            "nodeId": "52d62575-8570-4769-9806-125f2c32e599",
            "name": "WHOIS Domain Lookup",
            "type": "action",
            "plugin": {
              "name": "WHOIS",
              "slugVendor": "rapid7",
              "slugName": "whois",
              "slugVersion": "3.1.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/whois/3.1.0/icon.png"
            },
            "identifier": "domain",
            "continueOnFailure": true,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "domain": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "domain": {
                  "description": "Domain name to lookup",
                  "order": 1,
                  "title": "Domain",
                  "type": "string"
                }
              },
              "required": [
                "domain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "creation_date": {
                  "description": "Creation date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 5,
                  "title": "Creation Date",
                  "type": "string"
                },
                "dnssec": {
                  "description": "DNSSEC",
                  "order": 16,
                  "title": "DNSSEC",
                  "type": "string"
                },
                "domain_status": {
                  "description": "Domain status",
                  "items": {
                    "type": "string"
                  },
                  "order": 15,
                  "title": "Domain Status",
                  "type": "array"
                },
                "expiration_date": {
                  "description": "Expiration date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 6,
                  "title": "Expiration Date",
                  "type": "string"
                },
                "last_updated": {
                  "description": "Last updated date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 7,
                  "title": "Last Updated Date",
                  "type": "string"
                },
                "name": {
                  "description": "Domain name",
                  "order": 1,
                  "title": "Domain Name",
                  "type": "string"
                },
                "name_servers": {
                  "description": "Nameservers",
                  "items": {
                    "type": "string"
                  },
                  "order": 8,
                  "title": "Nameservers",
                  "type": "array"
                },
                "registrant_cc": {
                  "description": "Registrant country",
                  "order": 4,
                  "title": "Registrant Country",
                  "type": "string"
                },
                "registrant_name": {
                  "description": "Registrant name",
                  "order": 3,
                  "title": "Registrant Name",
                  "type": "string"
                },
                "registrar": {
                  "description": "Domain registrar",
                  "order": 2,
                  "title": "Domain Registrar",
                  "type": "string"
                },
                "registrar_abuse_contact_email": {
                  "description": "Registrar abuse contact email",
                  "order": 13,
                  "title": "Registrar Abuse Contact Email",
                  "type": "string"
                },
                "registrar_abuse_contact_phone": {
                  "description": "Registrar abuse Contact phone",
                  "order": 14,
                  "title": "Registrar Abuse Contact Phone",
                  "type": "string"
                },
                "registrar_iana_id": {
                  "description": "Registrar IANA ID",
                  "order": 12,
                  "title": "Registrar IANA ID",
                  "type": "string"
                },
                "registrar_url": {
                  "description": "Registrar URL",
                  "order": 11,
                  "title": "Registrar URL",
                  "type": "string"
                },
                "registrar_whois_server": {
                  "description": "Registrar WHOIS server",
                  "order": 10,
                  "title": "Registrar WHOIS Server",
                  "type": "string"
                },
                "registry_domain_id": {
                  "description": "Registry domain ID",
                  "order": 9,
                  "title": "Registry Domain ID",
                  "type": "string"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "5c15196b-5cb4-42d0-b36b-0d2ac56c609b": {
            "nodeId": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b",
            "name": "Lookup Header Domain",
            "type": "helpers",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "expression": {
                "left": {
                  "type": "literal",
                  "value": "value"
                },
                "op": "=",
                "right": {
                  "name": "67913af3-e3b4-42a0-8a69-ef8ced2c2515.$item",
                  "type": "variable"
                },
                "type": "binary"
              },
              "expressionText": "'value' = {{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}",
              "ignoreCase": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/helper.svg",
            "connectionType": "NONE",
            "helperIdentifier": "lookup_global_artifacts",
            "globalArtifact": {
              "name": "Allowed Domains",
              "id": "375f6031-c41b-438f-90c7-21a20f14aa1e",
              "schema": {
                "definitions": {},
                "properties": {
                  "_ROOT_": {
                    "items": {
                      "type": "string"
                    },
                    "type": "array"
                  }
                },
                "title": "Top Level Object",
                "type": "object"
              }
            },
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "5c9d2ecb-8c91-48fa-a770-f9886339013d": {
            "nodeId": "5c9d2ecb-8c91-48fa-a770-f9886339013d",
            "name": "Check for Attached Emails",
            "type": "filter",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "stepControlParam": {
                "edgeId": "17e1742e-0a8c-415e-8d39-84d7abe594fb",
                "expression": {
                  "left": {
                    "args": [
                      {
                        "name": "48b34d41-dce5-43c2-9e37-6a18690c97b7.icon_email.attached_emails",
                        "type": "variable"
                      }
                    ],
                    "name": "is_defined",
                    "type": "function"
                  },
                  "op": "=",
                  "right": {
                    "type": "literal",
                    "value": true
                  },
                  "type": "binary"
                },
                "expressionText": "is_defined({{[48b34d41-dce5-43c2-9e37-6a18690c97b7].[icon_email].[attached_emails]}}) = true"
              },
              "stopOnMatch": false
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/filter.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "67913af3-e3b4-42a0-8a69-ef8ced2c2515": {
            "nodeId": "67913af3-e3b4-42a0-8a69-ef8ced2c2515",
            "name": "Header Domains Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [
                {
                  "input": {
                    "expression": {
                      "left": {
                        "name": "ffb63334-03ee-4333-843b-6b770451f31a.path",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "Invalid"
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[ffb63334-03ee-4333-843b-6b770451f31a].[path]}} = \"Invalid\"",
                    "value": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}",
                    "valueType": "string"
                  },
                  "name": "Invalid Domains",
                  "outputType": "array"
                },
                {
                  "input": {
                    "expression": {
                      "left": {
                        "name": "ffb63334-03ee-4333-843b-6b770451f31a.path",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "Harmless"
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[ffb63334-03ee-4333-843b-6b770451f31a].[path]}} = \"Harmless\"",
                    "value": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}",
                    "valueType": "string"
                  },
                  "name": "Harmless Domains",
                  "outputType": "array"
                },
                {
                  "input": {
                    "expression": {
                      "left": {
                        "name": "ffb63334-03ee-4333-843b-6b770451f31a.path",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "Malicious"
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[ffb63334-03ee-4333-843b-6b770451f31a].[path]}} = \"Malicious\"",
                    "value": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[$item]}}",
                    "valueType": "string"
                  },
                  "name": "Malicious Domains",
                  "outputType": "array"
                },
                {
                  "input": {
                    "condition": "any",
                    "expression": {
                      "left": {
                        "name": "ffb63334-03ee-4333-843b-6b770451f31a.path",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": "Malicious"
                      },
                      "type": "binary"
                    },
                    "expressionText": "{{[ffb63334-03ee-4333-843b-6b770451f31a].[path]}} = \"Malicious\""
                  },
                  "name": "Malicious Domain Detected",
                  "outputType": "boolean"
                }
              ],
              "innerEdgeId": "380a636d-57ed-4f11-99bf-cbb301387335",
              "nextEdgeId": "935cdcf6-fcd2-459a-879f-c2c101aac57a",
              "repeatVariable": "{{[27ba9513-6b1d-4367-b210-500c5f84c2ed].[result]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {
                "Harmless Domains": {
                  "description": "Custom output: \"Harmless Domains\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "Harmless Domains",
                  "type": "array"
                },
                "Invalid Domains": {
                  "description": "Custom output: \"Invalid Domains\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "Invalid Domains",
                  "type": "array"
                },
                "Malicious Domain Detected": {
                  "description": "Custom output: \"Malicious Domain Detected\"",
                  "title": "Malicious Domain Detected",
                  "type": "boolean"
                },
                "Malicious Domains": {
                  "description": "Custom output: \"Malicious Domains\"",
                  "items": {
                    "type": "string"
                  },
                  "title": "Malicious Domains",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "71f35a2a-2e1d-4f85-86e8-8db217a68880": {
            "nodeId": "71f35a2a-2e1d-4f85-86e8-8db217a68880",
            "name": "Check Domain Age",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "3.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/3.0.0/icon.png"
            },
            "identifier": "time_elapsed",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "first_time": "{{[52d62575-8570-4769-9806-125f2c32e599].[creation_date]}}",
                "result_unit": "Days",
                "second_time": "{{[8cb56d0d-0d82-4ef2-947e-f13927dc93cd].[datetime]}}"
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "first_time": {
                  "description": "First date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 1,
                  "title": "First Date",
                  "type": "string"
                },
                "result_unit": {
                  "description": "Time unit of measurement for result",
                  "enum": [
                    "Years",
                    "Months",
                    "Days",
                    "Hours",
                    "Minutes",
                    "Seconds"
                  ],
                  "order": 3,
                  "title": "Result Unit",
                  "type": "string"
                },
                "second_time": {
                  "description": "Second date",
                  "displayType": "date",
                  "format": "date-time",
                  "order": 2,
                  "title": "Second Date",
                  "type": "string"
                }
              },
              "required": [
                "first_time",
                "second_time",
                "result_unit"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "difference": {
                  "description": "Quantity of time difference",
                  "order": 1,
                  "title": "Difference",
                  "type": "integer"
                },
                "time_unit": {
                  "description": "Time unit of measurement",
                  "order": 2,
                  "title": "Unit of Time",
                  "type": "string"
                }
              },
              "required": [
                "difference",
                "time_unit"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "8cb56d0d-0d82-4ef2-947e-f13927dc93cd": {
            "nodeId": "8cb56d0d-0d82-4ef2-947e-f13927dc93cd",
            "name": "Get Current Date Time",
            "type": "action",
            "plugin": {
              "name": "Datetime",
              "slugVendor": "rapid7",
              "slugName": "datetime",
              "slugVersion": "3.0.0",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/datetime/3.0.0/icon.png"
            },
            "identifier": "get_datetime",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "format_string": "%d %b %Y %H:%M:%S",
                "use_rfc3339_format": true
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "format_string": {
                  "default": "%d %b %Y %H:%M:%S",
                  "description": "Format string for the output",
                  "order": 1,
                  "title": "Format String",
                  "type": "string"
                },
                "use_rfc3339_format": {
                  "description": "Use RFC3339 format (eg. 2017-10-24T18:27:36.23Z). This is the most compatible date format for timestamp manipulation. Enabling this will override the format string input",
                  "order": 2,
                  "title": "Use RFC3339 Format",
                  "type": "boolean"
                }
              },
              "required": [
                "format_string",
                "use_rfc3339_format"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "datetime": {
                  "description": "Datetime",
                  "order": 1,
                  "title": "Datetime",
                  "type": "string"
                },
                "epoch_timestamp": {
                  "description": "Epoch timestamp",
                  "order": 2,
                  "title": "Epoch Timestamp",
                  "type": "integer"
                }
              },
              "required": [
                "datetime",
                "epoch_timestamp"
              ],
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "a1ca6931-8535-4185-ac8e-bdc950c2813e": {
            "nodeId": "a1ca6931-8535-4185-ac8e-bdc950c2813e",
            "name": "Attached Emails Loop",
            "type": "loop",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "customOutput": [],
              "innerEdgeId": "438ed644-2e8d-48e0-b26a-4233ff7a6df8",
              "nextEdgeId": "c4c1d3eb-f1d8-4ac9-9f24-e46c0a23ff56",
              "repeatVariable": "{{[48b34d41-dce5-43c2-9e37-6a18690c97b7].[icon_email].[attached_emails]}}"
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": {
              "properties": {},
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "ae3aba62-d292-4e43-aa50-d0874c722154": {
            "nodeId": "ae3aba62-d292-4e43-aa50-d0874c722154",
            "name": "WHOIS Domain Validation",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "c953ac2c-029f-436e-abbe-189e119d6537",
              "stepControlParams": [
                {
                  "edgeId": "5161efb8-b72f-4fd1-9d2b-6a1f4b8f75b9",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "52d62575-8570-4769-9806-125f2c32e599.$success",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": false
                      },
                      "type": "binary"
                    },
                    "op": "OR",
                    "right": {
                      "left": {
                        "args": [
                          {
                            "name": "52d62575-8570-4769-9806-125f2c32e599.creation_date",
                            "type": "variable"
                          }
                        ],
                        "name": "is_defined",
                        "type": "function"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": false
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[52d62575-8570-4769-9806-125f2c32e599].[$success]}}=false || is_defined({{[52d62575-8570-4769-9806-125f2c32e599].[creation_date]}}) = false"
                },
                {
                  "edgeId": "c953ac2c-029f-436e-abbe-189e119d6537",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "b0816c9e-f2c1-4f85-bf02-45a56ca9d805": {
            "nodeId": "b0816c9e-f2c1-4f85-bf02-45a56ca9d805",
            "name": "VirusTotal Domain Validation Join",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "b559b7b6-3710-4901-947a-c6e412250326",
                "ae449eca-4e18-4fc5-9fea-a6a9f3a2b873"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "VirusTotal Domain Valid",
                  "type": "boolean",
                  "variables": {
                    "ae449eca-4e18-4fc5-9fea-a6a9f3a2b873": true,
                    "b559b7b6-3710-4901-947a-c6e412250326": false
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "VirusTotal Domain Valid": {
                  "description": "Emitted variable \"VirusTotal Domain Valid\"",
                  "order": 1,
                  "title": "VirusTotal Domain Valid",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "VirusTotal Domain Valid": {
                  "description": "Emitted variable \"VirusTotal Domain Valid\"",
                  "order": 1,
                  "title": "VirusTotal Domain Valid",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "b8a82da6-037b-421b-ae7a-d46078baa704": {
            "nodeId": "b8a82da6-037b-421b-ae7a-d46078baa704",
            "name": "Malicious Indicators Detected",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "e2d2e8ce-88e6-4668-b43a-6999435d6860",
              "stepControlParams": [
                {
                  "edgeId": "1d6240d4-9b54-4906-93d3-72fa229a6f0b",
                  "expression": {
                    "left": {
                      "name": "67913af3-e3b4-42a0-8a69-ef8ced2c2515.Malicious Domain Detected",
                      "type": "variable"
                    },
                    "op": "=",
                    "right": {
                      "type": "literal",
                      "value": true
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[67913af3-e3b4-42a0-8a69-ef8ced2c2515].[Malicious Domain Detected]}} = true"
                },
                {
                  "edgeId": "e2d2e8ce-88e6-4668-b43a-6999435d6860",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "d5d828a0-97af-43c9-8713-89d9f58f7be3": {
            "nodeId": "d5d828a0-97af-43c9-8713-89d9f58f7be3",
            "name": "WHOIS Domain Validation Join",
            "type": "join",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "decisionEdgeIds": [
                "5161efb8-b72f-4fd1-9d2b-6a1f4b8f75b9",
                "1c463098-0ded-46bb-83b1-2afe2eb0eb9c"
              ],
              "variableSets": [
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "Domain Age",
                  "type": "integer",
                  "variables": {
                    "1c463098-0ded-46bb-83b1-2afe2eb0eb9c": "{{[71f35a2a-2e1d-4f85-86e8-8db217a68880].[difference]}}",
                    "5161efb8-b72f-4fd1-9d2b-6a1f4b8f75b9": 30
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "WHOIS Domain Valid",
                  "type": "boolean",
                  "variables": {
                    "1c463098-0ded-46bb-83b1-2afe2eb0eb9c": true,
                    "5161efb8-b72f-4fd1-9d2b-6a1f4b8f75b9": false
                  }
                },
                {
                  "arrayType": null,
                  "inputBuilderSchemas": null,
                  "name": "Domain Age (String)",
                  "type": "string",
                  "variables": {
                    "1c463098-0ded-46bb-83b1-2afe2eb0eb9c": "{{[71f35a2a-2e1d-4f85-86e8-8db217a68880].[difference]}} days",
                    "5161efb8-b72f-4fd1-9d2b-6a1f4b8f75b9": "Not valid"
                  }
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": {
              "properties": {
                "Domain Age": {
                  "description": "Emitted variable \"Domain Age\"",
                  "order": 1,
                  "title": "Domain Age",
                  "type": "integer"
                },
                "Domain Age (String)": {
                  "description": "Emitted variable \"Domain Age (String)\"",
                  "order": 3,
                  "title": "Domain Age (String)",
                  "type": "string"
                },
                "WHOIS Domain Valid": {
                  "description": "Emitted variable \"WHOIS Domain Valid\"",
                  "order": 2,
                  "title": "WHOIS Domain Valid",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": {
              "properties": {
                "Domain Age": {
                  "description": "Emitted variable \"Domain Age\"",
                  "order": 1,
                  "title": "Domain Age",
                  "type": "integer"
                },
                "Domain Age (String)": {
                  "description": "Emitted variable \"Domain Age (String)\"",
                  "order": 3,
                  "title": "Domain Age (String)",
                  "type": "string"
                },
                "WHOIS Domain Valid": {
                  "description": "Emitted variable \"WHOIS Domain Valid\"",
                  "order": 2,
                  "title": "WHOIS Domain Valid",
                  "type": "boolean"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "defaultImageData": "",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec": {
            "nodeId": "f07a4ce8-ec8e-4b15-ba46-43358e8b19ec",
            "name": "Extract Header Domains",
            "type": "action",
            "plugin": {
              "name": "ExtractIt",
              "slugVendor": "rapid7",
              "slugName": "extractit",
              "slugVersion": "3.0.8",
              "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/extractit/3.0.8/icon.png"
            },
            "identifier": "domain_extractor",
            "continueOnFailure": false,
            "isDisabled": false,
            "isCloud": false,
            "parameters": {
              "input": {
                "file": "",
                "str": "{{[a1ca6931-8535-4185-ac8e-bdc950c2813e].[$item].[headers]}}",
                "subdomain": false
              }
            },
            "defaultInputJSONSchema": {
              "properties": {
                "file": {
                  "description": "Input file as bytes, supports text and binary file types such as PDF, DOCX, XLSX, PPTX, ODF, TXT, ZIP",
                  "displayType": "bytes",
                  "format": "bytes",
                  "order": 2,
                  "title": "File",
                  "type": "string"
                },
                "str": {
                  "description": "Input string",
                  "order": 1,
                  "title": "String",
                  "type": "string"
                },
                "subdomain": {
                  "description": "Include subdomain in result",
                  "order": 3,
                  "title": "Subdomain",
                  "type": "boolean"
                }
              },
              "required": [
                "subdomain"
              ],
              "title": "Variables",
              "type": "object"
            },
            "defaultOutputJSONSchema": {
              "properties": {
                "domains": {
                  "description": "List of extracted Domain names",
                  "items": {
                    "type": "string"
                  },
                  "order": 1,
                  "title": "Domain Names",
                  "type": "array"
                }
              },
              "title": "Variables",
              "type": "object"
            },
            "outputJSONSchema": null,
            "defaultImageData": "",
            "connectionType": "ORCHESTRATOR",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          },
          "ffb63334-03ee-4333-843b-6b770451f31a": {
            "nodeId": "ffb63334-03ee-4333-843b-6b770451f31a",
            "name": "Domain Reputation Decision",
            "type": "automated_decision",
            "continueOnFailure": false,
            "isDisabled": false,
            "parameters": {
              "defaultEdgeId": "efc17a74-2f2d-4d9b-a724-4d4cd6a61d38",
              "stepControlParams": [
                {
                  "edgeId": "4d07c7d9-57d5-42bc-afc2-5d9e64e4dfa6",
                  "expression": {
                    "left": {
                      "left": {
                        "left": {
                          "name": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b.found",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "name": "d5d828a0-97af-43c9-8713-89d9f58f7be3.Domain Age",
                          "type": "variable"
                        },
                        "op": "<",
                        "right": {
                          "type": "literal",
                          "value": 30
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "op": "OR",
                    "right": {
                      "left": {
                        "name": "29ee9f78-9e17-4c1a-9aba-b3a255caec41.report.reputation",
                        "type": "variable"
                      },
                      "op": "<",
                      "right": {
                        "name": "$workflow.VirusTotal Domain Reputation Threshold",
                        "type": "variable"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[5c15196b-5cb4-42d0-b36b-0d2ac56c609b].[found]}} = false && {{[d5d828a0-97af-43c9-8713-89d9f58f7be3].[Domain Age]}} < 30 || {{[29ee9f78-9e17-4c1a-9aba-b3a255caec41].[report].[reputation]}} < {{$workflow.[VirusTotal Domain Reputation Threshold]}}"
                },
                {
                  "edgeId": "b8b82149-4005-4e1c-845e-1b072a474d4a",
                  "expression": {
                    "left": {
                      "left": {
                        "name": "5c15196b-5cb4-42d0-b36b-0d2ac56c609b.found",
                        "type": "variable"
                      },
                      "op": "=",
                      "right": {
                        "type": "literal",
                        "value": false
                      },
                      "type": "binary"
                    },
                    "op": "AND",
                    "right": {
                      "left": {
                        "left": {
                          "name": "d5d828a0-97af-43c9-8713-89d9f58f7be3.WHOIS Domain Valid",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "op": "AND",
                      "right": {
                        "left": {
                          "name": "b0816c9e-f2c1-4f85-bf02-45a56ca9d805.VirusTotal Domain Valid",
                          "type": "variable"
                        },
                        "op": "=",
                        "right": {
                          "type": "literal",
                          "value": false
                        },
                        "type": "binary"
                      },
                      "type": "binary"
                    },
                    "type": "binary"
                  },
                  "expressionText": "{{[5c15196b-5cb4-42d0-b36b-0d2ac56c609b].[found]}} = false && ({{[d5d828a0-97af-43c9-8713-89d9f58f7be3].[WHOIS Domain Valid]}} = false && {{[b0816c9e-f2c1-4f85-bf02-45a56ca9d805].[VirusTotal Domain Valid]}} = false)"
                },
                {
                  "edgeId": "efc17a74-2f2d-4d9b-a724-4d4cd6a61d38",
                  "expression": {},
                  "expressionText": ""
                }
              ]
            },
            "defaultInputJSONSchema": null,
            "defaultOutputJSONSchema": null,
            "outputJSONSchema": null,
            "defaultImageData": "https://us2.cdn-assets.connect.insight.rapid7.com/step-type-icons/automated-decision.svg",
            "connectionType": "NONE",
            "caseManagementInputJsonSchema": null,
            "caseManagementOutputJsonSchema": null
          }
        },
        "tags": [],
        "humanCostSeconds": 0,
        "humanCostDisplayUnit": "minutes",
        "parameters": {
          "definitionSchema": {
            "type": "object",
            "required": [],
            "properties": {
              "Mailbox": {
                "type": "string",
                "description": "The email that should be monitored for reported messages."
              },
              "VirusTotal Domain Reputation Threshold": {
                "type": "integer",
                "description": "Threshold for determining VirusTotal assessment. Needs to be NEGATIVE. Please see workflow description for details."
              }
            },
            "definitions": {}
          }
        },
        "summary": ""
      }
    ],
    "triggers": [
      {
        "id": "0ed543a0-01ae-46f8-ab2d-e6e1213c18b8",
        "identifier": "email_received",
        "name": "New Email Received",
        "description": "Triggers when a new email is received in the inbox.",
        "input": {
          "flatten_attachments": false,
          "folder_name": "Inbox",
          "interval": 15,
          "mailbox_id": "{{[$workflow].[Mailbox]}}",
          "subject_query": " "
        },
        "inputJsonSchema": {
          "properties": {
            "flatten_attachments": {
              "default": false,
              "description": "Will return all attachments as flat lists instead of nested emails",
              "order": 5,
              "title": "Flatten Attachments",
              "type": "boolean"
            },
            "folder_name": {
              "description": "Common values are Calendar, Trash, Drafts, Inbox, Outbox, Sent, Junk, Tasks, Contacts. You can also use a completely custom value, for example python_mailing_list. Mailbox names are case-sensitive. Folder GUID may be specified as well",
              "order": 2,
              "title": "Folder Name",
              "type": "string"
            },
            "interval": {
              "default": 15,
              "description": "How often to poll for new email in seconds",
              "order": 3,
              "title": "Interval",
              "type": "integer"
            },
            "mailbox_id": {
              "description": "The mailbox to monitor for incoming email",
              "order": 1,
              "title": "Mailbox ID",
              "type": "string"
            },
            "subject_query": {
              "default": " ",
              "description": "Query to search for in subject (regex capable). Only these email will activate this trigger",
              "order": 4,
              "title": "Subject Query",
              "type": "string"
            }
          },
          "required": [
            "mailbox_id",
            "flatten_attachments"
          ],
          "title": "Variables",
          "type": "object"
        },
        "outputJsonSchema": {
          "definitions": {
            "attachment_email": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email",
              "type": "object"
            },
            "attachment_email_nested": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email_nested_two"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested",
              "type": "object"
            },
            "attachment_email_nested_two": {
              "properties": {
                "account": {
                  "order": 9,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "type": "object"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 4,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 5,
                  "title": "Categories",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 11,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 6,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 10,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 2,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 3,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Attachment Email Nested Two",
              "type": "object"
            },
            "attachment_file": {
              "properties": {
                "content": {
                  "order": 2,
                  "title": "Content",
                  "type": "string"
                },
                "content_type": {
                  "order": 3,
                  "title": "Content Type",
                  "type": "string"
                },
                "indicators": {
                  "$ref": "#/definitions/indicators",
                  "description": "Indicators",
                  "order": 4,
                  "title": "Indicators"
                },
                "name": {
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                }
              },
              "title": "Attachment File",
              "type": "object"
            },
            "header": {
              "properties": {
                "name": {
                  "order": 1,
                  "title": "Name",
                  "type": "string"
                },
                "value": {
                  "order": 2,
                  "title": "Value",
                  "type": "string"
                }
              },
              "title": "Header",
              "type": "object"
            },
            "icon_email": {
              "properties": {
                "account": {
                  "description": "Account for which the email was found on",
                  "order": 2,
                  "title": "Account",
                  "type": "string"
                },
                "attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 8,
                  "title": "Attached Emails",
                  "type": "array"
                },
                "attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 7,
                  "title": "Attached Files",
                  "type": "array"
                },
                "body": {
                  "order": 6,
                  "title": "Body",
                  "type": "string"
                },
                "categories": {
                  "items": {
                    "type": "string"
                  },
                  "order": 11,
                  "title": "Categories",
                  "type": "array"
                },
                "flattened_attached_emails": {
                  "items": {
                    "$ref": "#/definitions/attachment_email"
                  },
                  "order": 9,
                  "title": "Flattened Attached Emails",
                  "type": "array"
                },
                "flattened_attached_files": {
                  "items": {
                    "$ref": "#/definitions/attachment_file"
                  },
                  "order": 10,
                  "title": "Flattened Attached Files",
                  "type": "array"
                },
                "has_attachments": {
                  "order": 14,
                  "title": "Has Attachments",
                  "type": "boolean"
                },
                "headers": {
                  "items": {
                    "$ref": "#/definitions/header"
                  },
                  "order": 12,
                  "title": "Headers",
                  "type": "array"
                },
                "id": {
                  "order": 1,
                  "title": "ID",
                  "type": "string"
                },
                "is_read": {
                  "description": "Whether or not the email has been read",
                  "order": 3,
                  "title": "Is Read",
                  "type": "boolean"
                },
                "recipients": {
                  "items": {
                    "type": "string"
                  },
                  "order": 13,
                  "title": "Recipients",
                  "type": "array"
                },
                "sender": {
                  "order": 4,
                  "title": "Sender",
                  "type": "string"
                },
                "subject": {
                  "order": 5,
                  "title": "Subject",
                  "type": "string"
                }
              },
              "title": "Icon Email",
              "type": "object"
            },
            "indicators": {
              "properties": {
                "md5": {
                  "description": "MD5 hash",
                  "order": 1,
                  "title": "MD5",
                  "type": "string"
                },
                "sha1": {
                  "description": "SHA1 hash",
                  "order": 2,
                  "title": "SHA1",
                  "type": "string"
                },
                "sha256": {
                  "description": "SHA256 hash",
                  "order": 3,
                  "title": "SHA256",
                  "type": "string"
                }
              },
              "title": "Indicators",
              "type": "object"
            }
          },
          "properties": {
            "icon_email": {
              "$ref": "#/definitions/icon_email",
              "description": "Email",
              "order": 1,
              "title": "Email"
            }
          },
          "title": "Variables",
          "type": "object"
        },
        "tags": [],
        "type": "trigger_plugin",
        "plugin": {
          "name": "Microsoft Office 365 Email",
          "slugVendor": "rapid7",
          "slugName": "microsoft_office365_email",
          "slugVersion": "6.0.4",
          "imageData": "https://us2.cdn-assets.connect.insight.rapid7.com/icons/rapid7/microsoft_office365_email/6.0.4/icon.png"
        }
      }
    ]
  }
}